"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7962],{27962:function(e,t,n){n.d(t,{m:function(){return g},H:function(){return h}});var r=n(2265);class o extends AbortController{constructor(...e){super();let t=e.find(e=>e.aborted);if(t)this.abort(t.reason);else{let t=e=>this.abort(e.target.reason),n={signal:this.signal};for(let r of e)r.addEventListener("abort",t,n)}}}let a=Symbol.for("quilt.threads.retain"),l=Symbol.for("quilt.threads.release"),i=Symbol.for("quilt.threads.retained-by"),s=Symbol.for("quilt.threads.encode");class u{memoryManaged=new Set;add(e){this.memoryManaged.add(e),e[i].add(this),e[a]()}release(){for(let e of this.memoryManaged)e[i].delete(this),e[l]();this.memoryManaged.clear()}}function f(e){return!!(e&&e[a]&&e[l])}function c(e){if(null==e||"object"!=typeof e)return!1;let t=Object.getPrototypeOf(e);return null==t||t===Object.prototype}function d(e,{expose:t,callable:n,signal:r,uuid:o=p,encoder:d=function({encode:e,decode:t}={}){return{encode:function(e,t){let r={api:t,seen:new Map,encode:e=>n(e,r,!0)};return n(e,r)},decode:function(e,t,n){let o={api:t,decode:e=>r(e,o,n,!0)};return r(e,o)}};function n(t,r,o=!1){let{seen:a,api:l,encode:i}=r;if(!o&&e)return e(t,i);if(null==t)return[t];let u=a.get(t);if(u)return u;if(a.set(t,[void 0]),"object"==typeof t){let e=[],o=t=>{let[o,a=[]]=n(t,r);return e.push(...a),o};if("function"==typeof t[s]){let n=t[s]({encode:o}),r=[n,e];return a.set(t,r),r}if(Array.isArray(t)){let n=t.map(e=>o(e)),r=[n,e];return a.set(t,r),r}if(t instanceof RegExp){let n={"_@r":[t.source,t.flags]},r=[n,e];return a.set(t,r),r}if(t instanceof URL){let n={"_@u":t.href},r=[n,e];return a.set(t,r),r}if(t instanceof Date){let n={"_@d":t.toISOString()},r=[n,e];return a.set(t,r),r}if(t instanceof Map){let n=[...t.entries()].map(([e,t])=>[o(e),o(t)]),r=[{"_@m":n},e];return a.set(t,r),r}if(t instanceof Set){let n=[...t].map(e=>o(e)),r=[{"_@s":n},e];return a.set(t,r),r}let l=null!=t&&(Symbol.asyncIterator in t||Symbol.iterator in t)&&"function"==typeof t.next;if(c(t)||l){let n={};for(let e of Object.keys(t))n[e]=o(t[e]);l&&(n.next??=o(t.next.bind(t)),n.return??=o(t.return.bind(t)),n.throw??=o(t.throw.bind(t)),n["_@i"]=!0);let r=[n,e];return a.set(t,r),r}}if("function"==typeof t){let e=l.functions?.add(t);if(null==e)return[e];let n=[{"_@f":e}];return a.set(t,n),n}let f=[t];return a.set(t,f),f}function r(e,n,o,a=!1){let{api:l,decode:i}=n;if(!a&&t)return t(e,i,o);if("object"==typeof e){if(null==e)return e;if(Array.isArray(e))return e.map(e=>r(e,n,o));if("_@r"in e)return new RegExp(...e["_@r"]);if("_@u"in e)return new URL(e["_@u"]);if("_@d"in e)return new Date(e["_@d"]);if("_@m"in e)return new Map(e["_@m"].map(([e,t])=>[r(e,n,o),r(t,n,o)]));if("_@s"in e)return new Set(e["_@s"].map(e=>r(e,n,o)));if("_@f"in e){let t=e["_@f"],n=l.functions?.get(t);if(o&&f(n))for(let e of o)e.add(n);return n}if(!c(e))return e;let t={};for(let a of Object.keys(e))"_@i"===a?t[Symbol.asyncIterator]=()=>t:t[a]=r(e[a],n,o);return t}return e}}()}={}){let w=!1,m=new Map,b=new Map,g=new Map,h=new Map;if(t)for(let e of Object.keys(t)){let n=t[e];"function"==typeof n&&m.set(e,n)}let E=new Map,_=function(e,t){let n;if(null==t){if("function"!=typeof Proxy)throw Error("You must pass an array of callable methods in environments without Proxies.");let t=new Map;n=new Proxy({},{get(n,r){if(t.has(r))return t.get(r);let o=e(r);return t.set(r,o),o}})}else for(let r of(n={},t))Object.defineProperty(n,r,{value:e(r),writable:!1,configurable:!0,enumerable:!0});return n}(function(e){return(...t)=>{try{if(w)throw new y;if("string"!=typeof e&&"number"!=typeof e)throw Error(`Canâ€™t call a symbol method on a thread: ${e.toString()}`);let n=o(),r=k(n),[a,l]=d.encode(t,v);return S(0,[n,e,a],l),r}catch(e){return Promise.reject(e)}}},n),v={functions:{add(e){let t=b.get(e);return null==t&&(t=o(),b.set(e,t),g.set(t,e)),t},get(e){let t=h.get(e);if(t)return t;let n=0,r=!1;return Object.defineProperties(t=(...t)=>{if(r)throw Error("You attempted to call a function that was already released.");if(!h.has(e))throw Error("You attempted to call a function that was already revoked.");let[n,a]=d.encode(t,v),l=o(),i=k(l);return S(5,[l,e,n],a),i},{[l]:{value:()=>{0==(n-=1)&&(r=!0,h.delete(e),S(3,[e]))},writable:!1},[a]:{value:()=>{n+=1},writable:!1},[i]:{value:new Set,writable:!1}}),h.set(e,t),t}}},M=()=>{if(!w){for(let e of E.keys())x(e,new y);w=!0,m.clear(),E.clear(),b.clear(),g.clear(),h.clear()}};return r?.addEventListener("abort",()=>{S(2,[]),M()},{once:!0}),e.listen(j,{signal:r}),_;function S(t,n,r){w||e.send([t,n],r)}async function j(e){let t=Array.isArray(e)&&"number"==typeof e[0]&&(null==e[1]||Array.isArray(e[1]));if(t)switch(e[0]){case 2:M();break;case 0:{let t=new u,[n,r,o]=e[1],a=m.get(r);try{if(null==a)throw Error(`No '${r}' method is exposed on this endpoint`);let e=await a(...d.decode(o,v,[t])),[l,i]=d.encode(e,v);S(1,[n,void 0,l],i)}catch(o){let{name:e,message:t,stack:r}=o;S(1,[n,{name:e,message:t,stack:r}])}finally{t.release()}break}case 1:case 6:x(...e[1]);break;case 3:{let[t]=e[1],n=g.get(t);n&&(g.delete(t),b.delete(n));break}case 5:{let[t,n,r]=e[1],o=new u;try{let e=g.get(n);if(null==e)throw Error("You attempted to call a function that was already released.");let a=await e(...d.decode(r,v,f(e)?[...e[i],o]:[o])),[l,s]=d.encode(a,v);S(6,[t,void 0,l],s)}catch(o){let{name:e,message:n,stack:r}=o;S(6,[t,{name:e,message:n,stack:r}])}finally{o.release()}}}}function k(e){let t=new Promise((t,n)=>{E.set(e,(e,r,o)=>{if(null==r)t(d.decode(o,v));else{let e=Error();Object.assign(e,r),n(e)}})});return Object.defineProperty(t,Symbol.asyncIterator,{async *value(){let e=await t;Object.defineProperty(e,Symbol.asyncIterator,{value:()=>e}),yield*e}}),t}function x(...e){let t=e[0],n=E.get(t);n&&(n(...e),E.delete(t))}}class y extends Error{constructor(){super("You attempted to call a function on a terminated thread.")}}function p(){return`${w()}-${w()}-${w()}-${w()}`}function w(){return Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)}let m="quilt.threads.ping",b="quilt.threads.pong";function g(e,t){let n=(0,r.useRef)(null);return(0,r.useEffect)(()=>{e.current&&!n.current&&(n.current=function(e,{targetOrigin:t="*",...n}={}){let r=!1,a=function(n,r){e.contentWindow?.postMessage(n,t,r)},l=new Promise(t=>{let l=n.signal?new o(n.signal):new AbortController;window.addEventListener("message",n=>{n.source===e.contentWindow&&n.data===b&&(r=!0,l.abort(),t())},{signal:l.signal}),l.signal.addEventListener("abort",()=>{t()},{once:!0}),a(m)});return d({send:(e,t)=>r?a(e,t):l.then(()=>{if(r)return a(e,t)}),listen(t,{signal:n}){self.addEventListener("message",n=>{n.source===e.contentWindow&&n.data!==b&&t(n.data)},{signal:n})}},n)}(e.current,{expose:{navigate:t.navigate}}))},[e.current]),n.current}function h(e){let t=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let n=window.self!==window.top;n&&!t.current&&(t.current=function({targetOrigin:e="*",...t}={}){if("undefined"==typeof self||null==self.parent)throw Error("You are not inside an iframe, because there is no parent window.");let{parent:n}=self,r=t.signal?new o(t.signal):new AbortController,a=()=>{let r=()=>n.postMessage(b,e);self.addEventListener("message",({data:e})=>{e===m&&r()},{signal:t.signal}),r()};return"complete"===document.readyState?a():document.addEventListener("readystatechange",()=>{"complete"===document.readyState&&(a(),r.abort())},{signal:r.signal}),d({send:(t,r)=>n.postMessage(t,e,r),listen(e,{signal:t}){self.addEventListener("message",t=>{t.data!==m&&e(t.data)},{signal:t})}},t)}({expose:{init:e.init,sendMessage:e.sendMessage}}))},[]),t.current}}}]);