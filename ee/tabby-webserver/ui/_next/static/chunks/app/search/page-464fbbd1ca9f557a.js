(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2797],{46576:function(e,t,n){Promise.resolve().then(n.bind(n,234))},234:function(e,t,n){"use strict";n.r(t),n.d(t,{SOURCE_CARD_STYLE:function(){return eT},Search:function(){return ez}});var s=n(36164),a=n(3546),l=n(70652),i=n.n(l),r=n(11978),o=n(54767),d=n(1853),c=n(82030),u=n(72940),m=n(52807),h=n(12978),x=n(56575),f=n(2578),p=n(40055),v=n(21808),g=n(93877),j=n(43240),b=n(18500),N=n(28312),w=n(9010),y=n(16784),C=n(98454),I=n(31159),k=n(4951),R=n(44645),M=n(80605),A=n(64566),S=n(17451),L=n(96274),D=n(37266),T=n(11634),_=n(70410),F=n(57288),z=n(31458),U=n(81565),E=n(53538),P=n(57830),V=n(11208),O=n(29),Z=n(72657),Q=n(30601),q=n(6230),G=n(69579),H=n(30087),W=n(84381),$=n(94909),Y=n(5493),K=n(23455),B=n(23782),X=n(74038),J=n(98150),ee=n(3448),et=n(17448),en=n(48537),es=n(54646),ea=n(65858),el=n(90615),ei=n(25600),er=n(21008),eo=n(64219),ed=n(37034);function ec(e){let{isLoading:t,children:n,title:l,defaultOpen:i,isLastItem:r}=e,o="item",[d,c]=(0,a.useState)(!!i),u=!!n;return(0,a.useEffect)(()=>{u&&!d&&c(!0)},[u]),(0,s.jsx)("div",{children:(0,s.jsx)(ea.UQ,{type:"single",value:d?o:"",collapsible:u,className:"z-10",onValueChange:e=>{c(e===o)},children:(0,s.jsxs)(ea.Qd,{value:o,className:"relative border-0",children:[(!r||d&&u)&&(0,s.jsx)("div",{className:"absolute left-2 top-5 block h-full w-0.5 shrink-0 translate-x-px rounded-full bg-muted"}),(0,s.jsx)(ea.o4,{className:"group w-full gap-2 rounded-lg py-1 pl-0.5 pr-2 !no-underline hover:bg-muted/70",showChevron:!!n,children:(0,s.jsxs)("div",{className:"flex flex-1 items-center gap-4",children:[(0,s.jsx)("div",{className:"relative z-10 shrink-0 bg-background group-hover:bg-muted/70",children:t?(0,s.jsx)(U.IconSpinner,{}):(0,s.jsx)(U.IconCheckFull,{className:"h-4 w-4"})}),(0,s.jsx)("span",{children:l})]})}),!!n&&(0,s.jsx)(ea.vF,{className:"pb-0 pl-9",children:n})]})})})}let eu=(0,a.createContext)({});function em(e){var t;let{docQuery:n,isReadingCode:l,isReadingFileList:i,isReadingDocs:r,readingCode:o,codeSourceId:d,serverCodeContexts:c,clientCodeContexts:u,docs:m,codeFileList:h,onContextClick:x}=e,{contextInfo:f,enableDeveloperMode:p}=(0,a.useContext)(eu),v=((null==u?void 0:u.length)||0)+c.length+((null==m?void 0:m.length)||0),g=(0,a.useMemo)(()=>{if(!d)return;let e=null==f?void 0:f.sources.find(e=>(0,F.wO)(e.sourceKind)&&e.sourceId===d);return e},[d,f]),j=(0,a.useMemo)(()=>{let e=[];return(null==o?void 0:o.fileList)&&e.push("fileList"),(null==o?void 0:o.snippet)&&e.push("snippet"),n&&e.push("docs"),e},[null==o?void 0:o.fileList,null==o?void 0:o.snippet,n]),b=(0,a.useMemo)(()=>j.slice().pop(),[j]);return(0,s.jsx)(ea.UQ,{collapsible:!0,type:"single",defaultValue:"readingCode",children:(0,s.jsxs)(ea.Qd,{value:"readingCode",className:"border-0",children:[(0,s.jsx)(ea.o4,{className:"w-full py-2 pr-2",children:(0,s.jsxs)("div",{className:"flex flex-1 items-center justify-between pr-2",children:[(0,s.jsxs)("div",{className:"flex flex-1 items-center gap-2",children:[(0,s.jsx)(U.IconCode,{className:"mr-2 h-5 w-5 shrink-0"}),(0,s.jsx)("span",{children:"Look into"}),!!g&&(0,s.jsxs)("div",{className:"inline-flex cursor-pointer items-center gap-0.5 font-medium",children:[(0,s.jsx)(ed.k,{kind:g.sourceKind,className:"h-3.5 w-3.5 shrink-0"}),(0,s.jsx)("span",{className:"truncate",children:g.sourceName})]})]}),(0,s.jsx)("div",{children:v?(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:[v," sources"]}):null})]})}),(0,s.jsx)(ea.vF,{className:"pb-0",children:(0,s.jsxs)("div",{className:"space-y-2 text-sm text-muted-foreground",children:[(null==o?void 0:o.fileList)&&(0,s.jsx)(ec,{title:"Read codebase structure ...",isLoading:i,isLastItem:"fileList"===b,children:(null==h?void 0:null===(t=h.fileList)||void 0===t?void 0:t.length)?(0,s.jsxs)(ei.yo,{children:[(0,s.jsx)(ei.aM,{children:(0,s.jsxs)("div",{className:"mb-3 mt-2 flex cursor-pointer flex-nowrap items-center gap-0.5 rounded-md bg-muted px-1.5 py-0.5 text-xs font-semibold hover:text-foreground",children:[(0,s.jsx)(U.IconListTree,{className:"h-3 w-3"}),(0,s.jsxs)("span",{children:[h.fileList.length," items"]})]})}),(0,s.jsxs)(ei.ue,{className:"flex w-[50vw] min-w-[300px] flex-col gap-0 px-4 pb-0",children:[(0,s.jsxs)(ei.Tu,{className:"border-b",children:[(0,s.jsxs)(ei.bC,{children:[h.fileList.length," items"]}),(0,s.jsx)(ei.sw,{})]}),(0,s.jsx)("pre",{className:"flex-1 overflow-auto py-3",children:h.fileList.join("\n")}),h.truncated&&(0,s.jsx)(ei.FF,{className:"!justify-start border-t py-3 font-medium",children:"File list truncated. (Maximum number of items has been reached)"})]})]}):null},"fileList"),(null==o?void 0:o.snippet)&&(0,s.jsx)(ec,{title:"Search for relevant code snippets ...",isLoading:l,defaultOpen:!l,isLastItem:"snippet"===b,children:(!!(null==u?void 0:u.length)||!!(null==c?void 0:c.length))&&(0,s.jsx)("div",{className:"mb-3 mt-2",children:(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 text-xs font-semibold",children:[null==u?void 0:u.map((e,t)=>(0,s.jsx)(eh,{context:e,clickable:!1,onContextClick:e=>null==x?void 0:x(e,!0),enableDeveloperMode:p},"client-".concat(t))),null==c?void 0:c.map((e,t)=>(0,s.jsx)(eh,{context:e,onContextClick:e=>null==x?void 0:x(e,!0),enableDeveloperMode:p},"server-".concat(t)))]})})},"snippet"),n&&(0,s.jsx)(ec,{title:"Collect documents ...",isLastItem:"docs"===b,isLoading:r,children:!!(null==m?void 0:m.length)&&(0,s.jsx)("div",{className:"mb-3 mt-2 space-y-1",children:(0,s.jsx)("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:null==m?void 0:m.map((e,t)=>{let n="MessageAttachmentCommitDoc"===e.__typename?e.sha:e.link;return(0,s.jsx)("div",{children:(0,s.jsxs)(el.zs,{openDelay:100,closeDelay:100,children:[(0,s.jsx)(el.Yi,{children:(0,s.jsx)(ex,{doc:e})}),(0,s.jsx)(el.bZ,{className:"w-96 bg-background text-sm text-foreground dark:border-muted-foreground/60",children:(0,s.jsx)(eo.Z,{enableDeveloperMode:p,relevantDocument:e})})]})},"".concat(n,"_").concat(t))})})})},"docs")]})})]})})}function eh(e){var t,n,l,i,r;let{context:o,clickable:d=!0,onContextClick:c,enableDeveloperMode:u}=e,m=o.filepath.split("/"),h=m.slice(0,m.length-1).join("/"),x=(0,a.useMemo)(()=>(0,F.UA)(o.filepath),[o.filepath]),f=null==o?void 0:null===(t=o.extra)||void 0===t?void 0:t.scores;return(0,s.jsxs)(O.u,{delayDuration:100,children:[(0,s.jsx)(O.aJ,{asChild:!0,children:(0,s.jsxs)("div",{className:(0,F.cn)("group flex flex-nowrap items-center gap-0.5 rounded-md bg-muted px-1.5 py-0.5",{"cursor-pointer hover:text-foreground":d}),onClick:e=>{d&&(null==c||c(o))},children:[(0,s.jsx)(U.IconFileText,{className:"h-3 w-3"}),(0,s.jsxs)("span",{children:[(0,s.jsx)("span",{children:x}),(0,s.jsx)(er.o,{className:(0,F.cn)("font-normal text-muted-foreground",{"group-hover:text-foreground":d}),range:o.range})]})]})}),(0,s.jsx)(O._v,{align:"start",sideOffset:8,className:"max-w-[24rem]",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"whitespace-nowrap font-medium",children:[(0,s.jsx)("span",{children:x}),(0,s.jsx)(er.o,{range:o.range})]}),!!h&&(0,s.jsx)("div",{className:"break-all text-xs text-muted-foreground",children:h}),u&&(null==o?void 0:null===(n=o.extra)||void 0===n?void 0:n.scores)&&(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("div",{className:"mb-1 font-semibold",children:"Scores"}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("span",{className:"w-20",children:"rrf:"}),null!==(l=null==f?void 0:f.rrf)&&void 0!==l?l:"-"]}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("span",{className:"w-20",children:"bm25:"}),null!==(i=null==f?void 0:f.bm25)&&void 0!==i?i:"-"]}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("span",{className:"w-20",children:"embedding:"}),null!==(r=null==f?void 0:f.embedding)&&void 0!==r?r:"-"]})]})]})]})})]})}function ex(e){let{doc:t}=e,n="MessageAttachmentIssueDoc"===t.__typename,a="MessageAttachmentPullDoc"===t.__typename,l="MessageAttachmentCommitDoc"===t.__typename,i=l?"".concat(t.sha.slice(0,7)):"#".concat(t.link.split("/").pop()),r=l?void 0:t.link,o=null;return n&&(o=t.closed?(0,s.jsx)(U.IconCheckCircled,{className:"h-3 w-3"}):(0,s.jsx)(U.IconCircleDot,{className:"h-3 w-3"})),a&&(o=t.merged?(0,s.jsx)(U.IconGitMerge,{className:"h-3 w-3"}):(0,s.jsx)(U.IconGitPullRequest,{className:"h-3 w-3"})),l&&(o=(0,s.jsx)(U.IconGitCommit,{className:"h-3 w-3"})),(0,s.jsxs)("div",{className:(0,F.cn)("flex flex-nowrap items-center gap-0.5 rounded-md bg-muted px-1.5 py-0.5 font-semibold hover:text-foreground",{"cursor-pointer":!!r}),onClick:()=>{r&&window.open(r)},children:[o,(0,s.jsx)("span",{children:i})]})}var ef=n(89811);function ep(e){let{isReadingDocs:t,webResources:n,docQueryResources:l}=e,i=null==n?void 0:n.length,{enableDeveloperMode:r}=(0,a.useContext)(eu);return(0,s.jsx)(ea.UQ,{collapsible:!0,type:"single",defaultValue:"readingCode",children:(0,s.jsxs)(ea.Qd,{value:"readingCode",className:"border-0",children:[(0,s.jsx)(ea.o4,{className:"w-full py-2 pr-2",children:(0,s.jsxs)("div",{className:"flex flex-1 items-center justify-between pr-2",children:[(0,s.jsxs)("div",{className:"flex flex-1 items-center gap-2",children:[(0,s.jsx)(U.IconBlocks,{className:"mr-2 h-5 w-5 shrink-0"}),(0,s.jsx)("span",{className:"shrink-0",children:"Look into"}),(0,s.jsx)("div",{className:"flex flex-1 flex-nowrap gap-2 truncate",children:null==l?void 0:l.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-1 rounded-lg border px-2 py-0 font-medium no-underline",children:[e.sourceKind===b.ri.Web?(0,s.jsx)(U.IconEmojiGlobe,{className:"h-3 w-3 shrink-0",emojiClassName:"text-sm"}):(0,s.jsx)(U.IconEmojiBook,{className:"h-3 w-3 shrink-0",emojiClassName:"text-sm"}),e.sourceName]},e.sourceId))})]}),(0,s.jsx)("div",{className:"shrink-0",children:i?(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:[i," sources"]}):null})]})}),(0,s.jsx)(ea.vF,{className:"pb-0",children:(0,s.jsx)("div",{className:"space-y-2 text-sm text-muted-foreground",children:(0,s.jsx)(ec,{title:"Collect documents ...",isLastItem:!0,isLoading:t,children:!!(null==n?void 0:n.length)&&(0,s.jsx)("div",{className:"mb-3 mt-2",children:(0,s.jsx)("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:n.map((e,t)=>{let n="MessageAttachmentCommitDoc"===e.__typename?e.sha:e.link;return(0,s.jsx)("div",{children:(0,s.jsxs)(el.zs,{openDelay:100,closeDelay:100,children:[(0,s.jsx)(el.Yi,{children:(0,s.jsx)("div",{className:"group cursor-pointer whitespace-nowrap rounded-md bg-muted px-1.5 py-0.5 font-semibold",onClick:()=>window.open(n),children:(0,s.jsx)(ev,{doc:e})})}),(0,s.jsx)(el.bZ,{className:"w-96 bg-background text-sm text-foreground dark:border-muted-foreground/60",children:(0,s.jsx)(eo.Z,{enableDeveloperMode:r,relevantDocument:e})})]})},"".concat(n,"_").concat(t))})})})})})})]})})}function ev(e){let{doc:t}=e;if("MessageAttachmentWebDoc"!==t.__typename)return null;let n=t?new URL(t.link):null;return(0,s.jsxs)("div",{className:"m-0 flex items-center space-x-1 text-xs leading-none text-muted-foreground group-hover:text-foreground",children:[(0,s.jsx)(ef.V,{hostname:n.hostname,className:"m-0 mr-1 leading-none"}),(0,s.jsx)("p",{className:"m-0 leading-none",children:n.hostname})]})}function eg(e){var t,n,l,i,r,o,c,u,m,h,x,f;let{className:p,message:v,userMessage:g,showRelatedQuestion:j,isLoading:b,isLastAssistantMessage:N,isDeletable:w,clientCode:y}=e,{onRegenerateResponse:C,onSubmitSearch:I,setDevPanelOpen:k,setConversationIdForDev:R,enableDeveloperMode:M,contextInfo:A,fetchingContextInfo:S,onDeleteMessage:L,isThreadOwner:D,onUpdateMessage:T,repositories:_}=(0,a.useContext)(eu),{supportsOnApplyInEditorV2:E}=(0,a.useContext)(et.p),P=(0,a.useMemo)(()=>{if(!(null==A?void 0:A.sources)||!(null==g?void 0:g.content))return[];let e=(0,F.b)(g.content,null==A?void 0:A.sources);return e.filter(e=>(0,F._q)(e.kind)).map(e=>({sourceId:e.id,sourceKind:e.kind,sourceName:e.label}))},[null==A?void 0:A.sources,null==g?void 0:g.content]),[V,O]=(0,a.useState)(!1),Z=b?U.IconSpinner:U.IconSparkles,Q=(0,a.useMemo)(()=>{var e;if(!v.codeSourceId||!(null==_?void 0:_.length))return"";let t=_.find(e=>e.sourceId===v.codeSourceId);return null!==(e=null==t?void 0:t.gitUrl)&&void 0!==e?e:""},[v.codeSourceId,_]),q=(0,a.useMemo)(()=>{var e;return(null==y?void 0:y.length)&&null!==(e=y.map(e=>({kind:"file",range:(0,F.OV)(e),filepath:e.filepath||"",content:e.content,gitUrl:Q})))&&void 0!==e?e:[]},[y,Q]),G=(0,a.useMemo)(()=>{var e,t,n;return null!==(n=null==v?void 0:null===(t=v.attachment)||void 0===t?void 0:null===(e=t.code)||void 0===e?void 0:e.map(e=>{var t,n;return{kind:"file",range:(0,F.OV)(e),filepath:e.filepath,content:e.content,gitUrl:e.gitUrl,commit:null!==(n=e.commit)&&void 0!==n?n:void 0,extra:{scores:null==e?void 0:null===(t=e.extra)||void 0===t?void 0:t.scores}}}))&&void 0!==n?n:[]},[null==v?void 0:null===(t=v.attachment)||void 0===t?void 0:t.code]),H=(0,a.useMemo)(()=>null==y?void 0:y.map(e=>({...e,gitUrl:Q})),[y,Q]),W=null==v?void 0:null===(n=v.attachment)||void 0===n?void 0:n.doc,Y=((null==H?void 0:H.length)||0)+((null===(i=v.attachment)||void 0===i?void 0:null===(l=i.code)||void 0===l?void 0:l.length)||0),K=(0,a.useMemo)(()=>null==W?void 0:W.filter(e=>"MessageAttachmentWebDoc"!==e.__typename),[W]),B=(0,a.useMemo)(()=>null==W?void 0:W.filter(e=>"MessageAttachmentWebDoc"===e.__typename),[W]),J=e=>{let t=(0,F.OV)(e);if(!e.filepath)return;let n=new URL("".concat(window.location.origin,"/files")),s=new URLSearchParams;s.append("redirect_filepath",e.filepath),s.append("redirect_git_url",e.gitUrl),e.commit&&s.append("redirect_rev",e.commit),n.search=s.toString();let a=(0,F.nO)(t);a&&(n.hash=a),window.open(n.toString())},ea=async e=>{let t=await T(e);if(t)return t;O(!1)},el=!!(null===(r=v.readingCode)||void 0===r?void 0:r.fileList)||!!(null===(u=v.attachment)||void 0===u?void 0:null===(c=u.codeFileList)||void 0===c?void 0:null===(o=c.fileList)||void 0===o?void 0:o.length),ei=(null===(m=v.readingCode)||void 0===m?void 0:m.snippet)||!!Y,er=!!v.codeSourceId,eo=!!(null==P?void 0:P.length);return(0,s.jsxs)("div",{className:(0,F.cn)("flex flex-col gap-y-5",p),children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"mb-1 flex h-8 items-center gap-x-1.5",children:[(0,s.jsx)(Z,{className:(0,F.cn)({"animate-spinner":b})}),(0,s.jsx)("p",{className:"text-sm font-bold leading-none",children:"Answer"}),M&&(0,s.jsx)(z.z,{variant:"ghost",size:"icon",onClick:()=>{R(v.id),k(!0)},children:(0,s.jsx)(U.IconBug,{})})]}),(er||eo)&&(0,s.jsxs)("div",{className:"mb-6 space-y-1.5",children:[er&&(0,s.jsx)(em,{clientCodeContexts:q,serverCodeContexts:G,isReadingFileList:v.isReadingFileList,isReadingCode:v.isReadingCode,isReadingDocs:v.isReadingDocs,codeSourceId:v.codeSourceId,docQuery:!0,docQueryResources:P,docs:K,codeFileList:null===(h=v.attachment)||void 0===h?void 0:h.codeFileList,readingCode:{fileList:el,snippet:ei},onContextClick:e=>{if(!e.filepath)return;let t=(0,F.XX)(window.location.origin,e);window.open(t,"_blank")}}),eo&&(0,s.jsx)(ep,{docQueryResources:P,isReadingDocs:v.isReadingDocs,webResources:B})]}),b&&!v.content&&(0,s.jsx)(ee.O,{className:"mt-1 h-40 w-full"}),V?(0,s.jsx)(ej,{message:v,onCancel:()=>O(!1),onSubmit:ea}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(es.J,{message:v.content,attachmentDocs:W,attachmentClientCode:H,attachmentCode:null===(x=v.attachment)||void 0===x?void 0:x.code,onCodeCitationClick:e=>{e.gitUrl&&J(e)},contextInfo:A,fetchingContextInfo:S,canWrapLongLines:!b,supportsOnApplyInEditorV2:E}),v.error&&(0,s.jsx)(es.m,{error:v.error}),!b&&!V&&(0,s.jsxs)("div",{className:"mt-3 flex items-center justify-between text-sm",children:[(0,s.jsx)("div",{className:"flex items-center gap-x-3",children:D&&(0,s.jsxs)(s.Fragment,{children:[!b&&!S&&N&&(0,s.jsxs)(z.z,{className:"flex items-center gap-x-1 px-1 font-normal text-muted-foreground",variant:"ghost",onClick:()=>C(v.id),children:[(0,s.jsx)(U.IconRefresh,{}),(0,s.jsx)("p",{children:"Regenerate"})]}),w&&(0,s.jsxs)(z.z,{className:"flex items-center gap-x-1 px-1 font-normal text-muted-foreground",variant:"ghost",onClick:()=>L(v.id),children:[(0,s.jsx)(U.IconTrash,{}),(0,s.jsx)("p",{children:"Delete"})]})]})}),(0,s.jsxs)("div",{className:"flex items-center gap-x-3",children:[(0,s.jsx)(en.q,{className:"-ml-1.5 gap-x-1 px-1 font-normal text-muted-foreground",value:(e=>{var t,n,s,a,l,i,r,o,c,u,m;if((0,$.Z)(null==e?void 0:null===(t=e.attachment)||void 0===t?void 0:t.doc)&&(0,$.Z)(null==e?void 0:null===(n=e.attachment)||void 0===n?void 0:n.code))return e.content;let h=e.content.replace(X.Hc,e=>{let t=null==e?void 0:e.match(/\d+/);return"[".concat(t,"]")}).trim(),x=null!==(c=null===(a=e.attachment)||void 0===a?void 0:null===(s=a.doc)||void 0===s?void 0:s.map((e,t)=>"MessageAttachmentCommitDoc"===e.__typename?"[".concat(t+1,"] ").concat(e.sha):"[".concat(t+1,"] ").concat(e.link)).join("\n"))&&void 0!==c?c:"",f=null!==(u=null===(i=e.attachment)||void 0===i?void 0:null===(l=i.doc)||void 0===l?void 0:l.length)&&void 0!==u?u:0,p=null!==(m=null===(o=e.attachment)||void 0===o?void 0:null===(r=o.code)||void 0===r?void 0:r.map((e,t)=>{let n=(0,F.tf)(e),s=(0,d.Z)([e.filepath,n]).join(":");return"[".concat(t+f+1,"] ").concat(s)}).join("\n"))&&void 0!==m?m:"";return"".concat(h,"\n\nCitations:\n").concat(x+p)})(v),text:"Copy"}),D&&(0,s.jsxs)(z.z,{className:"flex items-center gap-x-1 px-1 font-normal text-muted-foreground",variant:"ghost",onClick:e=>O(!0),children:[(0,s.jsx)(U.IconEdit,{}),(0,s.jsx)("p",{children:"Edit"})]})]})]})]})]}),j&&!V&&!b&&v.threadRelevantQuestions&&v.threadRelevantQuestions.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-x-1.5",children:[(0,s.jsx)(U.IconLayers,{}),(0,s.jsx)("p",{className:"text-sm font-bold leading-none",children:"Suggestions"})]}),(0,s.jsx)("div",{className:"mt-2 flex flex-col gap-y-3",children:null===(f=v.threadRelevantQuestions)||void 0===f?void 0:f.map((e,t)=>(0,s.jsxs)("div",{className:"flex cursor-pointer items-center justify-between rounded-lg border p-4 py-3 transition-opacity hover:opacity-70",onClick:I.bind(null,e),children:[(0,s.jsx)("p",{className:"w-full overflow-hidden text-ellipsis text-sm",children:e}),(0,s.jsx)(U.IconPlus,{})]},t))})]})]})}function ej(e){let{message:t,onCancel:n,onSubmit:l}=e,i=B.Ry({content:B.Z_().trim()}),r=(0,Y.cI)({resolver:(0,W.F)(i),defaultValues:{content:t.content}}),{isSubmitting:o}=r.formState,[d]=(0,a.useState)(t),c=async e=>{let t=await l({...d,content:e.content});t&&(0,T.zG)(r)(t)};return(0,s.jsx)(J.l0,{...r,children:(0,s.jsxs)("form",{onSubmit:r.handleSubmit(c),children:[(0,s.jsx)(J.Wi,{control:r.control,name:"content",render:e=>{let{field:t}=e;return(0,s.jsxs)(J.xJ,{children:[(0,s.jsx)(J.NI,{children:(0,s.jsx)(K.Z,{autoFocus:!0,minRows:2,maxRows:20,className:"w-full rounded-lg border bg-background p-4 outline-ring",...t})}),(0,s.jsx)(J.zG,{})]})}}),(0,s.jsxs)("div",{className:"my-4 flex items-center justify-between gap-2 px-2",children:[(0,s.jsx)("div",{children:(0,s.jsx)(J.zG,{})}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(z.z,{type:"button",variant:"outline",onClick:n,className:"min-w-[2rem]",children:"Cancel"}),(0,s.jsxs)(z.z,{type:"submit",disabled:o,children:[o&&(0,s.jsx)(U.IconSpinner,{className:"mr-2 h-4 w-4 animate-spin"}),"Save"]})]})]})]})})}var eb=n(90379);let eN=(0,a.lazy)(()=>n.e(726).then(n.t.bind(n,80726,23))),ew=e=>{let{value:t,isFullScreen:n,onToggleFullScreen:l,onClose:i}=e,[r]=(0,g.m3)(),{theme:o}=(0,w.X)(),d=(0,a.useRef)(null);return((0,a.useEffect)(()=>{if(t){var e;null===(e=d.current)||void 0===e||e.scrollTo({top:0,behavior:"smooth"})}},[t]),(null==r?void 0:r.value)&&open)?(0,s.jsxs)("div",{className:"flex h-full flex-col px-3 pt-2",children:[(0,s.jsx)("div",{className:"flex items-center justify-end pb-2",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(z.z,{variant:"ghost",size:"icon",onClick:e=>l(!n),children:(0,s.jsx)(U.IconChevronDown,{className:(0,F.cn)("transition-all",n?"":"rotate-180")})}),(0,s.jsx)(z.z,{variant:"ghost",size:"icon",onClick:i,children:(0,s.jsx)(U.IconClose,{})})]})}),(0,s.jsx)(a.Suspense,{fallback:(0,s.jsx)(eb.cg,{className:"p-2"}),children:t?(0,s.jsx)(P.ScrollArea,{className:"flex-1",ref:d,children:(0,s.jsx)(eN,{theme:"dark"===o?"tomorrow":"rjv-default",src:t,style:{fontSize:"0.75rem"},collapseStringsAfterLength:120})}):null})]}):null};var ey=n(73460),eC=n(68172),eI=n(61249),ek=n(63743),eR=n(52569),eM=n(7449);function eA(e){let{threadIdFromURL:t,streamingDone:n,threadId:l,onConvertToPage:i}=e,o=(0,r.useRouter)(),{isThreadOwner:d}=(0,a.useContext)(eu),[c,u]=(0,a.useState)(!1),[m,h]=(0,a.useState)(!1),[x]=(0,g.B2)(),p=(0,T.Db)(_.zW,{onCompleted(e){e.deleteThread?o.replace("/"):(f.A.error("Failed to delete"),h(!1))},onError(e){f.A.error((null==e?void 0:e.message)||"Failed to delete"),h(!1)}}),v=e=>{e&&(0,D.wh)(),o.push("/")};return(0,s.jsxs)("header",{className:"flex h-16 items-center justify-between px-4 lg:px-10",children:[(0,s.jsx)("div",{className:"flex items-center gap-x-6",children:(0,s.jsxs)(z.z,{variant:"ghost",className:"-ml-1 pl-0 text-sm text-muted-foreground",onClick:()=>v(),children:[(0,s.jsx)(U.IconChevronLeft,{className:"mr-1 h-5 w-5"}),"Home"]})}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[n&&t&&(0,s.jsx)(z.z,{variant:"ghost",className:"flex items-center gap-1 px-2 font-normal text-muted-foreground",onClick:()=>v(!0),children:(0,s.jsx)(U.IconPlus,{})}),n&&t&&d&&(0,s.jsxs)(ey.aR,{open:c,onOpenChange:u,children:[(0,s.jsx)(ey.vW,{asChild:!0,children:(0,s.jsx)(z.z,{size:"icon",variant:"hover-destructive",children:(0,s.jsx)(U.IconTrash,{})})}),(0,s.jsxs)(ey._T,{children:[(0,s.jsxs)(ey.fY,{children:[(0,s.jsx)(ey.f$,{children:"Delete this thread"}),(0,s.jsx)(ey.yT,{children:"Are you sure you want to delete this thread? This operation is not revertible."})]}),(0,s.jsxs)(ey.xo,{children:[(0,s.jsx)(ey.le,{children:"Cancel"}),(0,s.jsxs)(ey.OL,{className:(0,z.d)({variant:"destructive"}),onClick:e=>{e.preventDefault(),h(!0),p({id:t})},children:[m&&(0,s.jsx)(U.IconSpinner,{className:"mr-2 h-4 w-4 animate-spin"}),"Yes, delete it"]})]})]})]}),!!x.value&&n&&d&&l&&(0,s.jsx)(z.z,{variant:"ghost",onClick:e=>null==i?void 0:i(),className:"gap-1",children:"Convert to page"}),(0,s.jsx)(eC.q,{children:(0,s.jsx)(ek.T,{})}),(0,s.jsx)(eI.L,{className:"mr-4"}),(0,s.jsx)(eM.Z,{showHome:!1,showSetting:!0,beforeRouteChange:()=>{(0,D.wh)()},children:(0,s.jsx)(eR.SQ,{className:"h-10 w-10 border"})})]})]})}function eS(){return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(ee.O,{className:"w-full"}),(0,s.jsx)(ee.O,{className:"w-[70%]"})]}),(0,s.jsx)(ee.O,{className:"h-40 w-full"})]})}let eL=e=>{let{maxHeight:t=196,children:n}=e,[l,i]=(0,a.useState)(!0),[r,o]=(0,a.useState)(!1),d=(0,a.useRef)(null);return(0,a.useEffect)(()=>{d.current&&d.current.scrollHeight>t?o(!0):o(!1)},[t,n]),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{ref:d,className:(0,F.cn)("h-auto overflow-hidden",{"mb-8":r&&l}),style:{maxHeight:l?"".concat(t,"px"):"none"},children:n}),r&&(0,s.jsx)("div",{className:(0,F.cn)({"absolute right-0 -bottom-8 z-10":l,"flex justify-end my-1":!l}),children:(0,s.jsx)(z.z,{variant:"outline",size:"icon",onClick:()=>{i(!l)},children:(0,s.jsx)(U.IconChevronDown,{className:(0,F.cn)({"rotate-180":!l})})})}),l&&r&&(0,s.jsx)("div",{className:"absolute inset-x-0 bottom-0 h-9 bg-gradient-to-t from-background to-transparent"})]})};function eD(e){let{message:t,className:n,...l}=e,{contextInfo:i,fetchingContextInfo:r}=(0,a.useContext)(eu);return(0,s.jsx)("div",{className:(0,F.cn)("font-semibold",n),...l,children:(0,s.jsx)(eL,{children:(0,s.jsx)(es.J,{message:t.content,contextInfo:i,supportsOnApplyInEditorV2:!1,fetchingContextInfo:r,className:"text-xl prose-p:mb-2 prose-p:mt-0",headline:!0,canWrapLongLines:!0})})})}let eT={compress:5.3,expand:6.3},e_="_temp_msg_",eF=()=>"".concat(e_).concat((0,x.x0)());function ez(){var e,t,n,l,i;let m=(0,S.aK)(e=>e.pendingUserMessage),[{data:x}]=(0,C.P)(),{updateUrlComponents:j,pathname:G}=(0,R.Z)(),[W,$]=(0,a.useState)(),[Y,K]=(0,a.useState)(!1),B=(0,M.xG)(),[X,J]=(0,a.useState)([]),[ee,et]=(0,a.useState)(!0),[en,es]=(0,a.useState)(!!(null==m?void 0:m.content)),[ea,el]=(0,a.useState)(""),[ei,er]=(0,a.useState)(""),eo=(0,a.useRef)(null),[ed,ec]=(0,a.useState)(!1),[em]=(0,Q.Hb)(),eh=(0,r.useRouter)(),ex=(0,a.useRef)(!1),{theme:ef}=(0,w.X)(),[ep,ev]=(0,a.useState)(!1),[ej,eb]=(0,a.useState)(),eN=(0,a.useRef)(null),[ey,eC]=(0,a.useState)(45),eI=(0,a.useRef)(ey),[ek]=(0,g.m3)(),[eR,eM]=(0,a.useState)(),eL=(0,a.useMemo)(()=>{var e,t;if(W)return null===(t=W.match(/^\/search\/(.*)/))||void 0===t?void 0:null===(e=t[1])||void 0===e?void 0:e.split("-").pop()},[W]),eT=(0,T.Db)(eU),ez=async e=>{let t=X.findIndex(t=>t.id===e.id);if(!(t>-1)||!eR)return Error("Failed to save");{var n;let s=await eT({input:{threadId:eR,id:e.id,content:e.content}});if(null==s||null===(n=s.data)||void 0===n||!n.updateThreadMessage)return(null==s?void 0:s.error)||Error("Failed to save");await J(n=>{let s=[...n];return s[t]=e,s})}};(0,a.useEffect)(()=>{eL&&eM(eL)},[eL]);let[{data:eV,fetching:eO}]=(0,p.aM)({query:_.Gx}),[eZ,eQ]=(0,a.useState)(),[{data:eq,fetching:eG,error:eH}]=(0,p.aM)({query:_.XL,variables:{ids:[eR]},pause:!eR}),[{data:eW,error:e$,fetching:eY,stale:eK}]=(0,p.aM)({query:_.r4,variables:{threadId:eR,first:30,after:eZ},pause:!eR||en});(0,a.useEffect)(()=>{var e,t,n,s;if(!eK){if(null==eW?void 0:null===(t=eW.threadMessages)||void 0===t?void 0:null===(e=t.edges)||void 0===e?void 0:e.length){let e=eW.threadMessages.edges.map(e=>e.node).slice();J(t=>(0,h.Z)([...t,...e],"id"))}if(null==eW?void 0:eW.threadMessages){let e=null==eW?void 0:null===(s=eW.threadMessages)||void 0===s?void 0:null===(n=s.pageInfo)||void 0===n?void 0:n.hasNextPage,t=null==eW?void 0:eW.threadMessages.pageInfo.endCursor;e&&t?eQ(t):es(!0)}}},[eW]);let eB=(0,a.useMemo)(()=>{if(!x)return!1;if(!eL)return!0;let e=null==eq?void 0:eq.threads.edges[0];return!!e&&x.me.id===e.node.userId},[x,eq,eL]),eX=null==eV?void 0:eV.contextInfo.sources,eJ=null==X?void 0:null===(e=X[0])||void 0===e?void 0:e.content,e0=(0,a.useMemo)(()=>eX&&eJ?(0,F.i8)(eX,eJ,{maxLength:v.$I}):"",[eX,eJ]);(0,a.useEffect)(()=>{e0&&(document.title=e0)},[e0]),(0,a.useEffect)(()=>{e$&&!en&&es(!0)},[e$]);let{sendUserMessage:e1,isLoading:e4,error:e5,answer:e2,stop:e3,regenerate:e6,deleteThreadMessagePair:e8}=(0,A.x)({threadId:eR}),e7=(0,y.d)(e4),{selectedModel:e9,isFetchingModels:te,models:tt}=(0,I.Vq)(),{isFetchingRepositories:tn,repos:ts}=(0,k.Q)(),ta=(0,a.useMemo)(()=>X.find(e=>e.id===ej),[ej,X]),tl=(0,a.useMemo)(()=>ta?(0,c.Z)(null==ta?void 0:ta.attachment,"doc","code"):{answers:X.filter(e=>e.role===b.uU.Assistant).map(e=>(0,c.Z)(e,"doc","code"))},[ej,null==ta?void 0:null===(t=ta.attachment)||void 0===t?void 0:t.code,null==ta?void 0:null===(n=ta.attachment)||void 0===n?void 0:n.doc]),ti=(0,a.useMemo)(()=>{let e=[],t={question:null,answer:null};return X.forEach(n=>{n.role===b.uU.User?t.question=n:n.role!==b.uU.Assistant||t.answer||(t.answer=n,e.push(t),t={question:null,answer:null})}),e},[X]),tr=(0,a.useMemo)(()=>{var e,t,n;return null!==(n=null===(t=ti.find(e=>{var t;return!!(null===(t=e.answer)||void 0===t?void 0:t.codeSourceId)}))||void 0===t?void 0:null===(e=t.answer)||void 0===e?void 0:e.codeSourceId)&&void 0!==n?n:void 0},[ti]);(0,a.useEffect)(()=>{$(G),Y||K(!0)},[G]),(0,a.useEffect)(()=>{Y&&!eL&&(()=>{if(!ex.current){if(ex.current=!0,null==m?void 0:m.content){tm(m.content,m.context),(0,S.UP)(void 0);return}eR||((0,D.wh)(),eh.replace("/"))}})()},[Y]),(0,a.useEffect)(()=>{en&&setTimeout(()=>{ec(!0)},300)},[en]);let to=(0,a.useMemo)(()=>!eL&&(0,u.Z)(X,e=>!!e.error),[eL,X]),{isCopied:td,onShare:tc}=function(e){let{threadIdFromURL:t,threadIdFromStreaming:n,streamingDone:s,updateThreadURL:a,isEphemeral:l}=e,{isCopied:i,copyToClipboard:r}=(0,N.m)({timeout:2e3}),o=(0,T.Db)(_.md,{onError(e){f.A.error(e.message)}}),d=(!t||!0===l)&&s&&n&&a,c=async()=>{if(i)return;let e=window.location.href;d&&(await o({threadId:n}),e=a(n)),r(e)};return{onShare:c,isCopied:i}}({threadIdFromURL:eL,threadIdFromStreaming:eR,streamingDone:!e4,updateThreadURL:e=>{let t=(0,o.Z)(e0),n=(0,d.Z)([t,e]).join("-"),s=j({pathname:"/search/".concat(n),searchParams:{del:["q"]},replace:!0});return location.origin+s},isEphemeral:null==eq?void 0:null===(i=eq.threads.edges[0])||void 0===i?void 0:null===(l=i.node)||void 0===l?void 0:l.isEphemeral});(0,a.useEffect)(()=>{var e,t,n,s,a,l,i,r,o;e2.threadId&&e2.threadId!==eR&&eM(e2.threadId);let d=[...X],c=d.findIndex(e=>e.id===ea),u=d.findIndex(e=>e.id===ei);if(-1===c||-1===u)return;let m=d[c],h=d[u];h.content=e2.content,(null===(e=h.attachment)||void 0===e?void 0:e.code)||!e2.attachmentsCode||(h.attachment={clientCode:null,doc:(null===(l=h.attachment)||void 0===l?void 0:l.doc)||null,code:e2.attachmentsCode.map(e=>({...e.code,extra:{scores:e.scores}}))||null}),(null===(t=h.attachment)||void 0===t?void 0:t.doc)||!e2.attachmentsDoc||(h.attachment={clientCode:null,doc:e2.attachmentsDoc.map(e=>({...e.doc,extra:{score:e.score}}))||null,code:(null===(i=h.attachment)||void 0===i?void 0:i.code)||null}),!(null===(n=h.attachment)||void 0===n?void 0:n.codeFileList)&&(null==e2?void 0:null===(a=e2.attachmentsFileList)||void 0===a?void 0:null===(s=a.codeFileList)||void 0===s?void 0:s.length)&&(h.attachment={clientCode:null,doc:(null===(r=h.attachment)||void 0===r?void 0:r.doc)||null,codeFileList:{fileList:e2.attachmentsFileList.codeFileList,truncated:e2.attachmentsFileList.truncated},code:(null===(o=h.attachment)||void 0===o?void 0:o.code)||null}),h.threadRelevantQuestions=null==e2?void 0:e2.relevantQuestions,"isReadingCode"in e2&&(h.isReadingCode=e2.isReadingCode),"isReadingFileList"in e2&&(h.isReadingFileList=e2.isReadingFileList),"isReadingDocs"in e2&&(h.isReadingDocs=e2.isReadingDocs),h.readingCode=null==e2?void 0:e2.readingCode;let x=e2.userMessageId,f=e2.assistantMessageId;x&&f&&x!==m.id&&f!==h.id&&(m.id=x,h.id=f,el(x),er(f)),J(d)},[e4,e2]),(0,a.useEffect)(()=>{if(e5){let e=[...X],t=e.find(e=>e.id===ei);t&&(t.error=e5?"401"===e5.message?"Unauthorized":(0,u.Z)(e5.graphQLErrors,e=>{var t;return(null===(t=e.extensions)||void 0===t?void 0:t.code)===v.ir})?"The thread has expired or does not exist.":e5.message||"Failed to fetch":"Failed to fetch")}},[e5]);let tu=(0,a.useRef)();(0,a.useEffect)(()=>(e7.current&&(tu.current=window.setTimeout(()=>{if(!e7.current)return;et(!0);let e=null==eo?void 0:eo.current;e&&e.scrollTo({top:e.scrollHeight,behavior:"smooth"})},300)),e7.current||et(!1),()=>{window.clearTimeout(tu.current)}),[e4]),(0,a.useEffect)(()=>{var e,t,n;ep?(null===(e=eN.current)||void 0===e||e.expand(),null===(t=eN.current)||void 0===t||t.resize(ey)):null===(n=eN.current)||void 0===n||n.collapse()},[ep]);let tm=(e,t)=>{let{sourceIdForCodeQuery:n,sourceIdsForDocQuery:s,searchPublic:a}=eP(tr,t),l=eF(),i=eF(),r={id:l,role:b.uU.User,content:e},o={id:i,role:b.uU.Assistant,content:"",codeSourceId:n},d=n?{sourceId:n,content:e}:null;el(l),er(i),J([...X].concat([r,o])),e1({content:e},{generateRelevantQuestions:!0,codeQuery:d,docQuery:{sourceIds:s,content:e,searchPublic:!!a},modelName:null==t?void 0:t.modelName})},th=(0,a.useMemo)(()=>{var e,t;if(en&&!eG&&eL&&(eH||!(null==eq?void 0:null===(t=eq.threads)||void 0===t?void 0:null===(e=t.edges)||void 0===e?void 0:e.length)))return eH||Error(v.ir)},[eq,eG,eH,en,eL]),tx=em?{height:"calc(100vh - ".concat(Q.wt,")")}:{height:"100vh"};return B?en&&(th||e$)?(0,s.jsx)(eE,{error:th||e$,threadIdFromURL:eL}):(0,s.jsx)(eu.Provider,{value:{isLoading:e4,onRegenerateResponse:()=>{var e;if(!eR||eO)return;let t=X.length-1,n=t-1;if(-1===t||n<=-1)return;let s=X[n].id,a=X[t].id,l=X.slice(0,-2),i=X[n],r=X[t],o=(null==r?void 0:r.codeSourceId)||tr,d={...i,id:eF()},c={id:eF(),role:b.uU.Assistant,content:"",codeSourceId:o,attachment:{code:null,doc:null,clientCode:null},error:void 0},u=(0,F.b)(d.content,null==eV?void 0:null===(e=eV.contextInfo)||void 0===e?void 0:e.sources),{sourceIdForCodeQuery:m,sourceIdsForDocQuery:h,searchPublic:x}=eP(o,(0,F.G8)(u)),f=m?{sourceId:m,content:d.content}:null,p={sourceIds:h,content:d.content,searchPublic:x};el(d.id),er(c.id),J([...l,d,c]),e6({threadId:eR,userMessageId:s,assistantMessageId:a,userMessage:{content:d.content},threadRunOptions:{generateRelevantQuestions:!0,codeQuery:f,docQuery:p,modelName:e9}})},onSubmitSearch:tm,setDevPanelOpen:ev,setConversationIdForDev:eb,isPathnameInitialized:Y,enableDeveloperMode:ek.value,contextInfo:null==eV?void 0:eV.contextInfo,fetchingContextInfo:eO,onDeleteMessage:e=>{if(!eR)return;let t=X.findIndex(t=>t.id===e),n=t-1,s=X[t-1];if(-1!==t&&(null==s?void 0:s.role)===b.uU.User){if(s.id.startsWith(e_)&&e.startsWith(e_)){let e=X.slice(0,n).concat(X.slice(t+1));J(e);return}e8(eR,s.id,e).then(e=>{if(e){f.A.error(e);return}let s=X.slice(0,n).concat(X.slice(t+1));J(s)})}},isThreadOwner:eB,onUpdateMessage:ez,repositories:ts},children:(0,s.jsx)("div",{className:"transition-all",style:tx,children:(0,s.jsxs)(E.pO,{direction:"vertical",onLayout:e=>{(null==e?void 0:e[1])&&eC(e[1])},children:[(0,s.jsxs)(E.ee,{children:[(0,s.jsx)(eA,{threadIdFromURL:eL,streamingDone:!e4,threadId:eR,onConvertToPage:()=>{if(!eR)return;let e=null==X?void 0:X[0].content,t=(0,F.i8)(null!=eX?eX:[],e);(0,L.RU)({threadId:eR,title:t}),eh.push("/pages")}}),(0,s.jsx)(q.Z,{loading:!en,fallback:(0,s.jsxs)("div",{className:"mx-auto mt-24 w-full space-y-10 px-4 pb-32 lg:max-w-4xl lg:px-0",children:[(0,s.jsx)(eS,{}),(0,s.jsx)(eS,{})]}),children:(0,s.jsxs)("main",{className:"h-[calc(100%-4rem)] pb-8 lg:pb-0",children:[(0,s.jsx)(P.ScrollArea,{className:"h-full",ref:eo,children:(0,s.jsx)("div",{className:"mx-auto px-4 pb-32 lg:max-w-4xl lg:px-0",children:(0,s.jsx)("div",{className:"flex flex-col",children:ti.map((e,t)=>{var n,l;let i=t===ti.length-1;return e.question?(0,s.jsxs)(a.Fragment,{children:[!!e.question&&(0,s.jsx)(eD,{className:"pb-2 pt-8",message:e.question},e.question.id),!!e.answer&&(0,s.jsx)(eg,{className:"pb-8 pt-2",message:e.answer,userMessage:e.question,clientCode:null===(l=e.question)||void 0===l?void 0:null===(n=l.attachment)||void 0===n?void 0:n.clientCode,isLoading:e4&&i,isLastAssistantMessage:i,showRelatedQuestion:i,isDeletable:!e4&&X.length>2},e.answer.id),!i&&(0,s.jsx)(V.Z,{})]},e.question.id):null})})})}),(0,s.jsx)(Z.K,{className:(0,F.cn)("!fixed !bottom-[5.4rem] !right-4 !top-auto z-40 border-muted-foreground lg:!bottom-[2.85rem]",{hidden:ep}),container:eo.current,offset:100,style:"dark"===ef?{"--background":"0 0% 12%"}:{}}),(0,s.jsxs)("div",{className:(0,F.cn)("fixed bottom-5 left-0 z-30 flex min-h-[3rem] w-full flex-col items-center gap-y-2",{"opacity-100 translate-y-0":ed,"opacity-0 translate-y-10":!ed,hidden:ep}),style:Object.assign({transition:"all 0.35s ease-out"},"dark"===ef?{"--background":"0 0% 12%"}:{}),children:[(0,s.jsxs)("div",{className:(0,F.cn)("absolute flex items-center gap-4"),style:eB?{top:"-2.5rem"}:void 0,children:[ee&&(0,s.jsxs)(z.z,{className:"bg-background",variant:"outline",onClick:()=>e3(),children:[(0,s.jsx)(U.IconStop,{className:"mr-2"}),"Stop generating"]}),!ee&&(0,s.jsxs)(O.u,{delayDuration:0,children:[(0,s.jsx)(O.aJ,{asChild:!0,children:(0,s.jsx)("span",{tabIndex:0,children:(0,s.jsxs)(z.z,{className:"gap-2 bg-background",variant:"outline",onClick:tc,disabled:to,children:[to?(0,s.jsx)(U.IconInfoCircled,{}):td?(0,s.jsx)(U.IconCheck,{className:"text-green-600"}):(0,s.jsx)(U.IconShare,{}),"Share Link"]})})}),(0,s.jsx)(O._v,{hidden:!to,children:"Please resolve errors in messages before sharing this thread."})]})]}),eB&&(0,s.jsx)("div",{className:(0,F.cn)("relative z-20 flex justify-center self-stretch px-4"),children:(0,s.jsx)(H.Z,{onSearch:tm,className:"min-h-[5rem] lg:max-w-4xl",placeholder:"Ask a follow up question",isFollowup:!0,isLoading:e4,contextInfo:null==eV?void 0:eV.contextInfo,fetchingContextInfo:eO,modelName:e9,onSelectModel:e=>{(0,S.Eg)(e)},repoSourceId:tr,onSelectRepo:e=>{(0,S.xt)(e)},isInitializingResources:te||tn,models:tt})})]})]})})]}),(0,s.jsx)(E.Dp,{className:(0,F.cn)("hidden !h-[4px] border-none bg-background shadow-[0px_-4px_4px_rgba(0,0,0,0.2)] hover:bg-blue-500 active:bg-blue-500 dark:shadow-[0px_-4px_4px_rgba(255,255,255,0.2)]",ep&&"block")}),(0,s.jsx)(E.ee,{collapsible:!0,collapsedSize:0,defaultSize:0,ref:eN,onCollapse:()=>ev(!1),className:"z-50",children:(0,s.jsx)(ew,{onClose:()=>ev(!1),value:tl,isFullScreen:100===ey,onToggleFullScreen:e=>{var t;let n=eI.current;e?n=100:100===n&&(n=45),null===(t=eN.current)||void 0===t||t.resize(n),eC(n),eI.current=ey}})})]})})}):null}let eU=(0,j.BX)("\n  mutation UpdateThreadMessage($input: UpdateMessageInput!) {\n    updateThreadMessage(input: $input)\n  }\n");function eE(e){let{error:t,threadIdFromURL:n}=e;return t.message===v.ir?(0,s.jsx)(G.default,{}):(0,s.jsxs)("div",{className:"flex h-screen flex-col",children:[(0,s.jsx)(eA,{threadIdFromURL:n}),(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsxs)("div",{className:"flex h-full flex-col items-center justify-center gap-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(U.IconFileSearch,{className:"h-6 w-6"}),(0,s.jsx)("div",{className:"text-xl font-semibold",children:"Something went wrong"})]}),(0,s.jsx)("div",{children:"Failed to fetch the thread, please refresh the page or start a new thread"}),(0,s.jsxs)(i(),{href:"/",onClick:D.wh,className:(0,F.cn)((0,z.d)(),"mt-4 gap-2"),children:[(0,s.jsx)(U.IconPlus,{}),(0,s.jsx)("span",{children:"New Thread"})]})]})})]})}function eP(e,t){let n,s=[],a=!1;if(t){var l,i,r;s=(0,m.Z)((0,d.Z)([e,null==t?void 0:null===(l=t.codeSourceIds)||void 0===l?void 0:l[0]].concat(t.docSourceIds))),a=null!==(r=t.searchPublic)&&void 0!==r&&r,n=e||(null===(i=t.codeSourceIds)||void 0===i?void 0:i[0])||void 0}return{sourceIdsForDocQuery:s,sourceIdForCodeQuery:n,searchPublic:a}}},17448:function(e,t,n){"use strict";n.d(t,{p:function(){return a}});var s=n(3546);let a=(0,s.createContext)({})},21008:function(e,t,n){"use strict";n.d(t,{o:function(){return l}});var s=n(36164),a=n(57288);function l(e){let{range:t,className:n,prefix:l=":"}=e;if(!t)return null;let i=t.end-t.start>1;return(0,s.jsx)("span",{className:(0,a.cn)("text-muted-foreground",n),children:i?"".concat(l).concat(t.start,"-").concat(t.end):"".concat(l).concat(t.start)})}},69579:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return v}});var s=n(36164),a=n(42891),l=n.n(a),i=n(70652),r=n.n(i),o=n(83332),d=n(76531),c=n(57288),u=n(68172),m=n(30601),h=n(63743),x=n(31458),f=n(52569),p=n(7449);function v(){let[e]=(0,m.Hb)(),t=e?{height:"calc(100vh - ".concat(m.wt,")")}:{height:"100vh"};return(0,s.jsxs)("div",{style:t,className:"flex flex-col",children:[(0,s.jsx)(g,{}),(0,s.jsxs)("div",{className:"flex flex-1 flex-col items-center justify-center",children:[(0,s.jsx)("h2",{className:"mt-4 text-6xl font-bold tracking-tight text-foreground sm:text-7xl",children:"404"}),(0,s.jsx)("p",{className:"mt-4 text-lg text-muted-foreground",children:"Oops, it looks like the page you're looking for doesn't exist."}),(0,s.jsx)(r(),{className:(0,c.cn)("mt-6",(0,x.d)()),href:"/",children:"Home"})]})]})}function g(){return(0,s.jsxs)("header",{className:"flex h-16 items-center justify-between border-b px-4 lg:px-10",children:[(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsxs)(r(),{href:"/",children:[(0,s.jsx)(l(),{src:d.Z,alt:"logo",width:128,className:"dark:hidden"}),(0,s.jsx)(l(),{src:o.Z,alt:"logo",width:96,className:"hidden dark:block"})]})}),(0,s.jsxs)("div",{className:"flex items-center gap-6",children:[(0,s.jsx)(u.q,{children:(0,s.jsx)(h.T,{})}),(0,s.jsx)(p.Z,{showSetting:!0,children:(0,s.jsx)(f.SQ,{className:"h-10 w-10 border"})})]})]})}},65858:function(e,t,n){"use strict";n.d(t,{Qd:function(){return d},UQ:function(){return o},o4:function(){return c},vF:function(){return u}});var s=n(36164),a=n(3546),l=n(43739),i=n(14079),r=n(57288);let o=l.fC,d=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)(l.ck,{ref:t,className:(0,r.cn)("border-b",n),...a})});d.displayName="AccordionItem";let c=a.forwardRef((e,t)=>{let{className:n,children:a,showChevron:o=!0,...d}=e;return(0,s.jsxs)(l.xz,{ref:t,className:(0,r.cn)("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",n),...d,children:[a,o&&(0,s.jsx)(i.Z,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})});c.displayName=l.xz.displayName;let u=a.forwardRef((e,t)=>{let{className:n,children:a,...i}=e;return(0,s.jsx)(l.VY,{ref:t,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...i,children:(0,s.jsx)("div",{className:(0,r.cn)("pb-4 pt-0",n),children:a})})});u.displayName=l.VY.displayName},73460:function(e,t,n){"use strict";n.d(t,{OL:function(){return v},_T:function(){return m},aR:function(){return o},f$:function(){return f},fY:function(){return h},le:function(){return g},vW:function(){return d},xo:function(){return x},yT:function(){return p}});var s=n(36164),a=n(3546),l=n(91460),i=n(57288),r=n(31458);let o=l.fC,d=l.xz,c=e=>{let{className:t,children:n,...a}=e;return(0,s.jsx)(l.h_,{className:(0,i.cn)(t),...a,children:(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-end justify-center sm:items-center",children:n})})};c.displayName=l.h_.displayName;let u=a.forwardRef((e,t)=>{let{className:n,children:a,...r}=e;return(0,s.jsx)(l.aV,{className:(0,i.cn)("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm transition-opacity animate-in fade-in",n),...r,ref:t})});u.displayName=l.aV.displayName;let m=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsxs)(c,{children:[(0,s.jsx)(u,{}),(0,s.jsx)(l.VY,{ref:t,className:(0,i.cn)("fixed z-50 grid w-full max-w-lg scale-100 gap-4 border bg-background p-6 opacity-100 shadow-lg animate-in fade-in-90 slide-in-from-bottom-10 sm:rounded-lg sm:zoom-in-90 sm:slide-in-from-bottom-0 md:w-full",n),...a})]})});m.displayName=l.VY.displayName;let h=e=>{let{className:t,...n}=e;return(0,s.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...n})};h.displayName="AlertDialogHeader";let x=e=>{let{className:t,...n}=e;return(0,s.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...n})};x.displayName="AlertDialogFooter";let f=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)(l.Dx,{ref:t,className:(0,i.cn)("text-lg font-semibold",n),...a})});f.displayName=l.Dx.displayName;let p=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)(l.dk,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",n),...a})});p.displayName=l.dk.displayName;let v=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)(l.aU,{ref:t,className:(0,i.cn)((0,r.d)(),n),...a})});v.displayName=l.aU.displayName;let g=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)(l.$j,{ref:t,className:(0,i.cn)((0,r.d)({variant:"outline"}),"mt-2 sm:mt-0",n),...a})});g.displayName=l.$j.displayName},98150:function(e,t,n){"use strict";n.d(t,{NI:function(){return p},Wi:function(){return u},l0:function(){return d},lX:function(){return f},pf:function(){return v},xJ:function(){return x},zG:function(){return g}});var s=n(36164),a=n(3546),l=n(74047),i=n(5493),r=n(57288),o=n(5266);let d=i.RV,c=a.createContext({}),u=e=>{let{...t}=e;return(0,s.jsx)(c.Provider,{value:{name:t.name},children:(0,s.jsx)(i.Qr,{...t})})},m=()=>{let e=a.useContext(c),t=a.useContext(h),{getFieldState:n,formState:s}=(0,i.Gc)(),l=e.name||"root",r=n(l,s);if(!s)throw Error("useFormField should be used within <Form>");let{id:o}=t;return{id:o,name:l,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message"),...r}},h=a.createContext({}),x=a.forwardRef((e,t)=>{let{className:n,...l}=e,i=a.useId();return(0,s.jsx)(h.Provider,{value:{id:i},children:(0,s.jsx)("div",{ref:t,className:(0,r.cn)("space-y-2",n),...l})})});x.displayName="FormItem";let f=a.forwardRef((e,t)=>{let{className:n,required:a,...l}=e,{error:i,formItemId:d}=m();return(0,s.jsx)(o._,{ref:t,className:(0,r.cn)(i&&"text-destructive",a&&'after:ml-0.5 after:text-destructive after:content-["*"]',n),htmlFor:d,...l})});f.displayName="FormLabel";let p=a.forwardRef((e,t)=>{let{...n}=e,{error:a,formItemId:i,formDescriptionId:r,formMessageId:o}=m();return(0,s.jsx)(l.g7,{ref:t,id:i,"aria-describedby":a?"".concat(r," ").concat(o):"".concat(r),"aria-invalid":!!a,...n})});p.displayName="FormControl";let v=a.forwardRef((e,t)=>{let{className:n,...a}=e,{formDescriptionId:l}=m();return(0,s.jsx)("div",{ref:t,id:l,className:(0,r.cn)("text-sm text-muted-foreground",n),...a})});v.displayName="FormDescription";let g=a.forwardRef((e,t)=>{let{className:n,children:a,...l}=e,{error:i,formMessageId:o}=m(),d=i?String(null==i?void 0:i.message):a;return d?(0,s.jsx)("p",{ref:t,id:o,className:(0,r.cn)("text-sm font-medium text-destructive",n),...l,children:d}):null});g.displayName="FormMessage"},53538:function(e,t,n){"use strict";n.d(t,{Dp:function(){return o},ee:function(){return r},pO:function(){return i}});var s=n(36164),a=n(6618),l=n(57288);let i=e=>{let{className:t,...n}=e;return(0,s.jsx)(a.eh,{className:(0,l.cn)("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",t),...n})},r=a.s_,o=e=>{let{withHandle:t,className:n,...i}=e;return(0,s.jsx)(a.OT,{className:(0,l.cn)("border-bg relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",n),...i,children:t&&(0,s.jsx)("div",{className:"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border"})})}},25600:function(e,t,n){"use strict";n.d(t,{FF:function(){return v},Tu:function(){return p},aM:function(){return c},bC:function(){return g},sw:function(){return u},ue:function(){return f},yo:function(){return d}});var s=n(36164),a=n(3546),l=n(4318),i=n(14375),r=n(1663),o=n(57288);let d=l.fC,c=l.xz,u=l.x8,m=l.h_,h=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)(l.aV,{className:(0,o.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",n),...a,ref:t})});h.displayName=l.aV.displayName;let x=(0,i.j)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),f=a.forwardRef((e,t)=>{let{side:n="right",className:a,children:i,...d}=e;return(0,s.jsxs)(m,{children:[(0,s.jsx)(h,{}),(0,s.jsxs)(l.VY,{ref:t,className:(0,o.cn)(x({side:n}),a),...d,children:[i,(0,s.jsxs)(l.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,s.jsx)(r.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=l.VY.displayName;let p=e=>{let{className:t,...n}=e;return(0,s.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...n})};p.displayName="SheetHeader";let v=e=>{let{className:t,...n}=e;return(0,s.jsx)("div",{className:(0,o.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...n})};v.displayName="SheetFooter";let g=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)(l.Dx,{ref:t,className:(0,o.cn)("text-lg font-semibold text-foreground",n),...a})});g.displayName=l.Dx.displayName;let j=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)(l.dk,{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",n),...a})});j.displayName=l.dk.displayName},93877:function(e,t,n){"use strict";n.d(t,{B2:function(){return c},m3:function(){return o}});var s=n(3546);let a=(e,t)=>{let[n,a]=(0,s.useState)(t),[l,i]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{let t=localStorage.getItem(e);t&&a(JSON.parse(t)),i(!1)},[]),[n,t=>{a(t),localStorage.setItem(e,JSON.stringify(t))},l]};class l{get value(){if("undefined"!=typeof localStorage){let e=localStorage.getItem(this.storageKey);if(e)return"true"===e}return this.defaultValue}constructor(e,t,n,s){this.storageKey=e,this.title=t,this.description=n,this.defaultValue=s}}class i{defineGlobalVar(){return new l(this.storageKey,this.title,this.description,this.defaultValue)}defineHook(){return()=>{let[e,t,n]=a(this.storageKey,this.defaultValue);return[{value:e,title:this.title,description:this.description,loading:n},()=>{t(!e)}]}}constructor(e,t,n,s){this.storageKey="EXP_".concat(e),this.title=t,this.description=n,this.defaultValue=null!=s&&s}}let r=new i("enable_developer_mode","Developer Mode","Enable the developer mode. The features involved include the Answer Engine.",!1);r.defineGlobalVar();let o=r.defineHook(),d=new i("enable_page","Page","Enable Page. This feature allows you to convert threads to page.",!1);d.defineGlobalVar();let c=d.defineHook()},44645:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var s=n(3546),a=n(11978);function l(){let e=(0,a.usePathname)(),t=(0,a.useRouter)(),n=(0,a.useSearchParams)(),l=(0,s.useCallback)(e=>{let t=new URLSearchParams(n);e&&Object.entries(e).forEach(e=>{let[n,s]=e;return t.set(n,s)});let s=t.toString();return s.length>0?"?".concat(s):""},[n]),i=(0,s.useCallback)(s=>{let a=function(e,t,n){var s,a;let l=null===(s=n.searchParams)||void 0===s?void 0:s.set,i=null===(a=n.searchParams)||void 0===a?void 0:a.del,r=new URLSearchParams(t);l&&Object.entries(l).forEach(e=>{let[t,n]=e;return r.set(t,n)}),i&&(Array.isArray(i)?i.forEach(e=>r.delete(e)):r.delete(i));let o=r.toString(),d=e;return o.length>0&&(d+="?".concat(o)),n.hash&&(d+="#".concat(n.hash.replace(/^#/,""))),d}((null==s?void 0:s.pathname)||e,n,s);return s.replace?t.replace(a):t.push(a),a},[e,n]);return{pathname:e,router:t,searchParams:n,getQueryString:l,updateUrlComponents:i}}},64566:function(e,t,n){"use strict";n.d(t,{x:function(){return u}});var s=n(3546),a=n(43240),l=n(11634),i=n(16784);let r=(0,a.BX)("\n  subscription CreateThreadAndRun($input: CreateThreadAndRunInput!) {\n    createThreadAndRun(input: $input) {\n      __typename\n      ... on ThreadCreated {\n        id\n      }\n      ... on ThreadUserMessageCreated {\n        id\n      }\n      ... on ThreadAssistantMessageCreated {\n        id\n      }\n      ... on ThreadAssistantMessageReadingCode {\n        snippet\n        fileList\n      }\n      ... on ThreadRelevantQuestions {\n        questions\n      }\n      ... on ThreadAssistantMessageAttachmentsCodeFileList {\n        codeFileList: fileList\n        truncated\n      }\n      ... on ThreadAssistantMessageAttachmentsCode {\n        hits {\n          code {\n            gitUrl\n            commit\n            filepath\n            language\n            content\n            startLine\n          }\n          scores {\n            rrf\n            bm25\n            embedding\n          }\n        }\n      }\n      ... on ThreadAssistantMessageAttachmentsDoc {\n        hits {\n          doc {\n            __typename\n            ... on MessageAttachmentWebDoc {\n              title\n              link\n              content\n            }\n            ... on MessageAttachmentIssueDoc {\n              title\n              link\n              author {\n                id\n                email\n                name\n              }\n              body\n              closed\n            }\n            ... on MessageAttachmentPullDoc {\n              title\n              link\n              author {\n                id\n                email\n                name\n              }\n              body\n              merged\n            }\n            ... on MessageAttachmentCommitDoc {\n              sha\n              message\n              author {\n                id\n                email\n                name\n              }\n              authorAt\n            }\n          }\n          score\n        }\n      }\n      ... on ThreadAssistantMessageContentDelta {\n        delta\n      }\n      ... on ThreadAssistantMessageCompleted {\n        id\n      }\n    }\n  }\n"),o=(0,a.BX)("\n  subscription CreateThreadRun($input: CreateThreadRunInput!) {\n    createThreadRun(input: $input) {\n      __typename\n      ... on ThreadCreated {\n        id\n      }\n      ... on ThreadUserMessageCreated {\n        id\n      }\n      ... on ThreadAssistantMessageCreated {\n        id\n      }\n      ... on ThreadAssistantMessageReadingCode {\n        snippet\n        fileList\n      }\n      ... on ThreadRelevantQuestions {\n        questions\n      }\n      ... on ThreadAssistantMessageAttachmentsCodeFileList {\n        codeFileList: fileList\n        truncated\n      }\n      ... on ThreadAssistantMessageAttachmentsCode {\n        hits {\n          code {\n            gitUrl\n            commit\n            filepath\n            language\n            content\n            startLine\n          }\n          scores {\n            rrf\n            bm25\n            embedding\n          }\n        }\n      }\n      ... on ThreadAssistantMessageAttachmentsDoc {\n        hits {\n          doc {\n            __typename\n            ... on MessageAttachmentWebDoc {\n              title\n              link\n              content\n            }\n            ... on MessageAttachmentIssueDoc {\n              title\n              link\n              author {\n                id\n                email\n                name\n              }\n              body\n              closed\n            }\n            ... on MessageAttachmentPullDoc {\n              title\n              link\n              author {\n                id\n                email\n                name\n              }\n              body\n              merged\n            }\n            ... on MessageAttachmentCommitDoc {\n              sha\n              message\n              author {\n                id\n                email\n                name\n              }\n              authorAt\n            }\n          }\n          score\n        }\n      }\n      ... on ThreadAssistantMessageContentDelta {\n        delta\n      }\n      ... on ThreadAssistantMessageCompleted {\n        id\n      }\n    }\n  }\n"),d=(0,a.BX)("\n  mutation DeleteThreadMessagePair(\n    $threadId: ID!\n    $userMessageId: ID!\n    $assistantMessageId: ID!\n  ) {\n    deleteThreadMessagePair(\n      threadId: $threadId\n      userMessageId: $userMessageId\n      assistantMessageId: $assistantMessageId\n    )\n  }\n"),c=()=>({content:"",completed:!1,isReadingCode:!1,isReadingFileList:!1,isReadingDocs:!0});function u(e){let{threadId:t,onAssistantMessageCompleted:n}=e,[a,u]=s.useState(t),m=s.useRef(),[h,x]=s.useState(!1),[f,p]=s.useState(c()),[v,g]=s.useState(),j=(e,t)=>{let n={...e};switch(t.__typename){case"ThreadCreated":n.threadId=t.id;break;case"ThreadUserMessageCreated":n.userMessageId=t.id;break;case"ThreadAssistantMessageCreated":n.assistantMessageId=t.id;break;case"ThreadRelevantQuestions":n.relevantQuestions=t.questions;break;case"ThreadAssistantMessageReadingCode":n.isReadingCode=!0,n.isReadingFileList=!0,n.isReadingDocs=!0,n.readingCode={fileList:t.fileList,snippet:t.snippet};break;case"ThreadAssistantMessageAttachmentsCodeFileList":n.isReadingFileList=!1,n.attachmentsFileList=t;break;case"ThreadAssistantMessageAttachmentsCode":n.isReadingCode=!1,n.attachmentsCode=t.hits;break;case"ThreadAssistantMessageAttachmentsDoc":n.attachmentsDoc=t.hits,n.isReadingDocs=!1;break;case"ThreadAssistantMessageContentDelta":n.isReadingCode=!1,n.isReadingFileList=!1,n.isReadingDocs=!1,n.content+=t.delta;break;case"ThreadAssistantMessageCompleted":n.completed=!0}return n},b=(0,i.d)(e=>{var t;null===(t=m.current)||void 0===t||t.call(m),m.current=void 0,x(!1),p(e=>({...e,isReadingCode:!1,isReadingFileList:!1,isReadingDocs:!1,completed:!0})),!e&&a&&(null==n||n(f))});s.useEffect(()=>{t!==a&&u(t)},[t]);let N=(e,t)=>{let{unsubscribe:n}=l.Lp.subscription(r,{input:{thread:{userMessage:e},options:t}}).subscribe(e=>{var t;if(null==e?void 0:e.error){x(!1),g(e.error),n();return}let s=null===(t=e.data)||void 0===t?void 0:t.createThreadAndRun;s&&((null==s?void 0:s.__typename)==="ThreadAssistantMessageCompleted"&&b.current(),(null==s?void 0:s.__typename)==="ThreadCreated"&&s.id!==a&&u(s.id),p(e=>j(e,s)))});return n},w=(e,t)=>{if(!a)return;let{unsubscribe:n}=l.Lp.subscription(o,{input:{threadId:a,additionalUserMessage:e,options:t}}).subscribe(e=>{var t;if(null==e?void 0:e.error){x(!1),g(e.error),n();return}let s=null===(t=e.data)||void 0===t?void 0:t.createThreadRun;s&&("ThreadAssistantMessageCompleted"===s.__typename&&b.current(),p(e=>j(e,s)))});return n},y=(0,l.Db)(d),C=(e,t)=>{h||(x(!0),g(void 0),p(c()),a?m.current=w(e,t):m.current=N(e,t))},I=(e,t,n)=>y({threadId:e,userMessageId:t,assistantMessageId:n}).then(e=>{var t;if(!(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.deleteThreadMessagePair)){if(null==e?void 0:e.error)throw e.error;throw Error("Failed to fetch")}});return{isLoading:h,answer:f,error:v,sendUserMessage:C,stop:b.current,regenerate:e=>a?(x(!0),g(void 0),p(c()),I(e.threadId,e.userMessageId,e.assistantMessageId).then(()=>{C(e.userMessage,e.threadRunOptions)}).catch(e=>{let t=e instanceof Error?e:Error("Failed to fetch");g(t),x(!1)})):Promise.resolve(void 0),deleteThreadMessagePair:I}}},96274:function(e,t,n){"use strict";n.d(t,{BO:function(){return o},RU:function(){return r},uz:function(){return l}});var s=n(27257);let a={pendingThreadId:void 0,pendingThreadTitle:void 0},l=(0,s.Ue)()(()=>({...a})),i=l.setState,r=e=>{let{threadId:t,title:n}=e;i(()=>({pendingThreadId:t,pendingThreadTitle:n}))},o=()=>{i(()=>({pendingThreadId:void 0,pendingThreadTitle:void 0}))}},76531:function(e,t){"use strict";t.Z={src:"/_next/static/media/logo.526f7cf9.png",height:184,width:607,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAACCAYAAABllJ3tAAAASklEQVR4nGPsKQh1f/HshV/PqtNtagrC8p++//rDAgQM//9/ZWJifMZYnRqg9+bVq6iZ51+1SP/5ovH//z8eRgbGbwyMjPxA9n0AMi8g2L1xUkUAAAAASUVORK5CYII=",blurWidth:8,blurHeight:2}}},function(e){e.O(0,[7565,8415,4648,6527,7430,55,1652,340,4007,2546,1283,3087,2578,8511,240,4421,3179,7070,1454,1002,1460,6805,4546,6065,9275,5605,3721,2991,8994,5738,1012,7023,3904,9590,7288,1565,4656,1363,9634,640,8708,3375,5289,1744],function(){return e(e.s=46576)}),_N_E=e.O()}]);