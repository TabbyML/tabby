(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[357],{51848:function(e,t,n){Promise.resolve().then(n.bind(n,56922))},56922:function(e,t,n){"use strict";n.r(t),n.d(t,{SourceCodeBrowser:function(){return W},SourceCodeBrowserContext:function(){return H}});var r=n(57437),i=n(2265),l=n(30415),o=n.n(l),a=n(72999),s=n(16630),u=n(91067),d=n(1589),c=n(24033),f=n(1592),v=n(39311),h=n(61574);let m=e=>{let{className:t,...n}=e;return(0,r.jsx)(h.eh,{className:(0,v.cn)("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",t),...n})},p=h.s_,x=e=>{let{withHandle:t,className:n,...i}=e;return(0,r.jsx)(h.OT,{className:(0,v.cn)("border-bg relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",n),...i,children:t&&(0,r.jsx)("div",{className:"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border"})})};var g=n(33555);let b=e=>{let{className:t}=e,{currentFileRoutes:n,setActivePath:l,activePath:o}=i.useContext(H);return(0,r.jsxs)("div",{className:(0,v.cn)("flex flex-nowrap items-center gap-1 leading-8",t),children:[(0,r.jsx)("div",{className:"cursor-pointer font-medium text-primary hover:underline",onClick:e=>l(void 0),children:"Repositories"}),(0,r.jsx)("div",{children:"/"}),null==n?void 0:n.map((e,t)=>{let o=0===t&&(null==n?void 0:n.length)>1,a=t===n.length-1;return(0,r.jsxs)(i.Fragment,{children:[(0,r.jsx)("div",{className:(0,v.cn)(o||a?"font-bold":"font-medium",a?"":"cursor-pointer text-primary hover:underline",o?"hover:underline":void 0),onClick:t=>l(e.fullPath),children:e.name}),"file"!==e.file.kind&&(0,r.jsx)("div",{children:"/"})]},e.fullPath)}),!!(null==n?void 0:n.length)&&!!o&&(0,r.jsx)(g.q,{value:o})]})};var j=n(83390),y=n(95376);function k(e,t){let[n,r]=i.useState(e);return i.useEffect(()=>{let n=setTimeout(()=>{r(e)},t);return()=>clearTimeout(n)},[e,t]),n}var N=n(84168),w=n(25645),S=n(32553),T=n(24144);function P(e){var t;return e?null===(t=e.split("/"))||void 0===t?void 0:t[0]:""}function E(e){return e?e.split("/").slice(1).join("/"):""}function C(e){if(!e)return"";let t=e.split("/");return t[t.length-1]}function I(e,t){if((0,T.Z)(e))return[];let n=[""],r=e.split("/"),i=t?r.length:r.length-1;for(let e=0;e<i;e++)n.push(r.slice(0,e+1).join("/"));return n}let R=e=>{let{className:t,loading:n,initialized:l}=e,{activePath:o,currentFileRoutes:a,setActivePath:s,fileTreeData:u}=i.useContext(H),d=i.useMemo(()=>(function(e,t){if(!(null==e?void 0:e.length))return[];if(t){let n=t.split("/"),r=e;for(;n.length;){let e=n.shift(),t=(0,j.Z)(r,t=>t.name===e);if(null==t||!t.children)return[];r=null==t?void 0:t.children}return(null==r?void 0:r.map(e=>(0,y.Z)(e,"children")))||[]}{let t=e.map(e=>(0,y.Z)(e,"children"))||[];return t}})(u,o),[u,o]),c=k(n,300),f=(null==a?void 0:a.length)>0,h=()=>{var e;let t=null===(e=a[(null==a?void 0:a.length)-2])||void 0===e?void 0:e.fullPath;s(t)},m=e=>{s(e.fullPath)};return(0,r.jsx)("div",{className:(0,v.cn)("text-base",t),children:c||!l?(0,r.jsx)(O,{}):(null==u?void 0:u.length)?(0,r.jsx)(S.iA,{children:(0,r.jsxs)(S.RM,{children:[f&&(0,r.jsx)(S.SC,{className:"cursor-pointer",onClick:e=>h(),children:(0,r.jsx)(S.pj,{className:"p-1 px-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"shrink-0",children:(0,r.jsx)(N.IconDirectorySolid,{style:{color:"rgb(84, 174, 255)"}})}),(0,r.jsx)("span",{className:"px-1 py-2",children:".."})]})})}),(0,r.jsx)(r.Fragment,{children:d.map(e=>(0,r.jsx)(S.SC,{children:(0,r.jsx)(S.pj,{className:"p-1 px-4 text-base",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"shrink-0",children:"dir"===e.file.kind?(0,r.jsx)(N.IconDirectorySolid,{style:{color:"rgb(84, 174, 255)"}}):(0,r.jsx)(N.IconFile,{})}),(0,r.jsx)("span",{onClick:t=>m(e),className:"cursor-pointer px-1 py-2 hover:text-primary hover:underline",children:C(e.fullPath)})]})})},e.fullPath))})]})}):(0,r.jsx)("div",{className:"flex justify-center py-8",children:"No indexed repository yet"})})};function O(){return(0,r.jsxs)("ul",{className:"space-y-3 p-2",children:[(0,r.jsx)(w.O,{}),(0,r.jsx)(w.O,{}),(0,r.jsx)(w.O,{}),(0,r.jsx)(w.O,{})]})}let A=i.createContext({}),$=e=>{let{onSelectTreeNode:t,children:n,activePath:i,fileMap:l,updateFileMap:o,expandedKeys:a,toggleExpandedKey:s,initialized:u,fileTreeData:d}=e;return(0,r.jsx)(A.Provider,{value:{onSelectTreeNode:t,fileTreeData:d,expandedKeys:a,toggleExpandedKey:s,activePath:i,fileMap:l,updateFileMap:o,initialized:u},children:n})},Z=e=>{let{level:t}=e,n=i.useMemo(()=>Array(t).fill(1),[t]);return(0,r.jsx)("div",{className:"flex h-full shrink-0 items-stretch",children:n.map((e,t)=>(0,r.jsx)("div",{className:"flex h-8 w-2 border-r border-transparent transition-colors duration-300 group-hover/filetree:border-border"},t))})},M=()=>(0,r.jsx)("div",{className:"absolute -left-2 h-8 w-1 rounded-md bg-primary"}),z=e=>{let{isActive:t,level:n,children:i,className:l,...o}=e;return(0,r.jsxs)("div",{className:(0,v.cn)("relative flex cursor-pointer items-stretch rounded-sm hover:bg-accent focus:bg-accent focus:text-accent-foreground",t&&"bg-accent",l),...o,children:[t&&(0,r.jsx)(M,{}),(0,r.jsx)(Z,{level:n}),(0,r.jsxs)("div",{className:"flex flex-nowrap items-center gap-2 truncate whitespace-nowrap",children:[(0,r.jsx)("div",{className:"h-4 w-4 shrink-0"}),i]})]})},D=e=>{let{children:t,level:n,isActive:i,className:l,...o}=e;return(0,r.jsxs)("div",{className:(0,v.cn)("relative flex cursor-pointer items-stretch rounded-sm hover:bg-accent focus:bg-accent focus:text-accent-foreground",i?"bg-accent text-accent-foreground":void 0,l),...o,children:[i&&(0,r.jsx)(M,{}),(0,r.jsx)(Z,{level:n}),(0,r.jsx)("div",{className:"flex flex-nowrap items-center gap-2 truncate whitespace-nowrap",children:t})]})},q=e=>{let{node:t,level:n}=e,{onSelectTreeNode:l,activePath:o}=i.useContext(A),a="file"===t.file.kind,s=t.fullPath===o;return(0,r.jsxs)(z,{level:n,onClick:e=>{a&&(null==l||l(t))},isActive:s,children:[(0,r.jsx)(N.IconFile,{className:"shrink-0"}),(0,r.jsx)("div",{className:"truncate",children:null==t?void 0:t.name})]})},F=e=>{var t,n,l;let{node:o,level:a,root:s}=e,{fileMap:u,updateFileMap:c,expandedKeys:v,toggleExpandedKey:h,onSelectTreeNode:m,activePath:p}=i.useContext(A),x=i.useRef(!1),g=i.useMemo(()=>P(o.fullPath),[o.fullPath]),b=s?"":o.file.basename,j=v.has(o.fullPath),y="dir"===o.file.kind&&!(null==u?void 0:null===(t=u[o.fullPath])||void 0===t?void 0:t.treeExpanded)&&j,{data:w,isValidating:S}=(0,d.Z)(y?"/repositories/".concat(g,"/resolve/").concat(b):null,f.Z,{revalidateIfStale:!1});i.useEffect(()=>{var e;if(!x.current&&(null==w?void 0:null===(e=w.entries)||void 0===e?void 0:e.length)){let e=w.entries.reduce((e,t)=>{let n="".concat(g,"/").concat(t.basename);return{...e,[n]:{file:t,name:C(n),fullPath:n,treeExpanded:!1}}},{});c(e),x.current=!0}},[w]);let T=k(S,100),E=!!(null==o?void 0:null===(n=o.children)||void 0===n?void 0:n.length);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(D,{level:a,onClick:e=>{null==m||m(o)},isActive:p===o.fullPath,children:[(0,r.jsx)("div",{className:"flex h-8 shrink-0 items-center hover:bg-primary/10 hover:text-popover-foreground",onClick:e=>{T||(h(o.fullPath),e.stopPropagation())},children:T&&!x.current?(0,r.jsx)(N.IconSpinner,{}):j?(0,r.jsx)(N.IconChevronDown,{}):(0,r.jsx)(N.IconChevronRight,{})}),(0,r.jsx)("div",{className:"shrink-0",style:{color:"rgb(84, 174, 255)"},children:j?(0,r.jsx)(N.IconDirectoryExpandSolid,{}):(0,r.jsx)(N.IconDirectorySolid,{})}),(0,r.jsx)("div",{className:"truncate",children:null==o?void 0:o.name})]}),(0,r.jsx)(r.Fragment,{children:j&&E?(0,r.jsx)(r.Fragment,{children:null===(l=o.children)||void 0===l?void 0:l.map(e=>{let t=e.file.basename;return"dir"===e.file.kind?(0,r.jsx)(F,{node:e,level:a+1},t):(0,r.jsx)(q,{node:e,level:a+1},t)})}):null})]})},B=()=>{let{fileTreeData:e,initialized:t}=i.useContext(A);return t?(null==e?void 0:e.length)?(0,r.jsx)(r.Fragment,{children:null==e?void 0:e.map(e=>(0,r.jsx)(F,{root:!0,level:0,node:e},e.fullPath))}):(0,r.jsx)("div",{className:"flex h-full items-center justify-center",children:"No Data"}):(0,r.jsx)(L,{})},_=e=>{let{className:t,...n}=e;return(0,r.jsx)("div",{className:(0,v.cn)("group/filetree",t),children:(0,r.jsx)($,{...n,children:(0,r.jsx)(B,{})})})};function L(){return(0,r.jsxs)("div",{className:"space-y-3 p-2",children:[(0,r.jsx)(w.O,{}),(0,r.jsx)(w.O,{className:"ml-4"}),(0,r.jsx)(w.O,{className:"ml-4"}),(0,r.jsx)(w.O,{}),(0,r.jsx)(w.O,{className:"ml-4"})]})}let Q=o()(()=>Promise.all([n.e(8301),n.e(6401),n.e(5344),n.e(3830)]).then(n.bind(n,53830)),{loadableGenerated:{webpack:()=>[53830]},ssr:!1}),H=i.createContext({}),U=e=>{let{children:t}=e,{searchParams:n,updateSearchParams:l}=function(){let e=(0,c.usePathname)(),t=(0,c.useRouter)(),n=(0,c.useSearchParams)();return{pathname:e,router:t,searchParams:n,updateSearchParams:r=>{let{set:i,del:l,replace:o,getNewPath:a}=r,s=new URLSearchParams(n);i&&Object.entries(i).forEach(e=>{let[t,n]=e;return s.set(t,n)}),l&&(Array.isArray(l)?l.forEach(e=>s.delete(e)):s.delete(l));let u=s.toString(),d="".concat(e).concat(u.length>0?"?".concat(u):"");if(a)return d;o?t.replace(d):t.push(d)},getQueryString:e=>{let t=new URLSearchParams(n);e&&Object.entries(e).forEach(e=>{let[n,r]=e;return t.set(n,r)});let r=t.toString();return r.length>0?"?".concat(r):""}}}(),o=i.useMemo(()=>{var e,t;return null!==(t=null===(e=n.get("path"))||void 0===e?void 0:e.toString())&&void 0!==t?t:""},[n]),[s,u]=i.useState(!1),[d,f]=i.useState({}),[v,h]=(0,i.useState)({}),[m,p]=(0,i.useState)({}),[x,g]=i.useState(new Set),b=i.useMemo(()=>{if(!o)return[];let e=[],t=o.split("/");for(let n=0;n<t.length;n++){let r=t.slice(0,n+1).join("/");e.push(null==d?void 0:d[r])}return(0,a.Z)(e)},[o,d]),j=i.useMemo(()=>(function e(t){if(!t.length)return[];for(let n of(t.sort((e,t)=>{let n="file"===e.file.kind?1:0,r="file"===t.file.kind?1:0;return n-r||e.name.localeCompare(t.name)}),t))(null==n?void 0:n.children)&&e(n.children);return t})(function(e){let t=[];if(!e)return t;let n=Object.keys(e);for(let r of n){let n=e[r],i=r.split("/"),l=t;for(let e=0;e<i.length;e++){let t=i[e],o=null==l?void 0:l.find(e=>e.name===t);if(o)l=o.children||[];else{let e={file:n.file,name:t,fullPath:r,children:[]};l.push(e),l=e.children}}}return t}(d)),[d]);return(0,r.jsx)(H.Provider,{value:{initialized:s,setInitialized:u,codeMap:v,setCodeMap:h,fileMetaMap:m,setFileMetaMap:p,activePath:o,setActivePath:e=>{e?l({set:{path:e}}):l({del:"path"})},fileMap:d,updateFileMap:e=>{e&&f({...d,...e})},expandedKeys:x,setExpandedKeys:g,toggleExpandedKey:e=>{let t=x.has(e),n=new Set(x);t?n.delete(e):n.add(e),g(n)},currentFileRoutes:b,fileTreeData:j},children:t})},G=e=>{var t;let{className:n}=e,{activePath:l,setActivePath:o,codeMap:a,setCodeMap:s,updateFileMap:c,fileMetaMap:h,setFileMetaMap:g,fileMap:j,initialized:y,setInitialized:k,expandedKeys:N,toggleExpandedKey:w,setExpandedKeys:S,fileTreeData:T}=i.useContext(H),O=i.useMemo(()=>P(l),[l]),A=i.useMemo(()=>E(l),[l]),$=i.useMemo(()=>{var e,t;let n=l&&(null==j?void 0:null===(t=j[l])||void 0===t?void 0:null===(e=t.file)||void 0===e?void 0:e.kind)==="file";return n&&!(0,u.Z)(a,l)},[l,j,a]),Z=i.useMemo(()=>{var e,t;let n=l&&(null==j?void 0:null===(t=j[l])||void 0===t?void 0:null===(e=t.file)||void 0===e?void 0:e.kind)==="file";return n&&!(0,u.Z)(h,l)},[l,j,a]),M=i.useMemo(()=>{var e,t,n;if(!y)return!1;let r=l&&(null==j?void 0:null===(t=j[l])||void 0===t?void 0:null===(e=t.file)||void 0===e?void 0:e.kind)==="dir";return r&&!(null==j?void 0:null===(n=j[l])||void 0===n?void 0:n.treeExpanded)},[l,j,y]),{data:z}=(0,d.Z)($?"/repositories/".concat(O,"/resolve/").concat(A):null,e=>(0,f.Z)(e,{format:"text"})),{data:D}=(0,d.Z)(Z?"/repositories/".concat(O,"/meta/").concat(A):null,f.Z),{data:q,isLoading:F}=(0,d.Z)(M?"/repositories/".concat(O,"/resolve/").concat(A):null,f.Z);i.useEffect(()=>{let e=async()=>{let{patchMap:e,expandedKeys:t}=await X(l);e&&c(e),(null==t?void 0:t.length)&&S(new Set(t)),k(!0)};e()},[]),i.useEffect(()=>{z&&l&&s(e=>({...e,[l]:z}))},[z]),i.useEffect(()=>{D&&l&&g(e=>({...e,[l]:D}))},[D]),i.useEffect(()=>{(()=>{var e;if((null==q?void 0:null===(e=q.entries)||void 0===e?void 0:e.length)&&l){let e=P(l),t={};for(let n of q.entries){let r="".concat(e,"/").concat(n.basename);t[r]={file:n,name:C(r),fullPath:r,treeExpanded:!1}}c(t);let n=I(l,!0);(null==n?void 0:n.length)&&S(e=>{let t=new Set(e);for(let e of n)t.add(e);return t})}})()},[q]);let B=l?null==j?void 0:null===(t=j[l])||void 0===t?void 0:t.file:void 0,L=(null==B?void 0:B.kind)==="file",U=(null==B?void 0:B.kind)==="dir"||""===l;return(0,r.jsxs)(m,{direction:"horizontal",className:(0,v.cn)(n),children:[(0,r.jsx)(p,{defaultSize:20,minSize:20,children:(0,r.jsx)("div",{className:"h-full overflow-hidden py-2",children:(0,r.jsx)(_,{className:"h-full overflow-y-auto overflow-x-hidden px-4",onSelectTreeNode:e=>{o(e.fullPath)},activePath:l,fileMap:j,updateFileMap:c,expandedKeys:N,toggleExpandedKey:w,initialized:y,fileTreeData:T})})}),(0,r.jsx)(x,{className:"w-1 hover:bg-card active:bg-card"}),(0,r.jsx)(p,{defaultSize:80,minSize:30,children:(0,r.jsxs)("div",{className:"flex h-full flex-col overflow-y-auto px-4 pb-4",children:[(0,r.jsx)(b,{className:"sticky top-0 z-10 bg-background py-4"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)(R,{loading:F,initialized:y,className:"rounded-lg border ".concat(U?"block":"hidden")}),(0,r.jsx)(Q,{className:"rounded-lg border py-2 ".concat(L?"block":"hidden")})]})]})})]})},W=e=>(0,r.jsx)(U,{children:(0,r.jsx)(G,{className:"source-code-browser",...e})});async function X(e){let t=P(e),n=E(e);try{let e=await r(),{defaultEntries:n,expandedDir:i}=await l(e),o={};for(let n of e)o[n.basename]={file:n,name:n.basename,fullPath:n.basename,treeExpanded:n.basename===t};for(let e of n){let n="".concat(t,"/").concat(e.basename);o[n]={file:e,name:C(n),fullPath:n,treeExpanded:i.includes(e.basename)}}let a=i.map(e=>[t,e].filter(Boolean).join("/"));return{patchMap:o,expandedKeys:a}}catch(e){return console.error(e),{}}async function r(){try{let e=await (0,f.Z)("/repositories/resolve/");return null==e?void 0:e.entries}catch(e){return[]}}async function i(e){try{if(!t)return;let i=(0,s.Z)(e,e=>e.basename===t);if(i<0)return;let l=I(n),o=l.map(e=>()=>(0,f.Z)("/repositories/".concat(t,"/resolve/").concat(e))),a=await Promise.all(o.map(e=>e())),u=[];for(let e of a){var r;(null===(r=e.entries)||void 0===r?void 0:r.length)&&(u=[...u,...e.entries])}return u}catch(e){console.error(e)}}async function l(e){let r={defaultEntries:[],expandedDir:[]};try{if(t&&(null==e?void 0:e.length)){let t=await i(e),l=I(n);(null==t?void 0:t.length)&&(r.defaultEntries=t),(null==l?void 0:l.length)&&(r.expandedDir=l)}}catch(e){console.error(e)}return r}}},33555:function(e,t,n){"use strict";n.d(t,{q:function(){return a}});var r=n(57437);n(2265);var i=n(77723),l=n(93023),o=n(84168);function a(e){let{className:t,value:n,...a}=e,{isCopied:s,copyToClipboard:u}=(0,i.m)({timeout:2e3});return n?(0,r.jsxs)(l.z,{variant:"ghost",size:"icon",className:t,onClick:()=>{s||u(n)},...a,children:[s?(0,r.jsx)(o.IconCheck,{className:"text-green-600"}):(0,r.jsx)(o.IconCopy,{}),(0,r.jsx)("span",{className:"sr-only",children:"Copy"})]}):null}},93023:function(e,t,n){"use strict";n.d(t,{d:function(){return s},z:function(){return u}});var r=n(57437),i=n(2265),l=n(67256),o=n(7404),a=n(39311);let s=(0,o.j)("inline-flex items-center justify-center rounded-md text-sm font-medium shadow ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-md hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90","hover-destructive":"shadow-none hover:bg-destructive/90 hover:text-destructive-foreground",outline:"border border-input hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"shadow-none hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 shadow-none hover:underline"},size:{default:"h-8 px-4 py-2",sm:"h-8 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-8 w-8 p-0"}},defaultVariants:{variant:"default",size:"default"}}),u=i.forwardRef((e,t)=>{let{className:n,variant:i,size:o,asChild:u=!1,...d}=e,c=u?l.g7:"button";return(0,r.jsx)(c,{className:(0,a.cn)(s({variant:i,size:o,className:n})),ref:t,...d})});u.displayName="Button"},25645:function(e,t,n){"use strict";n.d(t,{O:function(){return l}});var r=n(57437),i=n(39311);function l(e){let{className:t,...n}=e;return(0,r.jsx)("div",{className:(0,i.cn)("h-4 animate-pulse rounded-md bg-gray-200 dark:bg-gray-700",t),...n})}},32553:function(e,t,n){"use strict";n.d(t,{RM:function(){return s},SC:function(){return d},iA:function(){return o},pj:function(){return f},ss:function(){return c},xD:function(){return a}});var r=n(57437),i=n(2265),l=n(39311);let o=i.forwardRef((e,t)=>{let{className:n,...i}=e;return(0,r.jsx)("table",{ref:t,className:(0,l.cn)("w-full caption-bottom text-sm",n),...i})});o.displayName="Table";let a=i.forwardRef((e,t)=>{let{className:n,...i}=e;return(0,r.jsx)("thead",{ref:t,className:(0,l.cn)("[&_tr]:border-b",n),...i})});a.displayName="TableHeader";let s=i.forwardRef((e,t)=>{let{className:n,...i}=e;return(0,r.jsx)("tbody",{ref:t,className:(0,l.cn)("[&_tr:last-child]:border-0",n),...i})});s.displayName="TableBody";let u=i.forwardRef((e,t)=>{let{className:n,...i}=e;return(0,r.jsx)("tfoot",{ref:t,className:(0,l.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",n),...i})});u.displayName="TableFooter";let d=i.forwardRef((e,t)=>{let{className:n,...i}=e;return(0,r.jsx)("tr",{ref:t,className:(0,l.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",n),...i})});d.displayName="TableRow";let c=i.forwardRef((e,t)=>{let{className:n,...i}=e;return(0,r.jsx)("th",{ref:t,className:(0,l.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",n),...i})});c.displayName="TableHead";let f=i.forwardRef((e,t)=>{let{className:n,...i}=e;return(0,r.jsx)("td",{ref:t,className:(0,l.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",n),...i})});f.displayName="TableCell";let v=i.forwardRef((e,t)=>{let{className:n,...i}=e;return(0,r.jsx)("caption",{ref:t,className:(0,l.cn)("mt-4 text-sm text-muted-foreground",n),...i})});v.displayName="TableCaption"},77723:function(e,t,n){"use strict";n.d(t,{m:function(){return a}});var r=n(2265),i=n(2390),l=n.n(i),o=n(71424);function a(e){let{timeout:t=2e3,onError:n}=e,[i,a]=r.useState(!1),s=()=>{a(!0),setTimeout(()=>{a(!1)},t)},u=e=>{if("function"==typeof n){null==n||n(e);return}o.A.error("Failed to copy.")};return{isCopied:i,copyToClipboard:e=>{var t;if(e){if(null===(t=navigator.clipboard)||void 0===t?void 0:t.writeText)navigator.clipboard.writeText(e).then(s).catch(u);else{let t=l()(e);t?s():u()}}}}}},58001:function(e,t,n){"use strict";n.d(t,{Dp:function(){return j},Ho:function(){return y},QJ:function(){return S},Rn:function(){return x},av:function(){return C},bW:function(){return m},kP:function(){return T},pC:function(){return p},zq:function(){return w}});var r,i,l=n(57437),o=n(2265),a=n(24033),s=n(53771),u=n(99109),d=n(26566),c=n.n(d),f=n(58835),v=n(39311);(r=i||(i={}))[r.SignIn=0]="SignIn",r[r.SignOut=1]="SignOut",r[r.Refresh=2]="Refresh";let h="_tabby_auth",m=()=>{if((0,v.S_)()){let e=localStorage.getItem(h);if(e)try{return JSON.parse(e)}catch(e){}}},p=e=>{localStorage.setItem(h,JSON.stringify(e))},x=()=>{localStorage.removeItem(h),window.dispatchEvent(new StorageEvent("storage",{storageArea:window.localStorage,url:window.location.href,key:h}))};function g(e,t){var n,r;let l=function(e,t){switch(t.type){case i.SignIn:case i.Refresh:return{status:"authenticated",data:t.data};case i.SignOut:return{status:"unauthenticated",data:void 0}}}(0,t);return e.status==l.status&&(n=e.data,r=l.data,(null==n?void 0:n.accessToken)===(null==r?void 0:r.accessToken)&&(null==n?void 0:n.refreshToken)===(null==r?void 0:r.refreshToken))?e:l}let b=o.createContext({}),j=(0,f.BX)("\n  mutation refreshToken($refreshToken: String!) {\n    refreshToken(refreshToken: $refreshToken) {\n      accessToken\n      refreshToken\n    }\n  }\n"),y=e=>{let{children:t}=e,n=o.useRef(!1),[r]=c()(h,void 0),[a,u]=o.useReducer(g,{status:"loading",data:void 0});o.useEffect(()=>{n.current=!0,(null==r?void 0:r.accessToken)&&(null==r?void 0:r.refreshToken)?u({type:i.SignIn,data:r}):u({type:i.SignOut})},[]),o.useEffect(()=>{n.current&&((null==r?void 0:r.accessToken)&&(null==r?void 0:r.refreshToken)?u({type:i.SignIn,data:r}):u({type:i.SignOut}))},[r]);let d=o.useMemo(()=>{var e,t;if((null==a?void 0:a.status)=="authenticated")try{let{sub:e,is_admin:t}=(0,s.o)(a.data.accessToken);return{data:{email:e,isAdmin:t,accessToken:a.data.accessToken},status:a.status}}catch(t){return console.error("jwt decode failed"),{status:null!==(e=null==a?void 0:a.status)&&void 0!==e?e:"loading",data:{email:"",isAdmin:!1,accessToken:a.data.accessToken}}}return{status:null!==(t=null==a?void 0:a.status)&&void 0!==t?t:"loading",data:null}},[a]);return(0,l.jsx)(b.Provider,{value:{authState:a,dispatch:u,session:d},children:t})};class k extends Error{constructor(){super("AuthProvider is missing. Please add the AuthProvider at root level")}}function N(){let e=o.useContext(b);if(!e)throw new k;return e}function w(){let{dispatch:e}=N(),[t,n]=c()(h,void 0);return async t=>(n({accessToken:t.accessToken,refreshToken:t.refreshToken}),e({type:i.SignIn,data:t}),!0)}function S(){let{dispatch:e}=N(),[t,n]=c()(h,void 0);return async()=>{n(void 0),e({type:i.SignOut})}}function T(){let{session:e}=N();return e}let P=(0,f.BX)("\n  query GetIsAdminInitialized {\n    isAdminInitialized\n  }\n"),E=["/auth/signin","/auth/signup"];function C(){let[{data:e}]=(0,u.aM)({query:P}),t=(0,a.useRouter)(),n=(0,a.usePathname)(),{data:r,status:i}=T();return o.useEffect(()=>{"loading"!==i&&("authenticated"===i||((null==e?void 0:e.isAdminInitialized)===!1?t.replace("/auth/signup?isAdmin=true"):E.includes(n)||t.replace("/auth/signin")))},[e,i]),r}},1592:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(34084),i=n(58001),l=n(7820);let o=!1,a=[];async function s(e,t){let n=await fetch(e,u(t));if(401!==n.status)return(null==t?void 0:t.format)==="text"?n.text():n.json();{var r,l;if(o)return new Promise(n=>{a.push({url:e,init:t,resolve:n})});let n=null===(r=(0,i.bW)())||void 0===r?void 0:r.refreshToken;if(!n){(0,i.Rn)();return}o=!0;let s=await d(n),u=null==s?void 0:null===(l=s.data)||void 0===l?void 0:l.refreshToken;if(u){for((0,i.pC)({accessToken:u.accessToken,refreshToken:u.refreshToken}),o=!1;a.length;){let e=a.shift();null==e||e.resolve(c(e.url,e.init))}return c(e,t)}o=!1,a.length=0,(0,i.Rn)()}}function u(e){var t;let n=new Headers(null==e?void 0:e.headers);return n.append("authorization","Bearer ".concat(null===(t=(0,i.bW)())||void 0===t?void 0:t.accessToken)),{...e||{},headers:n}}async function d(e){let t=l.Lp.createRequestOperation("mutation",(0,r.h)(i.Dp,{refreshToken:e}));return l.Lp.executeMutation(t)}function c(e,t){return fetch(e,u(t)).then(e=>(null==t?void 0:t.format)==="text"?e.text():e.json())}},7820:function(e,t,n){"use strict";n.d(t,{Db:function(){return v},Lp:function(){return p},io:function(){return h}});var r=n(2265),i=n(69166),l=n(73997),o=n(83074),a=n(53771),s=n(24144),u=n(99109),d=n(18398),c=n(58001),f=n(57166);function v(e,t){var n;let[r,i]=(0,u.Db)(e),l=(null==t?void 0:t.form)?(n=t.form,e=>{let{graphQLErrors:t=[]}=e;for(let e of t)if(e.extensions&&e.extensions["validation-errors"]){let t=e.extensions["validation-errors"];for(let e of t.errors)n.setError(e.path,e)}else(null==e?void 0:e.originalError)&&n.setError("root",e.originalError)}):void 0,o=async e=>{let n;try{if(null==(n=await i(e))?void 0:n.error)l&&l(n.error),(null==t?void 0:t.onError)&&t.onError(n.error);else if(!(0,s.Z)(null==n?void 0:n.data)){var r;null==t||null===(r=t.onCompleted)||void 0===r||r.call(t,n.data)}}catch(e){(null==t?void 0:t.onError)&&t.onError(e);return}return n};return o}function h(e){let{data:t,error:n,stale:i}=e,l=(e,t)=>!(0,s.Z)(e)||!(0,s.Z)(t),[o,a]=(0,r.useState)(l(t,n)&&!!i);return(0,r.useEffect)(()=>{!o&&l(t,n)&&a(!0)},[t,n]),[o,a]}let m=e=>Date.now()>1e3*e,p=new d.KU({url:"/graphql",requestPolicy:"cache-and-network",exchanges:[(0,l.HG)({resolvers:{Query:{invitations:(0,o.N)(),repositories:(0,o.N)(),jobRuns:(0,o.N)()}},updates:{Mutation:{deleteInvitation(e,t,n,r){e.deleteInvitation&&n.inspectFields("Query").filter(e=>"invitations"===e.fieldName).forEach(e=>{n.updateQuery({query:f.lE,variables:e.arguments},e=>{var n;return(null==e?void 0:null===(n=e.invitations)||void 0===n?void 0:n.edges)&&(e.invitations.edges=e.invitations.edges.filter(e=>e.node.id!==t.id)),e})})},deleteRepository(e,t,n,r){e.deleteRepository&&n.inspectFields("Query").filter(e=>"repositories"===e.fieldName).forEach(e=>{n.updateQuery({query:f.S1,variables:e.arguments},e=>{var n;return(null==e?void 0:null===(n=e.repositories)||void 0===n?void 0:n.edges)&&(e.repositories.edges=e.repositories.edges.filter(e=>e.node.id!==t.id)),e})})}}}}),(0,i.M)(async e=>{let t=(0,c.bW)(),n=null==t?void 0:t.accessToken,r=null==t?void 0:t.refreshToken;return{addAuthToOperation:t=>n?e.appendHeaders(t,{Authorization:"Bearer ".concat(n)}):t,didAuthError(e,t){var n;return(null==e?void 0:null===(n=e.response)||void 0===n?void 0:n.status)===401||e.graphQLErrors.some(e=>{var t;return(null==e?void 0:null===(t=e.extensions)||void 0===t?void 0:t.code)==="UNAUTHORIZED"})},willAuthError(e){let t=(0,c.bW)();if(n=null==t?void 0:t.accessToken,r=null==t?void 0:t.refreshToken,"mutation"===e.kind&&e.query.definitions.some(e=>{var t;return"OperationDefinition"===e.kind&&(null===(t=e.name)||void 0===t?void 0:t.value)&&["tokenAuth","registerUser"].includes(e.name.value)})||r&&"mutation"===e.kind&&e.query.definitions.some(e=>{var t;return"OperationDefinition"===e.kind&&(null==e?void 0:null===(t=e.name)||void 0===t?void 0:t.value)==="refreshToken"}))return!1;if(!n)return!0;try{let{exp:e}=(0,a.o)(n);return!e||m(e)}catch(e){return!0}},async refreshAuth(){if(r){var t;let i=await e.mutate(c.Dp,{refreshToken:r});(null===(t=i.data)||void 0===t?void 0:t.refreshToken)?(n=i.data.refreshToken.accessToken,r=i.data.refreshToken.refreshToken,(0,c.pC)({accessToken:n,refreshToken:r})):(0,c.Rn)()}else(0,c.Rn)()}}}),d.Ek]})},57166:function(e,t,n){"use strict";n.d(t,{GG:function(){return o},S1:function(){return l},lE:function(){return i}});var r=n(58835);let i=(0,r.BX)("\n  query ListInvitations(\n    $after: String\n    $before: String\n    $first: Int\n    $last: Int\n  ) {\n    invitations(after: $after, before: $before, first: $first, last: $last) {\n      edges {\n        node {\n          id\n          email\n          code\n          createdAt\n        }\n        cursor\n      }\n      pageInfo {\n        hasNextPage\n        hasPreviousPage\n        startCursor\n        endCursor\n      }\n    }\n  }\n"),l=(0,r.BX)("\n  query repositories($after: String, $before: String, $first: Int, $last: Int) {\n    repositories(after: $after, before: $before, first: $first, last: $last) {\n      edges {\n        node {\n          id\n          name\n          gitUrl\n        }\n        cursor\n      }\n      pageInfo {\n        hasNextPage\n        hasPreviousPage\n        startCursor\n        endCursor\n      }\n    }\n  }\n"),o=(0,r.BX)("\n  query ListJobRuns(\n    $ids: [ID!]\n    $after: String\n    $before: String\n    $first: Int\n    $last: Int\n  ) {\n    jobRuns(\n      ids: $ids\n      after: $after\n      before: $before\n      first: $first\n      last: $last\n    ) {\n      edges {\n        node {\n          id\n          job\n          createdAt\n          finishedAt\n          exitCode\n          stdout\n          stderr\n        }\n        cursor\n      }\n      pageInfo {\n        hasNextPage\n        hasPreviousPage\n        startCursor\n        endCursor\n      }\n    }\n  }\n")}},function(e){e.O(0,[1091,584,1424,5489,6630,713,6887,4402,4168,2971,7864,1744],function(){return e(e.s=51848)}),_N_E=e.O()}]);