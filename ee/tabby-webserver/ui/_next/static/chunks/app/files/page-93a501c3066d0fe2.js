(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[357,3396],{4755:function(e,t,n){Promise.resolve().then(n.bind(n,89332))},89332:function(e,t,n){"use strict";n.r(t),n.d(t,{SourceCodeBrowser:function(){return eI},SourceCodeBrowserContext:function(){return e_}});var r=n(36164),l=n(3546),i=n(57778),s=n(1853),a=n(94909),o=n(59348),c=n(2578),d=n(36327),u=n(43240),f=n(44645),v=n(80605),h=n(63484),x=n(3765),m=n(11634),p=n(74248),g=n(6618);let j=e=>{let{className:t,...n}=e;return(0,r.jsx)(g.eh,{className:(0,p.cn)("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",t),...n})},b=g.s_,y=e=>{let{withHandle:t,className:n,...l}=e;return(0,r.jsx)(g.OT,{className:(0,p.cn)("border-bg relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",n),...l,children:t&&(0,r.jsx)("div",{className:"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border"})})};var w=n(30601),k=n(90379),N=n(38736),S=n(27064),C=n(826),E=n(18452),P=n(16784),_=n(98454),R=n(25647),T=n(17451),I=n(31458),O=n(81565),A=n(48048);let D=e=>{let{className:t,...n}=e,{setProgress:i}=(0,N.U)(),{updateSearchParams:s}=(0,f.Z)(),[{data:a}]=(0,_.P)(),{pendingEvent:o,setPendingEvent:c,repoMap:d,setExpandedKeys:u,updateFileMap:v}=l.useContext(e_),h=(0,R.o)(T.a,e=>e.activeChatId),x=l.useRef(null),m=(0,P.d)(d),g=async e=>{if((null==e?void 0:e.filepath)&&(null==e?void 0:e.git_url)){let n=m.current,r=(0,C.Z)(Object.keys(n),t=>{var r;return(null==n?void 0:null===(r=n[t])||void 0===r?void 0:r.gitUrl)===e.git_url});if(r){let l=n[r],a=(0,A.Pj)(l),o="".concat(a,"/").concat(e.filepath);if(!o)return;try{i(!0);let t=await (0,A.lf)(o,a?null==n?void 0:n[a]:void 0),r=(0,A.yH)(e.filepath),l={};for(let e of t){let t="".concat(a,"/").concat(e.basename);l[t]={file:e,name:(0,A.i3)(t),fullPath:t,treeExpanded:r.includes(e.basename)}}let s=r.map(e=>[a,e].filter(Boolean).join("/"));l&&v(l),(null==s?void 0:s.length)&&u(e=>{let t=new Set(e);for(let e of s)t.add(e);return t})}catch(e){}finally{var t;s({set:{path:"".concat(null!=a?a:"","/").concat(e.filepath),line:String(null!==(t=e.range.start)&&void 0!==t?t:"")},del:"plain"}),i(!1)}}}},j=(0,E.m)(x,{navigate:g}),b=e=>{let{action:t}=e,n="";switch(t){case"explain":n="Explain the selected code:";break;case"generate_unittest":n="Generate a unit test for the selected code:";break;case"generate_doc":n="Generate documentation for the selected code:"}return n};return(l.useEffect(()=>{(null==x?void 0:x.current)&&a&&(null==j||j.init({fetcherOptions:{authorization:a.me.authToken}}))},[null==x?void 0:x.current,j,a]),l.useEffect(()=>{if(o&&j){let{lineFrom:e,lineTo:t,code:n,path:r,gitUrl:l}=o;j.sendMessage({message:b(o),selectContext:{kind:"file",content:n,range:{start:e,end:null!=t?t:e},filepath:r,git_url:l}})}c(void 0)},[o,j]),null==a?void 0:a.me)?(0,r.jsxs)("div",{className:(0,p.cn)("flex h-full flex-col",t),...n,children:[(0,r.jsx)(z,{}),(0,r.jsx)("iframe",{src:"/chat",className:"w-full flex-1 border-0",ref:x},h)]}):(0,r.jsx)(r.Fragment,{})};function z(){let{setChatSideBarVisible:e}=l.useContext(e_);return(0,r.jsx)("div",{className:"sticky top-0 flex items-center justify-end px-2 py-1",children:(0,r.jsx)(I.z,{size:"icon",variant:"ghost",onClick:t=>e(!1),children:(0,r.jsx)(O.IconClose,{})})})}var L=n(48537);let F=e=>{let{className:t}=e,{currentFileRoutes:n,setActivePath:i,activePath:s}=l.useContext(e_),a=l.useMemo(()=>{var e;return null===(e=(0,A.Jt)(s))||void 0===e?void 0:e.basename},[s]);return(0,r.jsxs)("div",{className:(0,p.cn)("flex flex-nowrap items-center gap-1",t),children:[(0,r.jsxs)("div",{className:"flex items-center gap-1 overflow-x-auto leading-8",children:[(0,r.jsx)("div",{className:"cursor-pointer font-medium text-primary hover:underline",onClick:e=>i(void 0),children:"Repositories"}),(0,r.jsx)("div",{children:"/"}),null==n?void 0:n.map((e,t)=>{let s=0===t&&(null==n?void 0:n.length)>1,a=t===n.length-1;return(0,r.jsxs)(l.Fragment,{children:[(0,r.jsx)("div",{className:(0,p.cn)("whitespace-nowrap",s||a?"font-bold":"font-medium",a?"":"cursor-pointer text-primary hover:underline",s?"hover:underline":void 0),onClick:t=>i(e.fullPath),children:e.name}),"file"!==e.file.kind&&(0,r.jsx)("div",{children:"/"})]},e.fullPath)})]}),!!(null==n?void 0:n.length)&&!!a&&(0,r.jsx)(L.q,{className:"shrink-0",value:a})]})};var Z=n(6495),G=n(24449),H=n(3448),M=n(99047),U=n(42891),J=n.n(U),B=n(23342),q=n(91655),W=n(93877),V=n(28312);let Q=e=>{let[t,n]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{let t=e.current,r=new IntersectionObserver(e=>{let[t]=e;n(t.intersectionRatio<1)},{threshold:[1]});return t&&r.observe(t),()=>{t&&r.unobserve(t)}},[e.current]),t};var K=n(11208),$=n(29);let X=e=>{let{blob:t,className:n,canCopy:i,hideBlobActions:s,contentLength:a,children:o,...d}=e,{chatSideBarVisible:u,setChatSideBarVisible:f,isChatEnabled:v}=l.useContext(e_),[h]=(0,W.D)(),x=l.useRef(null),{activePath:m}=l.useContext(e_),{isCopied:g,copyToClipboard:j}=(0,V.m)({timeout:2e3}),b=Q(x),y=v&&h.value&&!u,w=a?(0,q.Z)(a):"",k=async()=>{if(!g&&t)try{let e=await t.text();j(e)}catch(e){c.A.error("Something went wrong. Please try again.")}};return(0,r.jsxs)("div",{className:(0,p.cn)("sticky -top-1 z-10 border",!b&&"rounded-t-lg",n),ref:x,...d,children:[b&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"bg-secondary pl-4",children:(0,r.jsx)(F,{className:"py-2"})}),b&&(0,r.jsx)(K.Z,{})]}),!s&&(0,r.jsxs)("div",{className:(0,p.cn)("flex items-center justify-between bg-secondary p-2 text-secondary-foreground",!b&&"rounded-t-lg"),children:[(0,r.jsxs)("div",{className:"flex h-8 items-center gap-4 leading-8",children:[o,(0,r.jsx)("span",{className:"ml-2 text-sm text-muted-foreground",children:w})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[i&&(0,r.jsxs)($.u,{children:[(0,r.jsx)($.aJ,{asChild:!0,children:(0,r.jsxs)(I.z,{variant:"ghost",size:"icon",onClick:k,children:[g?(0,r.jsx)(O.IconCheck,{className:"text-green-600"}):(0,r.jsx)(O.IconCopy,{}),(0,r.jsx)("span",{className:"sr-only",children:"Copy"})]})}),(0,r.jsx)($._v,{children:"Copy raw file"})]}),!!t&&(0,r.jsxs)($.u,{children:[(0,r.jsx)($.aJ,{asChild:!0,children:(0,r.jsx)("a",{className:(0,I.d)({variant:"ghost",size:"icon"}),download:(0,A.i3)(null!=m?m:""),href:URL.createObjectURL(t),children:(0,r.jsx)(O.IconDownload,{})})}),(0,r.jsx)($._v,{children:"Download raw file"})]}),y&&(0,r.jsxs)($.u,{children:[(0,r.jsx)($.aJ,{asChild:!0,children:(0,r.jsxs)(I.z,{variant:"ghost",className:"flex shrink-0 items-center gap-1 px-2",onClick:e=>f(!u),children:[(0,r.jsx)(J(),{alt:"Tabby logo",src:B.Z,width:24}),"Ask Tabby"]})}),(0,r.jsx)($._v,{children:"Open chat panel"})]})]})]})]})};var Y=n(18500);function ee(e){let{kind:t,fallback:n}=e;switch(t){case Y.vW.Git:return(0,r.jsx)(O.IconDirectorySolid,{style:{color:"rgb(84, 174, 255)"}});case Y.vW.Github:case Y.vW.GithubSelfHosted:return(0,r.jsx)(O.IconGitHub,{});case Y.vW.Gitlab:case Y.vW.GitlabSelfHosted:return(0,r.jsx)(O.IconGitLab,{});default:return null!=n?n:null}}let et=e=>{let{className:t,loading:n,initialized:i}=e,{activePath:s,currentFileRoutes:a,setActivePath:o,fileTreeData:c}=l.useContext(e_),d=l.useMemo(()=>(function(e,t){if(!(null==e?void 0:e.length))return[];if(t){let{repositorySpecifier:n="",basename:r=""}=(0,A.Jt)(t),l=[n,...r.split("/")].filter(Boolean),i=e;for(let e=0;e<l.length;e++){let t=l.slice(0,e+1).join("/"),n=(0,C.Z)(i,e=>e.fullPath===t);if(null==n||!n.children)return[];i=null==n?void 0:n.children}return(null==i?void 0:i.map(e=>(0,Z.Z)(e,"children")))||[]}{let t=e.map(e=>(0,Z.Z)(e,"children"))||[];return t}})(c,s),[c,s]),[u]=(0,G.n)(n,300),f=(null==a?void 0:a.length)>0,v=()=>{var e;let t=null===(e=a[(null==a?void 0:a.length)-2])||void 0===e?void 0:e.fullPath;o(t)},h=e=>{o(e.fullPath)};return(0,r.jsxs)("div",{className:(0,p.cn)("text-base",t),children:[(0,r.jsx)(X,{blob:void 0,hideBlobActions:!0,className:"border-0"}),u||!i?(0,r.jsx)(en,{}):(null==c?void 0:c.length)?(0,r.jsx)(M.iA,{children:(0,r.jsxs)(M.RM,{children:[f&&(0,r.jsx)(M.SC,{className:"cursor-pointer",onClick:e=>v(),children:(0,r.jsx)(M.pj,{className:"p-1 px-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"shrink-0",children:(0,r.jsx)(O.IconDirectorySolid,{style:{color:"rgb(84, 174, 255)"}})}),(0,r.jsx)("span",{className:"px-1 py-2",children:".."})]})})}),(0,r.jsx)(r.Fragment,{children:d.map(e=>{var t;let n=e.isRepository,l=null===(t=e.repository)||void 0===t?void 0:t.kind;return(0,r.jsx)(M.SC,{children:(0,r.jsx)(M.pj,{className:"p-1 px-4 text-base",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"shrink-0",children:n?(0,r.jsx)(ee,{kind:l,fallback:(0,r.jsx)(O.IconDirectorySolid,{style:{color:"rgb(84, 174, 255)"}})}):"dir"===e.file.kind?(0,r.jsx)(O.IconDirectorySolid,{style:{color:"rgb(84, 174, 255)"}}):(0,r.jsx)(O.IconFile,{})}),(0,r.jsx)("span",{onClick:t=>h(e),className:"cursor-pointer px-1 py-2 hover:text-primary hover:underline",children:e.name})]})})},e.fullPath)})})]})}):(0,r.jsx)("div",{className:"flex justify-center py-8",children:"No indexed repository yet"})]})};function en(){return(0,r.jsxs)("ul",{className:"space-y-3 p-2",children:[(0,r.jsx)(H.O,{}),(0,r.jsx)(H.O,{}),(0,r.jsx)(H.O,{}),(0,r.jsx)(H.O,{})]})}var er=n(76297);let el=l.createContext({}),ei=e=>{let{onSelectTreeNode:t,children:n,activePath:l,fileMap:i,updateFileMap:s,expandedKeys:a,toggleExpandedKey:o,initialized:c,fileTreeData:d}=e;return(0,r.jsx)(el.Provider,{value:{onSelectTreeNode:t,fileTreeData:d,expandedKeys:a,toggleExpandedKey:o,activePath:l,fileMap:i,updateFileMap:s,initialized:c},children:n})},es=e=>{let{level:t}=e,n=l.useMemo(()=>Array(t).fill(1),[t]);return(0,r.jsx)("div",{className:"flex h-full shrink-0 items-stretch",children:n.map((e,t)=>(0,r.jsx)("div",{className:"flex h-8 w-2 border-r border-transparent transition-colors duration-300 group-hover/filetree:border-border"},t))})},ea=()=>{let{ref:e,entry:t,inView:n}=(0,er.YD)({trackVisibility:!0,delay:500});return l.useEffect(()=>{if((null==t?void 0:t.target)&&!n){var e;null==t||null===(e=t.target)||void 0===e||e.scrollIntoView({block:"center"})}},[null==t?void 0:t.target]),(0,r.jsx)("div",{ref:e,className:"absolute -left-2 h-8 w-1 rounded-md bg-primary"})},eo=e=>{let{isActive:t,level:n,children:l,className:i,...s}=e;return(0,r.jsxs)("div",{className:(0,p.cn)("relative flex h-8 cursor-pointer items-stretch rounded-sm hover:bg-accent focus:bg-accent focus:text-accent-foreground",t&&"bg-accent",i),...s,children:[t&&(0,r.jsx)(ea,{}),(0,r.jsx)(es,{level:n}),(0,r.jsxs)("div",{className:"flex flex-nowrap items-center gap-2 truncate whitespace-nowrap",children:[(0,r.jsx)("div",{className:"h-4 w-4 shrink-0"}),l]})]})},ec=e=>{let{children:t,level:n,isActive:l,className:i,...s}=e;return(0,r.jsxs)("div",{className:(0,p.cn)("relative flex cursor-pointer items-stretch rounded-sm hover:bg-accent focus:bg-accent focus:text-accent-foreground",l?"bg-accent text-accent-foreground":void 0,i),...s,children:[l&&(0,r.jsx)(ea,{}),(0,r.jsx)(es,{level:n}),(0,r.jsx)("div",{className:"flex flex-nowrap items-center gap-2 truncate whitespace-nowrap",children:t})]})},ed=e=>{let{node:t,level:n}=e,{onSelectTreeNode:i,activePath:s}=l.useContext(el),a="file"===t.file.kind,o=t.fullPath===s;return(0,r.jsxs)(eo,{level:n,onClick:e=>{a&&(null==i||i(t))},isActive:o,children:[(0,r.jsx)(O.IconFile,{className:"shrink-0"}),(0,r.jsx)("div",{className:"truncate",children:null==t?void 0:t.name})]})},eu=e=>{var t,n,i;let{node:s,level:a,root:o}=e,{activeRepo:c}=l.useContext(e_),{fileMap:u,updateFileMap:f,expandedKeys:v,toggleExpandedKey:h,onSelectTreeNode:m,activePath:p}=l.useContext(el),g=l.useRef(!1),j=l.useMemo(()=>{let e=null==c?void 0:c.kind,t=null==c?void 0:c.id;return e&&t?"".concat((0,A.Fz)(e),"/").concat(t):""},[c]),{repositorySpecifier:b}=(0,A.Jt)(p),y=o?"":s.file.basename,w=v.has(s.fullPath),k="dir"===s.file.kind&&!(null==u?void 0:null===(t=u[s.fullPath])||void 0===t?void 0:t.treeExpanded)&&w,{data:N,isLoading:S}=(0,d.Z)(k?(0,A.fs)("/repositories/".concat(j,"/resolve/").concat(y)):null,x.Z,{revalidateIfStale:!1});l.useEffect(()=>{var e;if(!g.current&&(null==N?void 0:null===(e=N.entries)||void 0===e?void 0:e.length)){let e=N.entries.reduce((e,t)=>{let n="".concat(b,"/").concat(t.basename);return{...e,[n]:{file:t,name:(0,A.i3)(n),fullPath:n,treeExpanded:!1}}},{});f(e),g.current=!0}},[N]);let[C]=(0,G.n)(S,100),E=!!(null==s?void 0:null===(n=s.children)||void 0===n?void 0:n.length);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(ec,{level:a,onClick:e=>{null==m||m(s)},isActive:p===s.fullPath,children:[(0,r.jsx)("div",{className:"flex h-8 shrink-0 items-center hover:bg-primary/10 hover:text-popover-foreground",onClick:e=>{C||(h(s.fullPath),e.stopPropagation())},children:C&&!g.current?(0,r.jsx)(O.IconSpinner,{}):w?(0,r.jsx)(O.IconChevronDown,{}):(0,r.jsx)(O.IconChevronRight,{})}),(0,r.jsx)("div",{className:"shrink-0",style:{color:"rgb(84, 174, 255)"},children:w?(0,r.jsx)(O.IconDirectoryExpandSolid,{}):(0,r.jsx)(O.IconDirectorySolid,{})}),(0,r.jsx)("div",{className:"truncate",children:null==s?void 0:s.name})]}),(0,r.jsx)(r.Fragment,{children:w&&E?(0,r.jsx)(r.Fragment,{children:null===(i=s.children)||void 0===i?void 0:i.map(e=>{let t=e.file.basename;return"dir"===e.file.kind?(0,r.jsx)(eu,{node:e,level:a+1},t):(0,r.jsx)(ed,{node:e,level:a+1},t)})}):null})]})},ef=()=>{var e,t;let{initialized:n,activePath:i,fileMap:s,fileTreeData:o}=l.useContext(el),{repositorySpecifier:c}=(0,A.Jt)(i),d=!!c,u=d&&!(null==o?void 0:o.length),f=i&&(null==s?void 0:null===(e=s[i])||void 0===e?void 0:e.isRepository)&&!(null==s?void 0:null===(t=s[i])||void 0===t?void 0:t.treeExpanded);return n?(0,a.Z)(s)?(0,r.jsx)("div",{className:"flex h-full items-center justify-center",children:"No Indexed repository"}):d?u?f?(0,r.jsx)(eh,{}):(0,r.jsx)("div",{className:"flex h-full items-center justify-center",children:"No Data"}):(0,r.jsx)(r.Fragment,{children:null==o?void 0:o.map(e=>{var t;let n=(null==e?void 0:null===(t=e.file)||void 0===t?void 0:t.kind)==="file";return n?(0,r.jsx)(ed,{level:0,node:e},e.fullPath):(0,r.jsx)(eu,{level:0,node:e},e.fullPath)})}):null:(0,r.jsx)(eh,{})},ev=e=>{let{className:t,...n}=e;return(0,r.jsx)("div",{className:(0,p.cn)("group/filetree",t),children:(0,r.jsx)(ei,{...n,children:(0,r.jsx)(ef,{})})})};function eh(){return(0,r.jsxs)("div",{className:"space-y-3 p-2",children:[(0,r.jsx)(H.O,{}),(0,r.jsx)(H.O,{className:"ml-4"}),(0,r.jsx)(H.O,{className:"ml-4"}),(0,r.jsx)(H.O,{}),(0,r.jsx)(H.O,{className:"ml-4"})]})}var ex=n(62940),em=n(40055),ep=n(54594),eg=n(95623);let ej=(0,u.BX)("\n  query RepositorySearch($kind: RepositoryKind!, $id: ID!, $pattern: String!) {\n    repositorySearch(kind: $kind, id: $id, pattern: $pattern) {\n      type\n      path\n      indices\n    }\n  }\n"),eb=e=>{let{className:t,...n}=e,{activePath:i,fileTreeData:s,setActivePath:a,initialized:o,updateFileMap:c,setExpandedKeys:d,repoMap:u,activeRepo:f}=(0,l.useContext)(e_),{setProgress:v}=(0,N.U)(),{repositoryKind:h,repositoryName:x,repositorySpecifier:m}=(0,A.Jt)(i),g=null==f?void 0:f.id,j=l.useRef(null),[b,y]=l.useState(),[w,k]=l.useState(),[S,C]=l.useState(),[E,P]=l.useState(!1),_=o&&!(null==s?void 0:s.length),[{data:R}]=(0,em.aM)({query:ej,variables:{kind:h,id:g,pattern:null!=w?w:""},pause:!g||!h||!w});l.useEffect(()=>{var e,t;let n=null!==(t=null==R?void 0:null===(e=R.repositorySearch)||void 0===e?void 0:e.map(e=>({...e,id:e.path})))&&void 0!==t?t:[];C(n),P(!!w)},[null==R?void 0:R.repositorySearch]);let T=(0,G.S)(e=>{e?k(e):(k(""),P(!1),C([]))},500),D=()=>{T.run(""),T.flush()},z=async e=>{let t=e.path;if(!t)return;let n="".concat(m,"/").concat(t);try{v(!0);let e=await (0,A.lf)(n,m?null==u?void 0:u[m]:void 0),r=(0,A.yH)(t),l={};for(let t of e){let e="".concat(m,"/").concat(t.basename);l[e]={file:t,name:(0,A.i3)(e),fullPath:e,treeExpanded:r.includes(t.basename)}}let i=r.map(e=>[m,e].filter(Boolean).join("/"));l&&c(l),(null==i?void 0:i.length)&&d(e=>{let t=new Set(e);for(let e of i)t.add(e);return t})}catch(e){}finally{a(n),v(!1)}};return l.useEffect(()=>{let e=e=>{var t,n;let r=e.target,l=null==r?void 0:null===(t=r.tagName)||void 0===t?void 0:t.toLowerCase();"input"!==l&&"textarea"!==l&&"select"!==l&&"t"===e.key&&(e.preventDefault(),null===(n=j.current)||void 0===n||n.focus())};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[]),(0,r.jsxs)("div",{className:(0,p.cn)(t),...n,children:[(0,r.jsx)("div",{className:"py-4 font-bold leading-8",children:"Files"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)(ep.Ph,{disabled:!o,onValueChange:e=>{a(e)},value:m,children:[(0,r.jsx)(ep.i4,{children:(0,r.jsx)(ep.ki,{asChild:!0,children:(0,r.jsxs)("div",{className:"flex items-center gap-2 overflow-hidden",children:[(0,r.jsx)("div",{className:"shrink-0",children:(0,r.jsx)(ee,{kind:h,fallback:(0,r.jsx)(O.IconFolderGit,{})})}),(0,r.jsx)("span",{className:(0,p.cn)("truncate",!x&&"text-muted-foreground"),children:x||"Pick a repository"})]})})}),(0,r.jsx)(ep.Bw,{className:"max-h-[50vh] overflow-y-auto",children:_?(0,r.jsx)(ep.Ql,{isPlaceHolder:!0,value:"",disabled:!0,children:"No indexed repository"}):(0,r.jsx)(r.Fragment,{children:null==s?void 0:s.map(e=>{var t;return(0,r.jsx)(ep.Ql,{value:e.fullPath,children:(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(ee,{kind:null==e?void 0:null===(t=e.repository)||void 0===t?void 0:t.kind,fallback:(0,r.jsx)(O.IconFolderGit,{})}),e.name]})},e.fullPath)})})})]}),(0,r.jsx)(eg.Vc,{stayOpenOnInputClick:!0,options:S,onSelect:z,open:E,onOpenChange:e=>{(b||(null==S?void 0:S.length))&&e?P(!0):P(!1)},children:e=>{let{highlightedIndex:t}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eg.JH,{children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(eg.KM,{className:"pr-8",placeholder:"Go to file",spellCheck:!1,value:b,ref:j,disabled:!x,onClick:e=>{w&&!E&&P(!0)},onChange:e=>{let t=e.target.value;y(t),t?T.run(t):D()}}),(0,r.jsx)("div",{className:"absolute right-2 top-0 flex h-full items-center",children:b?(0,r.jsx)(I.z,{variant:"ghost",size:"icon",className:"h-6 w-6 cursor-pointer",onClick:e=>{var t;y(""),D(),null===(t=j.current)||void 0===t||t.focus()},children:(0,r.jsx)(O.IconClose,{})}):(0,r.jsx)("kbd",{className:"rounded-md border bg-secondary/50 px-1.5 text-xs leading-4 text-muted-foreground shadow-[inset_-0.5px_-1.5px_0_hsl(var(--muted))]",onClick:e=>{var t;null===(t=j.current)||void 0===t||t.focus()},children:"t"})})]})}),(0,r.jsx)(eg.fD,{align:"start",side:"bottom",onOpenAutoFocus:e=>e.preventDefault(),style:{width:"50vw",maxWidth:700},className:"max-h-[50vh] overflow-y-auto",children:(0,r.jsx)(r.Fragment,{children:(null==S?void 0:S.length)?null==S?void 0:S.map((e,n)=>(0,r.jsxs)(eg.x5,{item:e,index:n,className:"flex w-full items-center gap-2 overflow-x-hidden",children:[(0,r.jsx)("div",{className:"shrink-0",children:"dir"===e.type?(0,r.jsx)(O.IconDirectorySolid,{style:{color:"rgb(84, 174, 255)"}}):(0,r.jsx)(O.IconFile,{})}),(0,r.jsx)("div",{className:"flex-1 break-all",children:(0,r.jsx)(ey,{text:e.path,indices:e.indices})}),t===n&&(0,r.jsx)("div",{className:"shrink-0`",children:"dir"===e.type?"Go to folder":"Go to file"})]},null==e?void 0:e.id)):(0,r.jsx)("div",{className:"flex h-24 items-center justify-center",children:"No matches found"})})})]})}})]})]})},ey=e=>{let{text:t,indices:n}=e,i=l.useMemo(()=>new Set(n),[n]);return(0,r.jsx)("p",{className:"text-muted-foreground",children:t.split("").map((e,t)=>i.has(t)?(0,r.jsx)("span",{className:"font-semibold text-foreground",children:e}):e)})},ew=()=>{let{activePath:e,setActivePath:t,expandedKeys:n,updateFileMap:i,toggleExpandedKey:s,initialized:a,fileTreeData:o,fileMap:c}=l.useContext(e_),d=l.useRef(null),u=function(e,t){var n,r;let[i,s]=(0,l.useState)(null!==(r=null===(n=e.current)||void 0===n?void 0:n.scrollTop)&&void 0!==r?r:0);return(0,l.useEffect)(()=>{if(e.current){let n=(0,ex.Z)(()=>{var t,n;s(null!==(n=null===(t=e.current)||void 0===t?void 0:t.scrollTop)&&void 0!==n?n:0)},t,{leading:!0}),r=e.current;return r.addEventListener("scroll",n),()=>{r.removeEventListener("scroll",n)}}},[e,t]),i}(d,200),f=l.useMemo(()=>{var t;let{repositorySpecifier:n}=(0,A.Jt)(e),r=o.find(e=>e.fullPath===n);return null!==(t=null==r?void 0:r.children)&&void 0!==t?t:[]},[e,o]);return(0,r.jsxs)("div",{className:"flex h-full flex-col overflow-hidden",children:[(0,r.jsx)(eb,{className:"shrink-0 px-4 pb-3"}),u>0&&(0,r.jsx)("div",{className:"h-0 border-b shadow-[0px_3px_8px_rgba(0,0,0,0.3)] dark:shadow-[0px_3px_8px_rgba(255,255,255,0.3)]"}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto px-4",ref:d,children:(0,r.jsx)(ev,{onSelectTreeNode:e=>{t(e.fullPath)},activePath:e,fileMap:c,updateFileMap:i,expandedKeys:n,toggleExpandedKey:s,initialized:a,fileTreeData:f})})]})},ek=e=>{let{className:t,blob:n,isImage:i,contentLength:s}=e,{activePath:a}=(0,l.useContext)(e_);return(0,r.jsxs)("div",{className:(0,p.cn)(t),children:[(0,r.jsx)(X,{blob:n,contentLength:s}),(0,r.jsx)("div",{className:"rounded-b-lg border border-t-0 p-2 text-center",children:i?(0,r.jsx)("img",{className:"mx-auto",src:n?URL.createObjectURL(n):void 0}):(0,r.jsx)("a",{className:"text-primary hover:underline",download:(0,A.i3)(null!=a?a:""),href:n?URL.createObjectURL(n):"",target:"_blank",children:"View raw"})})]})};var eN=n(50538);let eS=l.lazy(()=>Promise.all([n.e(5870),n.e(6056),n.e(9148),n.e(5392),n.e(4627)]).then(n.bind(n,34627))),eC=l.lazy(()=>Promise.all([n.e(5606),n.e(177),n.e(557)]).then(n.bind(n,30557))),eE=e=>{var t;let{className:n,blob:i,contentLength:s}=e,{searchParams:a,updateSearchParams:o}=(0,f.Z)(),[c,d]=l.useState(""),{activePath:u}=(0,l.useContext)(e_),v=u?(0,h.U$)(u)[0]:void 0,x=null!=v?v:"plain",m=!!c&&"markdown"===x,g=(null===(t=a.get("plain"))||void 0===t?void 0:t.toString())==="1";return l.useEffect(()=>{let e=async e=>{try{let t=await e.text();d(t)}catch(e){d("")}};i&&e(i)},[i]),(0,r.jsxs)("div",{className:(0,p.cn)(n),children:[(0,r.jsx)(X,{blob:i,contentLength:s,canCopy:!0,children:m&&(0,r.jsx)(eN.mQ,{value:g?"1":"0",onValueChange:e=>{"1"===e?o({set:{plain:"1"}}):o({del:"plain"})},children:(0,r.jsxs)(eN.dr,{children:[(0,r.jsx)(eN.SP,{value:"0",children:"Preview"}),(0,r.jsx)(eN.SP,{value:"1",children:"Code"})]})})}),(0,r.jsx)("div",{className:"rounded-b-lg border border-t-0 py-2",children:(0,r.jsx)(l.Suspense,{fallback:(0,r.jsx)(k.cg,{}),children:m&&!g?(0,r.jsx)(eC,{value:c}):(0,r.jsx)(eS,{value:c,language:x})})})]})},eP=(0,u.BX)("\n  query RepositoryList {\n    repositoryList {\n      id\n      name\n      kind\n      gitUrl\n    }\n  }\n"),e_=l.createContext({}),eR=e=>{let{children:t}=e,{searchParams:n,updateSearchParams:i}=(0,f.Z)(),a=l.useMemo(()=>{var e,t;return null!==(t=null===(e=n.get("path"))||void 0===e?void 0:e.toString())&&void 0!==t?t:""},[n]),o=(0,v.xG)(),[c,d]=l.useState(!1),[u,h]=l.useState({}),[x,m]=l.useState({}),[p,g]=l.useState(new Set),[j,b]=l.useState(!1),[y,w]=l.useState(),k=l.useMemo(()=>{if(!a)return[];let e=[],t=a.split("/");for(let n=0;n<t.length;n++){let r=t.slice(0,n+1).join("/");e.push(null==u?void 0:u[r])}return(0,s.Z)(e)},[a,u]),N=l.useMemo(()=>(function e(t){if(!t.length)return[];for(let n of(t.sort((e,t)=>{let n="file"===e.file.kind?1:0,r="file"===t.file.kind?1:0;return n-r||e.name.localeCompare(t.name)}),t))(null==n?void 0:n.children)&&e(n.children);return t})(function(e){let t=[];if(!e)return t;let n=Object.keys(e);for(let r of n){let n=e[r],{repositorySpecifier:l="",basename:i=""}=(0,A.Jt)(r),s=[l,...null==i?void 0:i.split("/")].filter(Boolean),a=t;for(let e=0;e<s.length;e++){let t=s.slice(0,e+1).join("/"),l=null==a?void 0:a.find(e=>e.fullPath===t);if(l)a=l.children||[];else{let e={file:n.file,name:n.name,fullPath:r,children:[],isRepository:n.isRepository,repository:n.repository};a.push(e),a=e.children}}}return t}(u)),[u]),S=l.useMemo(()=>{let{repositoryKind:e,repositoryName:t,repositorySpecifier:n}=(0,A.Jt)(a);if(e&&t)return n?x[n]:void 0},[a,x]);return(0,r.jsx)(e_.Provider,{value:{initialized:c,setInitialized:d,activePath:a,setActivePath:(e,t,n)=>{if(e){let r={path:e},l=["plain","line","redirect_filepath","redirect_git_url"];(null==t?void 0:t.line)&&(r.line=t.line,l=l.filter(e=>"line"!==e)),i({set:r,del:l,replace:n})}else i({del:["path","plain","line"],replace:n})},fileMap:u,updateFileMap:e=>{e&&h(t=>({...t,...e}))},expandedKeys:p,setExpandedKeys:g,toggleExpandedKey:e=>{let t=p.has(e),n=new Set(p);t?n.delete(e):n.add(e),g(n)},currentFileRoutes:k,fileTreeData:N,chatSideBarVisible:j,setChatSideBarVisible:b,pendingEvent:y,setPendingEvent:w,isChatEnabled:o,repoMap:x,setRepoMap:m,activeRepo:S},children:t})},eT=e=>{var t,n,i;let{className:s}=e,{activePath:a,setActivePath:u,updateFileMap:v,fileMap:h,initialized:m,setInitialized:g,setExpandedKeys:w,chatSideBarVisible:C,setChatSideBarVisible:E,setPendingEvent:P,setRepoMap:_,activeRepo:R}=l.useContext(e_),{searchParams:T}=(0,f.Z)(),I=l.useRef(!1),{setProgress:O}=(0,N.U)(),z=l.useRef(null),[L,Z]=l.useState(35),G=l.useMemo(()=>{let e=null==R?void 0:R.id,t=null==R?void 0:R.kind;return e&&t?"".concat((0,A.Fz)(t),"/").concat(e):""},[R]),H=l.useMemo(()=>{var e;return null===(e=(0,A.Jt)(a))||void 0===e?void 0:e.basename},[a]),[M,U]=l.useState(),J=a&&(null==h?void 0:null===(n=h[a])||void 0===n?void 0:null===(t=n.file)||void 0===t?void 0:t.kind)==="file",B=a?null==h?void 0:null===(i=h[a])||void 0===i?void 0:i.file:void 0,q=l.useMemo(()=>{var e,t,n;if(!m)return!1;let r=a&&(null==h?void 0:null===(t=h[a])||void 0===t?void 0:null===(e=t.file)||void 0===e?void 0:e.kind)==="dir";return r&&!(null==h?void 0:null===(n=h[a])||void 0===n?void 0:n.treeExpanded)},[a,h,m]),{data:W,isLoading:V}=(0,d.Z)(J?(0,A.fs)("/repositories/".concat(G,"/resolve/").concat(H)):null,e=>(0,x.Z)(e,{responseFormatter:async e=>{if(!e.ok)return;let t=(0,o.Z)(e.headers.get("Content-Length")),n=await e.blob();return{contentLength:t,blob:n}}}),{onError(e){c.A.error("Fail to fetch")}}),Q=null==W?void 0:W.blob,K=null==W?void 0:W.contentLength,{data:$,isLoading:X}=(0,d.Z)(q?(0,A.fs)("/repositories/".concat(G,"/resolve/").concat(H)):null,x.Z),Y=(null==B?void 0:B.kind)==="dir"||""===a,ee=J&&"text"===M,en=J&&("image"===M||"raw"===M);return l.useEffect(()=>{let e=async()=>{if(I.current)return;I.current=!0;let{patchMap:e,expandedKeys:t,repos:n}=await eO(a),r=T.get("redirect_filepath"),l=T.get("redirect_git_url"),i=T.get("line");if((null==n?void 0:n.length)&&r&&l){let e=n.find(e=>e.gitUrl===l);if(e){let t=(0,A.Pj)(e);u("".concat(t,"/").concat(r),{line:null!=i?i:""},!0),I.current=!1;return}}if((null==n?void 0:n.length)&&!a){let e=(0,A.Pj)(null==n?void 0:n[0]);u(e,void 0,!0),I.current=!1;return}n&&_((0,A.fr)(n)),e&&v(e),(null==t?void 0:t.length)&&w(new Set(t)),g(!0)};m||e()},[a]),l.useEffect(()=>{!m||(X||V?O(!0):X||V||O(!1))},[X,V]),l.useEffect(()=>{(()=>{if(Array.isArray(null==$?void 0:$.entries)&&a){var e;let{repositorySpecifier:t}=(0,A.Jt)(a),n={};if((null==h?void 0:h[a])&&(n[a]={...h[a],treeExpanded:!0}),null==$?void 0:null===(e=$.entries)||void 0===e?void 0:e.length)for(let e of $.entries){let r="".concat(t,"/").concat(e.basename);n[r]={file:e,name:(0,A.i3)(r),fullPath:r,treeExpanded:!1}}v(n);let r=(0,A.yH)(a,!0);(null==r?void 0:r.length)&&w(e=>{let t=new Set(e);for(let e of r)t.add(e);return t})}})()},[$]),l.useEffect(()=>{let e=async()=>{let e=await eA(null!=a?a:"",Q);U(e)};J?e():U("")},[a,J,Q]),l.useEffect(()=>{let e=e=>{E(!0),P(e)};return S.u.on("code_browser_quick_action",e),()=>{S.u.off("code_browser_quick_action",e)}},[]),l.useEffect(()=>{var e,t,n;C?(null===(e=z.current)||void 0===e||e.expand(),null===(t=z.current)||void 0===t||t.resize(L)):null===(n=z.current)||void 0===n||n.collapse()},[C]),(0,r.jsxs)(j,{direction:"horizontal",className:(0,p.cn)(s),onLayout:e=>{(null==e?void 0:e[2])&&Z(e[2])},children:[(0,r.jsx)(b,{defaultSize:20,minSize:20,maxSize:40,className:"hidden lg:block",children:(0,r.jsx)(ew,{})}),(0,r.jsx)(y,{className:"hidden w-1 bg-border/40 hover:bg-border active:bg-blue-500 lg:block"}),(0,r.jsx)(b,{defaultSize:80,minSize:30,children:(0,r.jsxs)("div",{className:"flex h-full flex-col overflow-y-auto px-4 pb-4",children:[(0,r.jsx)(F,{className:"py-4"}),m?(0,r.jsxs)("div",{children:[Y&&(0,r.jsx)(et,{loading:X,initialized:m,className:"rounded-lg border"}),ee&&(0,r.jsx)(eE,{blob:Q,contentLength:K}),en&&(0,r.jsx)(ek,{blob:Q,isImage:"image"===M,contentLength:K})]}):(0,r.jsx)(k.cg,{className:"rounded-lg border p-4"})]})}),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(y,{className:(0,p.cn)("hidden w-1 bg-border/40 hover:bg-border active:bg-blue-500",C&&"block")}),(0,r.jsx)(b,{collapsible:!0,collapsedSize:0,defaultSize:0,minSize:25,ref:z,onCollapse:()=>E(!1),children:(0,r.jsx)(D,{})})]})]})},eI=e=>{let[t]=(0,w.Hb)(),n=t?{height:"calc(100vh - ".concat(w.wt,")")}:{height:"100vh"};return(0,r.jsx)(eR,{children:(0,r.jsx)("div",{className:"transition-all",style:n,children:(0,r.jsx)(eT,{className:"source-code-browser",...e})})})};async function eO(e){try{let{repositoryKind:r,repositoryName:l,basename:i,repositorySpecifier:s}=(0,A.Jt)(e),a=await t(),o=(0,A.fr)(a),c=s?null==o?void 0:o[s]:void 0,d=e&&c?await n(e,o):[],u=e?(0,A.yH)(i):[],f={};for(let e of a){let t=(0,A.Pj)(e);t&&(f[t]={file:{kind:"dir",basename:e.name},name:e.name,fullPath:t,treeExpanded:e.name===l&&e.kind===r,isRepository:!0,repository:e})}for(let e of d){let t="".concat((0,A.Pj)({kind:r,name:l}),"/").concat(e.basename);f[t]={file:e,name:(0,A.i3)(e.basename),fullPath:t,treeExpanded:u.includes(e.basename)}}let v=u.map(e=>[(0,A.Pj)(c),e].filter(Boolean).join("/"));return{patchMap:f,expandedKeys:v,repos:a}}catch(e){return console.error(e),{}}async function t(){let e=m.L.createRequestOperation("query",(0,i.h)(eP,{}));return m.L.executeQuery(e).then(e=>{var t;return(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.repositoryList)||[]})}async function n(e,t){let n=[];try{let{repositorySpecifier:r}=(0,A.Jt)(e);if(!(0,a.Z)(t)&&r){let l=t[r];if(!l)return n;let i=await (0,A.lf)(e,l);n=null!=i?i:[]}}catch(e){console.error(e)}return n}}async function eA(e,t){var n;if(!t)return"";let r=null==t?void 0:t.type,l=null===(n=(0,h.U$)(e))||void 0===n?void 0:n[0];if(null==r?void 0:r.startsWith("image"))return"image";if(l||(null==r?void 0:r.startsWith("text")))return"text";let i=await new Promise((e,n)=>{let r=t.slice(0,1024),l=new FileReader;l.onloadend=function(t){var n;if((null==t?void 0:null===(n=t.target)||void 0===n?void 0:n.readyState)===FileReader.DONE){let n=t.target.result;"string"!=typeof n?e(!1):/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x9F]/.test(n)?e(!1):e(!0)}},l.onerror=function(){e(!1)},l.readAsText(r,"UTF-8")});return i?"text":"raw"}},48048:function(e,t,n){"use strict";n.d(t,{Fz:function(){return a},Jt:function(){return o},Pj:function(){return f},fr:function(){return v},fs:function(){return h},i3:function(){return c},lf:function(){return u},yH:function(){return d}});var r=n(74630),l=n(5035),i=n(18500),s=n(3765);function a(e){return e.toLowerCase().replaceAll("_","")}function o(e){let t={};if(!e)return t;let n=e.split("/"),r=n[0];if(!r)return t;if("git"===r){if(n.length<2)return t;let e=n[1];return{repositoryKind:i.vW.Git,repositoryName:e,basename:n.slice(2).join("/"),repositorySpecifier:"git/".concat(e)}}if(["github","gitlab","githubselfhosted","gitlabselfhosted"].includes(r)){if(n.length<3)return t;let e=i.vW.Github;switch(r){case"github":e=i.vW.Github;break;case"gitlab":e=i.vW.Gitlab;break;case"githubselfhosted":e=i.vW.GithubSelfHosted;break;case"gitlabselfhosted":e=i.vW.GitlabSelfHosted}let l=[n[1],n[2]].join("/");return{repositoryKind:e,repositoryName:l,basename:n.slice(3).join("/"),repositorySpecifier:"".concat(a(e),"/").concat(l)}}return t}function c(e){if(!e)return"";let t=e.split("/");return t[t.length-1]}function d(e,t){if((0,r.Z)(e))return[];let n=[""],l=e.split("/"),i=t?l.length:l.length-1;for(let e=0;e<i;e++)n.push(l.slice(0,e+1).join("/"));return n}async function u(e,t){if(!e||!t)return[];let{basename:n}=o(e),r=d(n),l=r.map(e=>()=>(0,s.Z)(h("/repositories/".concat(a(t.kind),"/").concat(t.id,"/resolve/").concat(e))).catch(e=>[])),i=await Promise.all(l.map(e=>e())),c=[];for(let e of i){var u;(null==e?void 0:null===(u=e.entries)||void 0===u?void 0:u.length)&&(c=[...c,...e.entries])}return c}function f(e){if((null==e?void 0:e.kind)&&(null==e?void 0:e.name))return"".concat(a(e.kind),"/").concat(e.name)}function v(e){return(0,l.Z)(e,e=>"".concat(a(e.kind),"/").concat(e.name))}function h(e){return e.split("/").map(e=>encodeURIComponent(e)).join("/")}},27064:function(e,t,n){"use strict";n.d(t,{u:function(){return l}});var r=n(18366);let l=(0,r.Z)()},30601:function(e,t,n){"use strict";n.d(t,{Hb:function(){return v},wt:function(){return d},xc:function(){return h},yo:function(){return f}});var r=n(36164),l=n(3546),i=n(74630),s=n(36327),a=n(80605),o=n(74248),c=n(81565);let d="3.5rem",u=l.createContext({}),f=e=>{let{children:t}=e,n=(0,a.UA)(),[s,o]=l.useState(!1);return l.useEffect(()=>{let e=window.self!==window.top;e||(0,i.Z)(n)||o(n)},[n]),(0,r.jsx)(u.Provider,{value:{isShowDemoBanner:s,setIsShowDemoBanner:o},children:t})};function v(){let{isShowDemoBanner:e,setIsShowDemoBanner:t}=l.useContext(u);return[e,t]}function h(){let[e,t]=v(),{data:n}=(0,s.Z)("https://api.github.com/repos/TabbyML/tabby",e=>fetch(e).then(e=>e.json()));return(0,r.jsxs)("div",{className:(0,o.cn)("flex items-center justify-between bg-primary px-4 text-primary-foreground transition-all md:px-5",{"opacity-100 pointer-events-auto":e,"opacity-0 pointer-events-none":!e}),style:e?{height:d}:{height:0},children:[(0,r.jsxs)("a",{href:"https://links.tabbyml.com/schedule-a-demo",target:"_blank",className:"flex items-center gap-x-2 text-xs font-semibold underline md:text-sm",children:[(0,r.jsx)("span",{children:"\uD83D\uDCC6"}),(0,r.jsx)("span",{children:"Book a 30-minute product demo."})]}),(0,r.jsxs)("div",{className:"flex items-center gap-x-4 md:gap-x-8",children:[(0,r.jsxs)("a",{href:"https://github.com/TabbyML/tabby",target:"_blank",className:"flex items-center transition-all hover:opacity-70",children:[(0,r.jsx)(c.IconGithub,{}),(0,r.jsxs)("div",{className:"ml-2 hidden md:block",children:[(0,r.jsx)("p",{className:"text-xs font-semibold",children:"TabbyML/tabby"}),(0,r.jsxs)("div",{className:(0,o.cn)("flex items-center text-xs transition-all",{"h-4 opacity-70":n,"h-0 opacity-0":!n}),children:[(0,r.jsx)(c.IconStar,{className:"mr-1 h-2.5 w-2.5"}),(0,r.jsx)("span",{children:null==n?void 0:n.stargazers_count}),(0,r.jsx)(c.IconGitFork,{className:"ml-2 mr-1 h-2.5 w-2.5"}),(0,r.jsx)("span",{children:null==n?void 0:n.forks_count})]})]})]}),(0,r.jsx)(c.IconClose,{className:"cursor-pointer transition-all hover:opacity-70",onClick:()=>t(!1)})]})]})}},38736:function(e,t,n){"use strict";n.d(t,{J:function(){return d},U:function(){return u}});var r=n(36164),l=n(3546),i=n(28242),s=n(7062),a=n.n(s),o=n(24449);let c=l.createContext({}),d=e=>{let{children:t}=e,[n,s]=l.useState(!1),[d]=(0,o.n)(n,300,{leading:!0}),{theme:u}=(0,i.F)();return l.useEffect(()=>{a().config({barColors:{0:"dark"===u?"#DC981A":"#B7942B"}})},[]),(0,r.jsxs)(c.Provider,{value:{progress:d,setProgress:s},children:[d&&(0,r.jsx)(a(),{}),t]})},u=()=>l.useContext(c)},54594:function(e,t,n){"use strict";n.d(t,{Bw:function(){return f},DI:function(){return c},Ph:function(){return o},Ql:function(){return h},U$:function(){return x},i4:function(){return u},ki:function(){return d}});var r=n(36164),l=n(3546),i=n(31889),s=n(74248),a=n(81565);let o=i.fC,c=i.ZA,d=i.B4,u=l.forwardRef((e,t)=>{let{className:n,children:l,...o}=e;return(0,r.jsxs)(i.xz,{ref:t,className:(0,s.cn)("flex h-9 w-full items-center justify-between rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),...o,children:[l,(0,r.jsx)(i.JO,{asChild:!0,children:(0,r.jsx)(a.IconChevronUpDown,{className:"opacity-50"})})]})});u.displayName=i.xz.displayName;let f=l.forwardRef((e,t)=>{let{className:n,children:l,position:a="popper",...o}=e;return(0,r.jsx)(i.h_,{children:(0,r.jsx)(i.VY,{ref:t,className:(0,s.cn)("relative z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md animate-in fade-in-80","popper"===a&&"translate-y-1",n),position:a,...o,children:(0,r.jsx)(i.l_,{className:(0,s.cn)("p-1","popper"===a&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:l})})})});f.displayName=i.VY.displayName;let v=l.forwardRef((e,t)=>{let{className:n,...l}=e;return(0,r.jsx)(i.__,{ref:t,className:(0,s.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",n),...l})});v.displayName=i.__.displayName;let h=l.forwardRef((e,t)=>{let{className:n,children:l,isPlaceHolder:o,...c}=e;return(0,r.jsxs)(i.ck,{ref:t,className:(0,s.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n),...c,children:[!o&&(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(i.wU,{children:(0,r.jsx)(a.IconCheck,{className:"h-4 w-4"})})}),(0,r.jsx)(i.eT,{children:l})]})});h.displayName=i.ck.displayName;let x=l.forwardRef((e,t)=>{let{className:n,...l}=e;return(0,r.jsx)(i.Z0,{ref:t,className:(0,s.cn)("-mx-1 my-1 h-px bg-muted",n),...l})});x.displayName=i.Z0.displayName},99047:function(e,t,n){"use strict";n.d(t,{RM:function(){return o},SC:function(){return d},iA:function(){return s},pj:function(){return f},ss:function(){return u},xD:function(){return a}});var r=n(36164),l=n(3546),i=n(74248);let s=l.forwardRef((e,t)=>{let{className:n,...l}=e;return(0,r.jsx)("table",{ref:t,className:(0,i.cn)("w-full caption-bottom text-sm",n),...l})});s.displayName="Table";let a=l.forwardRef((e,t)=>{let{className:n,...l}=e;return(0,r.jsx)("thead",{ref:t,className:(0,i.cn)("[&_tr]:border-b",n),...l})});a.displayName="TableHeader";let o=l.forwardRef((e,t)=>{let{className:n,...l}=e;return(0,r.jsx)("tbody",{ref:t,className:(0,i.cn)("[&_tr:last-child]:border-0",n),...l})});o.displayName="TableBody";let c=l.forwardRef((e,t)=>{let{className:n,...l}=e;return(0,r.jsx)("tfoot",{ref:t,className:(0,i.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",n),...l})});c.displayName="TableFooter";let d=l.forwardRef((e,t)=>{let{className:n,...l}=e;return(0,r.jsx)("tr",{ref:t,className:(0,i.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",n),...l})});d.displayName="TableRow";let u=l.forwardRef((e,t)=>{let{className:n,...l}=e;return(0,r.jsx)("th",{ref:t,className:(0,i.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",n),...l})});u.displayName="TableHead";let f=l.forwardRef((e,t)=>{let{className:n,...l}=e;return(0,r.jsx)("td",{ref:t,className:(0,i.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",n),...l})});f.displayName="TableCell";let v=l.forwardRef((e,t)=>{let{className:n,...l}=e;return(0,r.jsx)("caption",{ref:t,className:(0,i.cn)("mt-4 text-sm text-muted-foreground",n),...l})});v.displayName="TableCaption"},50538:function(e,t,n){"use strict";n.d(t,{SP:function(){return c},dr:function(){return o},mQ:function(){return a},nU:function(){return d}});var r=n(36164),l=n(3546),i=n(6044),s=n(74248);let a=i.fC,o=l.forwardRef((e,t)=>{let{className:n,...l}=e;return(0,r.jsx)(i.aV,{ref:t,className:(0,s.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",n),...l})});o.displayName=i.aV.displayName;let c=l.forwardRef((e,t)=>{let{className:n,...l}=e;return(0,r.jsx)(i.xz,{ref:t,className:(0,s.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",n),...l})});c.displayName=i.xz.displayName;let d=l.forwardRef((e,t)=>{let{className:n,...l}=e;return(0,r.jsx)(i.VY,{ref:t,className:(0,s.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",n),...l})});d.displayName=i.VY.displayName},93877:function(e,t,n){"use strict";n.d(t,{B:function(){return a},D:function(){return o}});var r=n(3546);let l=(e,t)=>{let[n,l]=(0,r.useState)(t),[i,s]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{let t=localStorage.getItem(e);t&&l(JSON.parse(t)),s(!1)},[]),[n,t=>{l(t),localStorage.setItem(e,JSON.stringify(t))},i]};class i{get value(){if("undefined"!=typeof localStorage){let e=localStorage.getItem(this.storageKey);if(e)return"true"===e}return this.defaultValue}constructor(e,t,n,r){this.storageKey=e,this.title=t,this.description=n,this.defaultValue=r}}let s=new class{defineGlobalVar(){return new i(this.storageKey,this.title,this.description,this.defaultValue)}defineHook(){return()=>{let[e,t,n]=l(this.storageKey,this.defaultValue);return[{value:e,title:this.title,description:this.description,loading:n},()=>{t(!e)}]}}constructor(e,t,n,r){this.storageKey="EXP_".concat(e),this.title=t,this.description=n,this.defaultValue=null!=r&&r}}("enable_code_browser_quick_action_bar","Quick Action Bar","Enable Quick Action Bar to display a convenient toolbar when you select code, offering options to explain the code, add unit tests, and more.",!0),a=s.defineGlobalVar(),o=s.defineHook()},38785:function(e,t,n){"use strict";n.d(t,{U:function(){return i}});var r=n(3546);let l=!0;function i(){let[e,t]=r.useState(()=>!l);return r.useEffect(function(){l=!1,t(!0)},[]),e}},44645:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(11978);function l(){let e=(0,r.usePathname)(),t=(0,r.useRouter)(),n=(0,r.useSearchParams)();return{pathname:e,router:t,searchParams:n,updateSearchParams:r=>{let{set:l,del:i,replace:s}=r,a=new URLSearchParams(n);l&&Object.entries(l).forEach(e=>{let[t,n]=e;return a.set(t,n)}),i&&(Array.isArray(i)?i.forEach(e=>a.delete(e)):a.delete(i));let o=a.toString(),c="".concat(e).concat(o.length>0?"?".concat(o):"");s?t.replace(c):t.push(c)},getQueryString:e=>{let t=new URLSearchParams(n);e&&Object.entries(e).forEach(e=>{let[n,r]=e;return t.set(n,r)});let r=t.toString();return r.length>0?"?".concat(r):""}}}},80605:function(e,t,n){"use strict";n.d(t,{UA:function(){return u},Uw:function(){return c},c7:function(){return o},jJ:function(){return d},xG:function(){return a}});var r=n(40055),l=n(43240);let i=(0,l.BX)("\n  query GetServerInfo {\n    serverInfo {\n      isAdminInitialized\n      isEmailConfigured\n      isChatEnabled\n      allowSelfSignup\n      isDemoMode\n    }\n  }\n"),s=()=>{let[{data:e}]=(0,r.aM)({query:i});return null==e?void 0:e.serverInfo},a=()=>{var e;return null===(e=s())||void 0===e?void 0:e.isChatEnabled},o=()=>{var e;return null===(e=s())||void 0===e?void 0:e.isAdminInitialized},c=()=>{var e;return null===(e=s())||void 0===e?void 0:e.isEmailConfigured},d=()=>{var e;return null===(e=s())||void 0===e?void 0:e.allowSelfSignup},u=()=>{var e;return null===(e=s())||void 0===e?void 0:e.isDemoMode}},25647:function(e,t,n){"use strict";n.d(t,{o:function(){return i}});var r=n(3546),l=n(38785);let i=(e,t)=>{let n=(0,l.U)(),i=e(e=>null==e?void 0:e._hasHydrated),s=e(t),[a,o]=r.useState(n&&i?s:void 0);return r.useEffect(()=>{o(s)},[s]),a}},17451:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var r=n(27257),l=n(85654),i=n(74248);let s=["_hasHydrated","setHasHydrated","activeChatId"],a={_hasHydrated:!1,chats:void 0,activeChatId:(0,i.x0)()},o=(0,r.Ue)()((0,l.tJ)(e=>({...a,setHasHydrated:t=>{e({_hasHydrated:t})}}),{name:"tabby-chat-storage",partialize:e=>Object.fromEntries(Object.entries(e).filter(e=>{let[t]=e;return!s.includes(t)})),onRehydrateStorage:()=>e=>{e&&e.setHasHydrated(!0)}}))},91302:function(e,t,n){"use strict";n.d(t,{Dp:function(){return m},Ho:function(){return g},QJ:function(){return w},av:function(){return S},kP:function(){return k},zq:function(){return y}});var r,l,i=n(36164),s=n(3546),a=n(11978),o=n(24426),c=n.n(o),d=n(43240),u=n(80605),f=n(11634),v=n(66794);function h(e,t){var n,r;let i=function(e,t){switch(t.type){case l.SignIn:case l.Refresh:return{status:"authenticated",data:t.data};case l.SignOut:return{status:"unauthenticated",data:void 0}}}(0,t);return e.status==i.status&&(n=e.data,r=i.data,(null==n?void 0:n.accessToken)===(null==r?void 0:r.accessToken)&&(null==n?void 0:n.refreshToken)===(null==r?void 0:r.refreshToken))?e:i}(r=l||(l={}))[r.SignIn=0]="SignIn",r[r.SignOut=1]="SignOut",r[r.Refresh=2]="Refresh";let x=s.createContext({}),m=(0,d.BX)("\n  mutation refreshToken($refreshToken: String!) {\n    refreshToken(refreshToken: $refreshToken) {\n      accessToken\n      refreshToken\n    }\n  }\n"),p=(0,d.BX)("\n  mutation LogoutAllSessions {\n    logoutAllSessions\n  }\n"),g=e=>{let{children:t}=e,[n,r]=s.useState(!1),[a]=c()(v.nd,void 0),[o,d]=s.useReducer(h,{status:"loading",data:void 0});s.useEffect(()=>{(null==a?void 0:a.accessToken)&&(null==a?void 0:a.refreshToken)?d({type:l.SignIn,data:a}):d({type:l.SignOut}),r(!0)},[]),s.useEffect(()=>{!n||((null==a?void 0:a.accessToken)&&(null==a?void 0:a.refreshToken)?d({type:l.Refresh,data:a}):(null==a?void 0:a.accessToken)||(null==a?void 0:a.refreshToken)||d({type:l.SignOut}))},[a]);let u=s.useMemo(()=>{var e;return(null==o?void 0:o.status)=="authenticated"?{data:{accessToken:o.data.accessToken},status:o.status}:{status:null!==(e=null==o?void 0:o.status)&&void 0!==e?e:"loading",data:null}},[o]);return(0,i.jsx)(x.Provider,{value:{authState:o,dispatch:d,session:u},children:t})};class j extends Error{constructor(){super("AuthProvider is missing. Please add the AuthProvider at root level")}}function b(){let e=s.useContext(x);if(!e)throw new j;return e}function y(){let{dispatch:e}=b(),[t,n]=c()(v.nd,void 0);return async t=>(n({accessToken:t.accessToken,refreshToken:t.refreshToken}),e({type:l.SignIn,data:t}),!0)}function w(){let e=(0,f.D)(p),{dispatch:t}=b(),[n,r]=c()(v.nd,void 0);return async()=>{await e(),r(void 0),t({type:l.SignOut})}}function k(){let{session:e}=b();return e}let N=["/auth/signin","/auth/signup","/auth/reset-password"];function S(){let e=(0,u.c7)(),t=(0,a.useRouter)(),n=(0,a.usePathname)(),r=(0,a.useSearchParams)(),{data:l,status:i}=k();return s.useEffect(()=>{if("loading"===i||"authenticated"===i||void 0===e)return;let l="/auth/signup"===n&&"true"===r.get("isAdmin");if(!l&&!e)return t.replace("/auth/signup?isAdmin=true");N.includes(n)||t.replace("/auth/signin")},[e,i]),l}},11634:function(e,t,n){"use strict";n.d(t,{D:function(){return v},L:function(){return h}});var r=n(22365),l=n(28552),i=n(81013),s=n(79716),a=n(74630),o=n(40055),c=n(44745),d=n(91302),u=n(70410),f=n(66794);function v(e,t){var n;let[r,l]=(0,o.Db)(e),i=(null==t?void 0:t.form)?(n=t.form,e=>{let{graphQLErrors:t=[]}=e;for(let e of t)if(e.extensions&&e.extensions["validation-errors"]){let t=e.extensions["validation-errors"];for(let e of t.errors)n.setError(e.path,e)}else(null==e?void 0:e.originalError)&&n.setError("root",e.originalError)}):void 0,s=async e=>{let n;try{if(null==(n=await l(e))?void 0:n.error)i&&i(n.error),(null==t?void 0:t.onError)&&t.onError(n.error);else if(!(0,a.Z)(null==n?void 0:n.data)){var r;null==t||null===(r=t.onCompleted)||void 0===r||r.call(t,n.data)}}catch(e){(null==t?void 0:t.onError)&&t.onError(e);return}return n};return s}let h=new c.KU({url:"/graphql",requestPolicy:"cache-and-network",exchanges:[(0,l.HG)({keys:{CompletionStats:()=>null,ServerInfo:()=>null,RepositorySearch:()=>null,RepositoryList:()=>null},resolvers:{Query:{invitations:(0,i.N)(),repositories:(0,i.N)()}},updates:{Mutation:{deleteInvitation(e,t,n,r){e.deleteInvitation&&n.inspectFields("Query").filter(e=>"invitations"===e.fieldName).forEach(e=>{n.updateQuery({query:u.lE,variables:e.arguments},e=>{var n;return(null==e?void 0:null===(n=e.invitations)||void 0===n?void 0:n.edges)&&(e.invitations.edges=e.invitations.edges.filter(e=>e.node.id!==t.id)),e})})},deleteGitRepository(e,t,n,r){e.deleteGitRepository&&n.inspectFields("Query").filter(e=>"gitRepositories"===e.fieldName).forEach(e=>{n.updateQuery({query:u.S1,variables:e.arguments},e=>{var n;return(null==e?void 0:null===(n=e.gitRepositories)||void 0===n?void 0:n.edges)&&(e.gitRepositories.edges=e.gitRepositories.edges.filter(e=>e.node.id!==t.id)),e})})}}}}),(0,r.M)(async e=>{let t=(0,f.bW)(),n=null==t?void 0:t.accessToken,r=null==t?void 0:t.refreshToken;return{addAuthToOperation(t){let l=(0,f.bW)();return(n=null==l?void 0:l.accessToken,r=null==l?void 0:l.refreshToken,n)?e.appendHeaders(t,{Authorization:"Bearer ".concat(n)}):t},didAuthError(e,t){let n=e.graphQLErrors.some(e=>{var t;return(null==e?void 0:null===(t=e.extensions)||void 0===t?void 0:t.code)==="UNAUTHORIZED"});return n&&f.gN.clearAccessToken(),n},willAuthError(e){let t=(0,f.bW)();if(n=null==t?void 0:t.accessToken,r=null==t?void 0:t.refreshToken,"query"===e.kind&&e.query.definitions.some(e=>{var t;return"OperationDefinition"===e.kind&&(null===(t=e.name)||void 0===t?void 0:t.value)&&["GetServerInfo"].includes(e.name.value)})||"mutation"===e.kind&&e.query.definitions.some(e=>{var t;return"OperationDefinition"===e.kind&&(null===(t=e.name)||void 0===t?void 0:t.value)&&["tokenAuth","register"].includes(e.name.value)})||r&&"mutation"===e.kind&&e.query.definitions.some(e=>{var t;return"OperationDefinition"===e.kind&&(null==e?void 0:null===(t=e.name)||void 0===t?void 0:t.value)==="refreshToken"}))return!1;if(!n)return f.gN.clearAccessToken(),!0;try{let{exp:e}=(0,s.o)(n);return(0,f.pw)(e)}catch(e){return!0}},refreshAuth:async()=>f.gN.refreshToken(async()=>{var t;let n=null===(t=(0,f.bW)())||void 0===t?void 0:t.refreshToken;if(n)return e.mutate(d.Dp,{refreshToken:n}).then(e=>{var t;return null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.refreshToken})})}}),(0,c.Dk)({onError(e){e.message.startsWith("[GraphQL]")&&(e.message=e.message.replace("[GraphQL]","").trim())}}),c.Ek]})},66794:function(e,t,n){"use strict";n.d(t,{bW:function(){return a},gN:function(){return f},nd:function(){return s},pw:function(){return d}});var r=n(79716),l=n(74630),i=n(74248);let s="_tabby_auth",a=()=>{if((0,i.S_)()){let e=localStorage.getItem(s);if(e)try{return JSON.parse(e)}catch(e){}}},o=e=>{localStorage.setItem(s,JSON.stringify(e))},c=()=>{localStorage.removeItem(s),window.dispatchEvent(new StorageEvent("storage",{storageArea:window.localStorage,url:window.location.href,key:s}))},d=e=>!!(0,l.Z)(e)||Date.now()>1e3*e,u=e=>!(0,l.Z)(e)&&Date.now()-1e3*e<6e4,f=new class{clearAccessToken(){let e=a();e&&o({...e,accessToken:""})}async refreshToken(e){try{var t;if(void 0===(null===(t=navigator)||void 0===t?void 0:t.locks))throw console.error("The Web Locks API is not supported in your browser. Please upgrade to a newer browser version."),Error();await navigator.locks.request("_tabby_auth_lock",async()=>{let t;let n=a(),l=null==n?void 0:n.accessToken,i=null==n?void 0:n.refreshToken;if(l){let{iat:i}=(0,r.o)(l);t=u(i)?n:await e()}else i&&(t=await e());t?o(t):c()})}catch(e){c()}}}},18452:function(e,t,n){"use strict";n.d(t,{m:function(){return s},H:function(){return a}});var r=n(3546),l=n(89704),i=n(95686);function s(e,t){let[n,i]=(0,r.useState)(null),s=!1;return(0,r.useEffect)(()=>{if(e.current&&!s){var n;s=!0,i((n=e.current,(0,l.K)(n,{expose:{navigate:t.navigate}})))}},[e.current]),n}function a(e){let[t,n]=(0,r.useState)(null),l=!1;return(0,r.useEffect)(()=>{let t=window.self!==window.top;t&&!l&&(l=!0,n((0,i.c)({expose:{init:e.init,sendMessage:e.sendMessage}})))},[]),t}}},function(e){e.O(0,[872,55,3004,2178,6201,2578,3449,9421,3957,4553,1454,830,2672,3299,1889,2891,5048,6044,2660,4523,2879,7444,1565,410,7417,3375,5289,1744],function(){return e(e.s=4755)}),_N_E=e.O()}]);