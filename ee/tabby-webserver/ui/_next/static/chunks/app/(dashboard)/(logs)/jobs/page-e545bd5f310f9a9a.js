(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[699],{7404:function(e,n,r){"use strict";r.d(n,{j:function(){return s}});let t=e=>"boolean"==typeof e?"".concat(e):0===e?"0":e,o=function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.flat(1/0).filter(Boolean).join(" ")},s=(e,n)=>r=>{var s;if((null==n?void 0:n.variants)==null)return o(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:i,defaultVariants:a}=n,u=Object.keys(i).map(e=>{let n=null==r?void 0:r[e],o=null==a?void 0:a[e];if(null===n)return null;let s=t(n)||t(o);return i[e][s]}),l=r&&Object.entries(r).reduce((e,n)=>{let[r,t]=n;return void 0===t||(e[r]=t),e},{}),d=null==n?void 0:null===(s=n.compoundVariants)||void 0===s?void 0:s.reduce((e,n)=>{let{class:r,className:t,...o}=n;return Object.entries(o).every(e=>{let[n,r]=e;return Array.isArray(r)?r.includes({...a,...l}[n]):({...a,...l})[n]===r})?[...e,r,t]:e},[]);return o(e,u,d,null==r?void 0:r.class,null==r?void 0:r.className)}},87474:function(e,n,r){Promise.resolve().then(r.bind(r,54451))},54451:function(e,n,r){"use strict";r.r(n),r.d(n,{JobRuns:function(){return h}});var t=r(57437),o=r(2265),s=r(99109),i=r(61985),a=r(7820),u=r(57166),l=r(93023),d=r(84168),c=r(93111),f=r(1576);let v=i.L;function h(){var e,n;let[r,i]=o.useState({last:v}),[{data:h,error:m,fetching:g,stale:p}]=(0,s.aM)({query:u.GG,variables:r}),[x]=(0,a.io)({data:h,error:m,stale:p}),b=null==h?void 0:null===(e=h.jobRuns)||void 0===e?void 0:e.edges,y=null==h?void 0:null===(n=h.jobRuns)||void 0===n?void 0:n.pageInfo,j=null==y?void 0:y.hasPreviousPage,k=o.useMemo(()=>null==b?void 0:b.slice().reverse(),[b]);return(0,t.jsx)(t.Fragment,{children:x?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.B,{jobs:k}),j&&(0,t.jsx)("div",{className:"mt-8 text-center",children:(0,t.jsxs)(l.z,{disabled:g,onClick:()=>{i({last:v,before:null==y?void 0:y.startCursor})},children:[g&&(0,t.jsx)(d.IconSpinner,{className:"mr-2 h-4 w-4 animate-spin"}),"load more"]})})]}):(0,t.jsx)(c.c,{})})}},1576:function(e,n,r){"use strict";r.d(n,{B:function(){return f}});var t=r(57437);r(2265);var o=r(24033),s=r(24144),i=r(62067),a=r.n(i),u=r(39311),l=r(29155),d=r(84168),c=r(32553);let f=e=>{let{jobs:n,shouldRedirect:r=!0}=e,i=(0,o.useRouter)();return(0,t.jsxs)(c.iA,{children:[(0,t.jsx)(c.xD,{children:(0,t.jsxs)(c.SC,{children:[(0,t.jsx)(c.ss,{className:"w-[200px]",children:"Start Time"}),(0,t.jsx)(c.ss,{className:"w-[100px]",children:"Duration"}),(0,t.jsx)(c.ss,{className:"w-[100px]",children:"Job"}),(0,t.jsx)(c.ss,{className:"w-[100px] text-center",children:"Status"})]})}),(0,t.jsx)(c.RM,{children:(null==n?void 0:n.length)?(0,t.jsx)(t.Fragment,{children:null==n?void 0:n.map(e=>{var n;return(0,t.jsxs)(c.SC,{className:(0,u.cn)(r&&"cursor-pointer"),onClick:n=>{r&&i.push("/jobs/detail?id=".concat(e.node.id))},children:[(0,t.jsx)(c.pj,{children:a()(e.node.createdAt).format("MMMM D, YYYY h:mm a")}),(0,t.jsx)(c.pj,{children:(0,s.Z)(null===(n=e.node)||void 0===n?void 0:n.exitCode)?"Running":function(e){let{createdAt:n,finishedAt:r}=e;if(n&&r)return function(e){let n=e.hours(),r=e.minutes(),t=e.seconds(),o="";return n>0&&(o+="".concat(n,"h")),r>0&&(o.length>0&&(o+=" "),o+="".concat(r,"min")),t>0&&(o.length>0&&(o+=" "),o+="".concat(t,"s")),o}(a().duration(a()(r).diff(n)))}(e.node)}),(0,t.jsx)(c.pj,{children:(0,t.jsx)(l.C,{variant:"secondary",children:e.node.job})}),(0,t.jsx)(c.pj,{children:(0,t.jsx)("div",{className:"flex items-center justify-center",children:(0,t.jsx)(v,{node:e})})})]},e.node.id)})}):(0,t.jsx)(c.SC,{children:(0,t.jsx)(c.pj,{colSpan:r?4:3,className:"h-[100px] text-center",children:"No Data"})})})]})};function v(e){var n;let{node:r}=e;if(!r)return null;let o=null==r?void 0:null===(n=r.node)||void 0===n?void 0:n.exitCode;return(0,s.Z)(o)?(0,t.jsx)(d.IconInfoCircled,{}):0===o?(0,t.jsx)(d.IconCheckCircled,{}):(0,t.jsx)(d.IconCrossCircled,{})}},93111:function(e,n,r){"use strict";r.d(n,{c:function(){return s}});var t=r(57437),o=r(25645);let s=()=>(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(o.O,{className:"h-4 w-full"}),(0,t.jsx)(o.O,{className:"h-4 w-full"}),(0,t.jsx)(o.O,{className:"h-4 w-full"}),(0,t.jsx)(o.O,{className:"h-4 w-full"})]})},29155:function(e,n,r){"use strict";r.d(n,{C:function(){return a}});var t=r(57437);r(2265);var o=r(7404),s=r(39311);let i=(0,o.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",successful:"border-transparent bg-successful text-successful-foreground hover:bg-successful/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function a(e){let{className:n,variant:r,...o}=e;return(0,t.jsx)("div",{className:(0,s.cn)(i({variant:r}),n),...o})}},93023:function(e,n,r){"use strict";r.d(n,{d:function(){return u},z:function(){return l}});var t=r(57437),o=r(2265),s=r(67256),i=r(7404),a=r(39311);let u=(0,i.j)("inline-flex items-center justify-center rounded-md text-sm font-medium shadow ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-md hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90","hover-destructive":"shadow-none hover:bg-destructive/90 hover:text-destructive-foreground",outline:"border border-input hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"shadow-none hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 shadow-none hover:underline"},size:{default:"h-8 px-4 py-2",sm:"h-8 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-8 w-8 p-0"}},defaultVariants:{variant:"default",size:"default"}}),l=o.forwardRef((e,n)=>{let{className:r,variant:o,size:i,asChild:l=!1,...d}=e,c=l?s.g7:"button";return(0,t.jsx)(c,{className:(0,a.cn)(u({variant:o,size:i,className:r})),ref:n,...d})});l.displayName="Button"},25645:function(e,n,r){"use strict";r.d(n,{O:function(){return s}});var t=r(57437),o=r(39311);function s(e){let{className:n,...r}=e;return(0,t.jsx)("div",{className:(0,o.cn)("h-4 animate-pulse rounded-md bg-gray-200 dark:bg-gray-700",n),...r})}},32553:function(e,n,r){"use strict";r.d(n,{RM:function(){return u},SC:function(){return d},iA:function(){return i},pj:function(){return f},ss:function(){return c},xD:function(){return a}});var t=r(57437),o=r(2265),s=r(39311);let i=o.forwardRef((e,n)=>{let{className:r,...o}=e;return(0,t.jsx)("table",{ref:n,className:(0,s.cn)("w-full caption-bottom text-sm",r),...o})});i.displayName="Table";let a=o.forwardRef((e,n)=>{let{className:r,...o}=e;return(0,t.jsx)("thead",{ref:n,className:(0,s.cn)("[&_tr]:border-b",r),...o})});a.displayName="TableHeader";let u=o.forwardRef((e,n)=>{let{className:r,...o}=e;return(0,t.jsx)("tbody",{ref:n,className:(0,s.cn)("[&_tr:last-child]:border-0",r),...o})});u.displayName="TableBody";let l=o.forwardRef((e,n)=>{let{className:r,...o}=e;return(0,t.jsx)("tfoot",{ref:n,className:(0,s.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...o})});l.displayName="TableFooter";let d=o.forwardRef((e,n)=>{let{className:r,...o}=e;return(0,t.jsx)("tr",{ref:n,className:(0,s.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...o})});d.displayName="TableRow";let c=o.forwardRef((e,n)=>{let{className:r,...o}=e;return(0,t.jsx)("th",{ref:n,className:(0,s.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...o})});c.displayName="TableHead";let f=o.forwardRef((e,n)=>{let{className:r,...o}=e;return(0,t.jsx)("td",{ref:n,className:(0,s.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...o})});f.displayName="TableCell";let v=o.forwardRef((e,n)=>{let{className:r,...o}=e;return(0,t.jsx)("caption",{ref:n,className:(0,s.cn)("mt-4 text-sm text-muted-foreground",r),...o})});v.displayName="TableCaption"},61985:function(e,n,r){"use strict";r.d(n,{L:function(){return o},o:function(){return t}});let t="name@yourcompany.com",o=20},58001:function(e,n,r){"use strict";r.d(n,{Dp:function(){return y},Ho:function(){return j},QJ:function(){return T},Rn:function(){return p},av:function(){return R},bW:function(){return m},kP:function(){return S},pC:function(){return g},zq:function(){return w}});var t,o,s=r(57437),i=r(2265),a=r(24033),u=r(53771),l=r(99109),d=r(26566),c=r.n(d),f=r(58835),v=r(39311);(t=o||(o={}))[t.SignIn=0]="SignIn",t[t.SignOut=1]="SignOut",t[t.Refresh=2]="Refresh";let h="_tabby_auth",m=()=>{if((0,v.S_)()){let e=localStorage.getItem(h);if(e)try{return JSON.parse(e)}catch(e){}}},g=e=>{localStorage.setItem(h,JSON.stringify(e))},p=()=>{localStorage.removeItem(h),window.dispatchEvent(new StorageEvent("storage",{storageArea:window.localStorage,url:window.location.href,key:h}))};function x(e,n){var r,t;let s=function(e,n){switch(n.type){case o.SignIn:case o.Refresh:return{status:"authenticated",data:n.data};case o.SignOut:return{status:"unauthenticated",data:void 0}}}(0,n);return e.status==s.status&&(r=e.data,t=s.data,(null==r?void 0:r.accessToken)===(null==t?void 0:t.accessToken)&&(null==r?void 0:r.refreshToken)===(null==t?void 0:t.refreshToken))?e:s}let b=i.createContext({}),y=(0,f.BX)("\n  mutation refreshToken($refreshToken: String!) {\n    refreshToken(refreshToken: $refreshToken) {\n      accessToken\n      refreshToken\n    }\n  }\n"),j=e=>{let{children:n}=e,r=i.useRef(!1),[t]=c()(h,void 0),[a,l]=i.useReducer(x,{status:"loading",data:void 0});i.useEffect(()=>{r.current=!0,(null==t?void 0:t.accessToken)&&(null==t?void 0:t.refreshToken)?l({type:o.SignIn,data:t}):l({type:o.SignOut})},[]),i.useEffect(()=>{r.current&&((null==t?void 0:t.accessToken)&&(null==t?void 0:t.refreshToken)?l({type:o.SignIn,data:t}):l({type:o.SignOut}))},[t]);let d=i.useMemo(()=>{var e,n;if((null==a?void 0:a.status)=="authenticated")try{let{sub:e,is_admin:n}=(0,u.o)(a.data.accessToken);return{data:{email:e,isAdmin:n,accessToken:a.data.accessToken},status:a.status}}catch(n){return console.error("jwt decode failed"),{status:null!==(e=null==a?void 0:a.status)&&void 0!==e?e:"loading",data:{email:"",isAdmin:!1,accessToken:a.data.accessToken}}}return{status:null!==(n=null==a?void 0:a.status)&&void 0!==n?n:"loading",data:null}},[a]);return(0,s.jsx)(b.Provider,{value:{authState:a,dispatch:l,session:d},children:n})};class k extends Error{constructor(){super("AuthProvider is missing. Please add the AuthProvider at root level")}}function N(){let e=i.useContext(b);if(!e)throw new k;return e}function w(){let{dispatch:e}=N(),[n,r]=c()(h,void 0);return async n=>(r({accessToken:n.accessToken,refreshToken:n.refreshToken}),e({type:o.SignIn,data:n}),!0)}function T(){let{dispatch:e}=N(),[n,r]=c()(h,void 0);return async()=>{r(void 0),e({type:o.SignOut})}}function S(){let{session:e}=N();return e}let I=(0,f.BX)("\n  query GetIsAdminInitialized {\n    isAdminInitialized\n  }\n"),C=["/auth/signin","/auth/signup"];function R(){let[{data:e}]=(0,l.aM)({query:I}),n=(0,a.useRouter)(),r=(0,a.usePathname)(),{data:t,status:o}=S();return i.useEffect(()=>{"loading"!==o&&("authenticated"===o||((null==e?void 0:e.isAdminInitialized)===!1?n.replace("/auth/signup?isAdmin=true"):C.includes(r)||n.replace("/auth/signin")))},[e,o]),t}},7820:function(e,n,r){"use strict";r.d(n,{Db:function(){return v},Lp:function(){return g},io:function(){return h}});var t=r(2265),o=r(69166),s=r(73997),i=r(83074),a=r(53771),u=r(24144),l=r(99109),d=r(18398),c=r(58001),f=r(57166);function v(e,n){var r;let[t,o]=(0,l.Db)(e),s=(null==n?void 0:n.form)?(r=n.form,e=>{let{graphQLErrors:n=[]}=e;for(let e of n)if(e.extensions&&e.extensions["validation-errors"]){let n=e.extensions["validation-errors"];for(let e of n.errors)r.setError(e.path,e)}else(null==e?void 0:e.originalError)&&r.setError("root",e.originalError)}):void 0,i=async e=>{let r;try{if(null==(r=await o(e))?void 0:r.error)s&&s(r.error),(null==n?void 0:n.onError)&&n.onError(r.error);else if(!(0,u.Z)(null==r?void 0:r.data)){var t;null==n||null===(t=n.onCompleted)||void 0===t||t.call(n,r.data)}}catch(e){(null==n?void 0:n.onError)&&n.onError(e);return}return r};return i}function h(e){let{data:n,error:r,stale:o}=e,s=(e,n)=>!(0,u.Z)(e)||!(0,u.Z)(n),[i,a]=(0,t.useState)(s(n,r)&&!!o);return(0,t.useEffect)(()=>{!i&&s(n,r)&&a(!0)},[n,r]),[i,a]}let m=e=>Date.now()>1e3*e,g=new d.KU({url:"/graphql",requestPolicy:"cache-and-network",exchanges:[(0,s.HG)({resolvers:{Query:{invitations:(0,i.N)(),repositories:(0,i.N)(),jobRuns:(0,i.N)()}},updates:{Mutation:{deleteInvitation(e,n,r,t){e.deleteInvitation&&r.inspectFields("Query").filter(e=>"invitations"===e.fieldName).forEach(e=>{r.updateQuery({query:f.lE,variables:e.arguments},e=>{var r;return(null==e?void 0:null===(r=e.invitations)||void 0===r?void 0:r.edges)&&(e.invitations.edges=e.invitations.edges.filter(e=>e.node.id!==n.id)),e})})},deleteRepository(e,n,r,t){e.deleteRepository&&r.inspectFields("Query").filter(e=>"repositories"===e.fieldName).forEach(e=>{r.updateQuery({query:f.S1,variables:e.arguments},e=>{var r;return(null==e?void 0:null===(r=e.repositories)||void 0===r?void 0:r.edges)&&(e.repositories.edges=e.repositories.edges.filter(e=>e.node.id!==n.id)),e})})}}}}),(0,o.M)(async e=>{let n=(0,c.bW)(),r=null==n?void 0:n.accessToken,t=null==n?void 0:n.refreshToken;return{addAuthToOperation:n=>r?e.appendHeaders(n,{Authorization:"Bearer ".concat(r)}):n,didAuthError(e,n){var r;return(null==e?void 0:null===(r=e.response)||void 0===r?void 0:r.status)===401||e.graphQLErrors.some(e=>{var n;return(null==e?void 0:null===(n=e.extensions)||void 0===n?void 0:n.code)==="UNAUTHORIZED"})},willAuthError(e){let n=(0,c.bW)();if(r=null==n?void 0:n.accessToken,t=null==n?void 0:n.refreshToken,"mutation"===e.kind&&e.query.definitions.some(e=>{var n;return"OperationDefinition"===e.kind&&(null===(n=e.name)||void 0===n?void 0:n.value)&&["tokenAuth","registerUser"].includes(e.name.value)})||t&&"mutation"===e.kind&&e.query.definitions.some(e=>{var n;return"OperationDefinition"===e.kind&&(null==e?void 0:null===(n=e.name)||void 0===n?void 0:n.value)==="refreshToken"}))return!1;if(!r)return!0;try{let{exp:e}=(0,a.o)(r);return!e||m(e)}catch(e){return!0}},async refreshAuth(){if(t){var n;let o=await e.mutate(c.Dp,{refreshToken:t});(null===(n=o.data)||void 0===n?void 0:n.refreshToken)?(r=o.data.refreshToken.accessToken,t=o.data.refreshToken.refreshToken,(0,c.pC)({accessToken:r,refreshToken:t})):(0,c.Rn)()}else(0,c.Rn)()}}}),d.Ek]})},57166:function(e,n,r){"use strict";r.d(n,{GG:function(){return i},S1:function(){return s},lE:function(){return o}});var t=r(58835);let o=(0,t.BX)("\n  query ListInvitations(\n    $after: String\n    $before: String\n    $first: Int\n    $last: Int\n  ) {\n    invitations(after: $after, before: $before, first: $first, last: $last) {\n      edges {\n        node {\n          id\n          email\n          code\n          createdAt\n        }\n        cursor\n      }\n      pageInfo {\n        hasNextPage\n        hasPreviousPage\n        startCursor\n        endCursor\n      }\n    }\n  }\n"),s=(0,t.BX)("\n  query repositories($after: String, $before: String, $first: Int, $last: Int) {\n    repositories(after: $after, before: $before, first: $first, last: $last) {\n      edges {\n        node {\n          id\n          name\n          gitUrl\n        }\n        cursor\n      }\n      pageInfo {\n        hasNextPage\n        hasPreviousPage\n        startCursor\n        endCursor\n      }\n    }\n  }\n"),i=(0,t.BX)("\n  query ListJobRuns(\n    $ids: [ID!]\n    $after: String\n    $before: String\n    $first: Int\n    $last: Int\n  ) {\n    jobRuns(\n      ids: $ids\n      after: $after\n      before: $before\n      first: $first\n      last: $last\n    ) {\n      edges {\n        node {\n          id\n          job\n          createdAt\n          finishedAt\n          exitCode\n          stdout\n          stderr\n        }\n        cursor\n      }\n      pageInfo {\n        hasNextPage\n        hasPreviousPage\n        startCursor\n        endCursor\n      }\n    }\n  }\n")}},function(e){e.O(0,[6990,1091,584,4402,4168,2971,7864,1744],function(){return e(e.s=87474)}),_N_E=e.O()}]);