(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2436],{10814:function(e,r,t){Promise.resolve().then(t.bind(t,54304))},7846:function(e,r,t){"use strict";t.d(r,{ZP:function(){return z}});var n=t(36164),i=t(3546),l=t(11978),s=t(84381),a=t(94909),o=t(5493),c=t(2578),d=t(40055),u=t(23782),h=t(43240),x=t(18500),p=t(11634),m=t(57288),j=t(73460),v=t(31458),f=t(98150),b=t(81565),g=t(82394),C=t(5266),N=t(80363),y=t(48537),O=t(94770),w=t(3518),I=t(10221);let _=(0,h.BX)("\n  mutation updateOauthCredential($input: UpdateOAuthCredentialInput!) {\n    updateOauthCredential(input: $input)\n  }\n"),k=(0,h.BX)("\n  mutation deleteOauthCredential($provider: OAuthProvider!) {\n    deleteOauthCredential(provider: $provider)\n  }\n"),S=(0,h.BX)("\n  query OAuthCallbackUrl($provider: OAuthProvider!) {\n    oauthCallbackUrl(provider: $provider)\n  }\n"),G=u.Ry({clientId:u.Z_(),clientSecret:u.Z_().optional(),provider:u.jb(x.O4)});function z(e){let{className:r,isNew:t,provider:u,defaultValues:h,onSuccess:z,...A}=e,P=(0,l.useRouter)(),T=(0,d.m8)(),q=i.useMemo(()=>({...h||{},provider:u}),[]),[D,U]=i.useState(!1),[$,E]=i.useState(!1),F=(0,o.cI)({resolver:(0,s.F)(G),defaultValues:q}),X=F.watch("provider"),B=!(0,a.Z)(F.formState.dirtyFields),{isSubmitting:R}=F.formState,V=()=>{P.replace("/settings/sso")},Z=(0,p.Db)(_,{onCompleted(e){(null==e?void 0:e.updateOauthCredential)&&(null==z||z(F.getValues()))},form:F}),J=(0,p.Db)(k),L=async e=>{if(t){let r=await T.query(w.oauthCredential,{provider:e.provider}).then(e=>{var r;return!!(null==e?void 0:null===(r=e.data)||void 0===r?void 0:r.oauthCredential)});if(r){F.setError("provider",{message:"Provider already exists. Please choose another one"});return}}Z({input:e})},[{data:M}]=(0,d.aM)({query:S,variables:{provider:X}}),W=i.useMemo(()=>t?"e.g. e363c08d7e9ca4e66e723a53f38a21f6a54c1b83":Array(36).fill("*").join(""),[t]);return(0,n.jsx)(f.l0,{...F,children:(0,n.jsxs)("div",{className:(0,m.cn)("grid gap-2",r),...A,children:[(0,n.jsxs)("form",{className:"grid gap-4",onSubmit:F.handleSubmit(L),children:[(0,n.jsx)(I.D,{children:"Basic information"}),(0,n.jsx)(f.Wi,{control:F.control,name:"provider",render:e=>{let{field:{onChange:r,...i}}=e;return(0,n.jsxs)(f.xJ,{children:[(0,n.jsx)(f.lX,{children:"Provider"}),(0,n.jsx)(f.NI,{children:(0,n.jsxs)(N.E,{className:"flex gap-8",orientation:"horizontal",onValueChange:r,...i,children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(N.m,{value:x.O4.Github,id:"r_github",disabled:!t}),(0,n.jsxs)(C._,{className:"flex cursor-pointer items-center gap-2 pl-2",htmlFor:"r_github",children:[(0,n.jsx)(b.IconGitHub,{className:"h-5 w-5"}),"GitHub"]})]}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(N.m,{value:x.O4.Google,id:"r_google",disabled:!t}),(0,n.jsxs)(C._,{className:"flex cursor-pointer items-center gap-2 pl-2",htmlFor:"r_google",children:[(0,n.jsx)(b.IconGoogle,{className:"h-5 w-5"}),"Google"]})]}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(N.m,{value:x.O4.Gitlab,id:"r_gitlab",disabled:!t}),(0,n.jsxs)(C._,{className:"flex cursor-pointer items-center gap-2 pl-2",htmlFor:"r_gitlab",children:[(0,n.jsx)(b.IconGitLab,{className:"h-5 w-5"}),"GitLab"]})]})]})}),(0,n.jsx)(f.zG,{})]})}}),M&&(0,n.jsx)(f.xJ,{className:"mt-4",children:(0,n.jsxs)("div",{className:"flex flex-col gap-2 rounded-lg border px-3 py-2",children:[(0,n.jsx)("div",{className:"text-sm text-muted-foreground",children:"Create your OAuth2 application with the following information"}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("div",{className:"text-sm font-medium",children:"Authorization callback URL"}),(0,n.jsxs)("span",{className:"flex items-center text-sm",children:[M.oauthCallbackUrl,(0,n.jsx)(y.q,{type:"button",value:M.oauthCallbackUrl})]})]})]})}),(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)(I.D,{children:"OAuth provider information"}),(0,n.jsx)(f.pf,{children:"The information is provided by your identity provider."})]}),(0,n.jsx)(f.Wi,{control:F.control,name:"clientId",render:e=>{let{field:r}=e;return(0,n.jsxs)(f.xJ,{children:[(0,n.jsx)(f.lX,{required:!0,children:"Client ID"}),(0,n.jsx)(f.NI,{children:(0,n.jsx)(g.I,{placeholder:"e.g. ae1542c44b154c10c859",autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",...r})}),(0,n.jsx)(f.zG,{})]})}}),(0,n.jsx)(f.Wi,{control:F.control,name:"clientSecret",render:e=>{let{field:r}=e;return(0,n.jsxs)(f.xJ,{children:[(0,n.jsx)(f.lX,{required:t,children:"Client Secret"}),(0,n.jsx)(f.NI,{children:(0,n.jsx)(g.I,{className:(0,m.cn)({"placeholder:translate-y-[10%] !placeholder-foreground":!t}),placeholder:W,autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",type:"password",...r})}),(0,n.jsx)(f.zG,{})]})}}),(0,n.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,n.jsx)(v.z,{type:"button",variant:"ghost",onClick:V,children:"Back"}),!t&&(0,n.jsxs)(j.aR,{open:D,onOpenChange:U,children:[(0,n.jsx)(j.vW,{asChild:!0,children:(0,n.jsx)(v.z,{variant:"hover-destructive",children:"Delete"})}),(0,n.jsxs)(j._T,{children:[(0,n.jsxs)(j.fY,{children:[(0,n.jsx)(j.f$,{children:"Are you absolutely sure?"}),(0,n.jsx)(j.yT,{children:"This action cannot be undone. It will permanently delete the current credential."})]}),(0,n.jsxs)(j.xo,{children:[(0,n.jsx)(j.le,{children:"Cancel"}),(0,n.jsxs)(j.OL,{className:(0,v.d)({variant:"destructive"}),onClick:e=>{e.preventDefault(),E(!0),J({provider:X}).then(e=>{var r,t;(null==e?void 0:null===(r=e.data)||void 0===r?void 0:r.deleteOauthCredential)?V():(E(!1),(null==e?void 0:e.error)&&c.A.error(null==e?void 0:null===(t=e.error)||void 0===t?void 0:t.message))})},children:[$&&(0,n.jsx)(b.IconSpinner,{className:"mr-2 h-4 w-4 animate-spin"}),"Yes, delete it"]})]})]})]}),(0,n.jsx)(O.M,{licenses:[x.oj.Enterprise],children:e=>{let{hasValidLicense:r}=e;return(0,n.jsxs)(v.z,{type:"submit",disabled:!r||R||!t&&!B,children:[R&&(0,n.jsx)(b.IconSpinner,{className:"mr-2 h-4 w-4 animate-spin"}),t?"Create":"Update"]})}})]})]}),(0,n.jsx)(f.zG,{className:"text-center"})]})})}},54304:function(e,r,t){"use strict";t.r(r),t.d(r,{NewPage:function(){return d}});var n=t(36164),i=t(3546),l=t(11978),s=t(18500),a=t(20255),o=t(7846),c=t(31988);function d(){let[e,r]=(0,i.useState)("oauth"),t=(0,l.useRouter)(),d=()=>{t.replace("/settings/sso")};return(0,n.jsxs)("div",{children:[(0,n.jsx)(c.w,{value:e,onChange:r}),"oauth"===e?(0,n.jsx)(o.ZP,{provider:s.O4.Github,isNew:!0,onSuccess:d}):(0,n.jsx)(a.u,{isNew:!0,defaultValues:{skipTlsVerify:!1},onSuccess:d})]})}},48537:function(e,r,t){"use strict";t.d(r,{q:function(){return a}});var n=t(36164);t(3546);var i=t(28312),l=t(31458),s=t(81565);function a(e){let{className:r,value:t,onCopyContent:a,text:o,...c}=e,{isCopied:d,copyToClipboard:u}=(0,i.m)({timeout:2e3,onCopyContent:a});return t?(0,n.jsxs)(l.z,{variant:"ghost",size:o?"default":"icon",className:r,onClick:()=>{d||u(t)},...c,children:[d?(0,n.jsx)(s.IconCheck,{className:"text-green-600"}):(0,n.jsx)(s.IconCopy,{}),o&&(0,n.jsx)("span",{children:o}),!o&&(0,n.jsx)("span",{className:"sr-only",children:"Copy"})]}):null}},28312:function(e,r,t){"use strict";t.d(r,{m:function(){return a}});var n=t(3546),i=t(61200),l=t.n(i),s=t(2578);function a(e){let{timeout:r=2e3,onError:t,onCopyContent:i}=e,[a,o]=n.useState(!1),c=()=>{o(!0),setTimeout(()=>{o(!1)},r)},d=e=>{if("function"==typeof t){null==t||t(e);return}s.A.error("Failed to copy.")};return{isCopied:a,copyToClipboard:e=>{var r;if(e){if(i){i(e),c();return}if(null===(r=navigator.clipboard)||void 0===r?void 0:r.writeText)navigator.clipboard.writeText(e).then(c).catch(d);else{let r=l()(e);r?c():d()}}}}}}},function(e){e.O(0,[8415,7430,55,7812,4007,340,2546,1283,3449,2578,8511,240,2287,7070,8961,1889,3707,7137,1975,7288,1565,3240,4656,3518,1490,3375,5289,1744],function(){return e(e.s=10814)}),_N_E=e.O()}]);