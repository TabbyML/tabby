(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1908],{93634:function(e,t,n){Promise.resolve().then(n.bind(n,77930))},77930:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return p}});var r=n(36164),s=n(3546),l=n(11978),i=n(70787),o=n(97651),a=n.n(o),c=n(99092),u=n.n(c),d=n(21454),f=n(40055),h=n(3765),v=n(70410),x=n(73492),m=n(81565),j=n(90379),g=n(17484);function p(){var e,t,n;let i=(0,l.useRouter)(),o=(0,l.useSearchParams)(),c=o.get("id"),[{data:x,fetching:p},b]=(0,f.aM)({query:v.GG,variables:{ids:[c]},pause:!c}),{data:N,mutate:k}=(0,d.ZP)(c?"/background-jobs/".concat(c,"/logs"):null,e=>(0,h.Z)(e,{responseFormatter:e=>e.text(),errorHandler:e=>{throw Error(null==e?void 0:e.statusText.toString())}})),y=null==x?void 0:null===(n=x.jobRuns)||void 0===n?void 0:null===(t=n.edges)||void 0===t?void 0:null===(e=t[0])||void 0===e?void 0:e.node,O=(null==y?void 0:y.stdout)||N,A=(0,g.H)(y);return s.useEffect(()=>{let e;if((null==y?void 0:y.createdAt)&&!(null==y?void 0:y.finishedAt)){let t=!!(null==y?void 0:y.stdout);e=window.setTimeout(()=>{b(),t||k()},5e3)}return()=>{e&&clearInterval(e)}},[y]),(0,r.jsx)(r.Fragment,{children:p?(0,r.jsx)(j.cg,{}):(0,r.jsx)("div",{className:"flex flex-1 flex-col items-stretch gap-2",children:y&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{onClick:()=>{window.history.length<=1?i.push("/jobs"):i.back()},className:"-ml-1 flex cursor-pointer items-center transition-opacity hover:opacity-60",children:[(0,r.jsx)(m.IconChevronLeft,{className:"mr-1 h-6 w-6"}),(0,r.jsx)("h2",{className:"scroll-m-20 text-3xl font-bold tracking-tight first:mt-0",children:(0,g.Y)(y.job)})]}),(0,r.jsxs)("div",{className:"mb-2 flex gap-x-5 text-sm text-muted-foreground lg:gap-x-10",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(m.IconStopWatch,{}),(0,r.jsxs)("p",{children:["State: ",A]})]}),y.createdAt&&(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(m.IconClock,{}),(0,r.jsxs)("p",{children:["Created:"," ",u()(y.createdAt).format("YYYY-MM-DD HH:mm")]})]}),y.startedAt&&(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(m.IconClock,{}),(0,r.jsxs)("p",{children:["Started:"," ",u()(y.startedAt).format("YYYY-MM-DD HH:mm")]})]}),y.createdAt&&y.finishedAt&&(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(m.IconHistory,{}),(0,r.jsxs)("p",{children:["Duration:"," ",a()(u().duration(u()(y.finishedAt).diff(y.startedAt)).asMilliseconds())]})]})]}),(0,r.jsx)("div",{className:"flex flex-1 flex-col",children:(0,r.jsx)(w,{value:O,pending:("Pending"===A||"Running"===A)&&!N})})]})})})}function w(e){let{children:t,className:n,value:s,pending:l,...o}=e;return(0,r.jsxs)("div",{className:(0,x.cn)("relative mt-2 h-[72vh] w-full overflow-y-auto overflow-x-hidden rounded-lg border bg-gray-50 font-mono text-[0.9rem] dark:bg-gray-800",n),...o,children:[l&&!s&&(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-background/60",children:(0,r.jsx)(m.IconSpinner,{className:"h-8 w-8"})}),s&&(0,r.jsx)("pre",{className:"whitespace-pre-wrap p-4",children:(0,r.jsx)(i.Z,{children:s})})]})}},17484:function(e,t,n){"use strict";n.d(t,{H:function(){return i},Y:function(){return l}});var r=n(74630);let s={scheduler_git:"Git",scheduler_github_gitlab:"Github / Gitlab",web_crawler:"Docs"};function l(e){return e in s?s[e]:e}function i(e){return e?(0,r.Z)(e.exitCode)?e.startedAt?"Running":"Pending":0===e.exitCode?"Success":"Failed":"Pending"}},90379:function(e,t,n){"use strict";n.d(t,{PF:function(){return a},cg:function(){return i},tB:function(){return o}});var r=n(36164),s=n(73492),l=n(3448);let i=e=>{let{className:t,...n}=e;return(0,r.jsxs)("div",{className:(0,s.cn)("space-y-3",t),...n,children:[(0,r.jsx)(l.O,{className:"h-4 w-full"}),(0,r.jsx)(l.O,{className:"h-4 w-full"}),(0,r.jsx)(l.O,{className:"h-4 w-full"}),(0,r.jsx)(l.O,{className:"h-4 w-full"})]})},o=e=>{let{className:t,...n}=e;return(0,r.jsx)(l.O,{className:(0,s.cn)("h-4 w-full",t),...n})},a=e=>{let{className:t,...n}=e;return(0,r.jsxs)("div",{className:(0,s.cn)("flex flex-col gap-3",t),...n,children:[(0,r.jsx)(l.O,{className:"h-4 w-[20%]"}),(0,r.jsx)(l.O,{className:"h-4 w-full"}),(0,r.jsx)(l.O,{className:"h-4 w-[20%]"}),(0,r.jsx)(l.O,{className:"h-4 w-full"})]})}},3448:function(e,t,n){"use strict";n.d(t,{O:function(){return l}});var r=n(36164),s=n(73492);function l(e){let{className:t,...n}=e;return(0,r.jsx)("div",{className:(0,s.cn)("h-4 animate-pulse rounded-md bg-border",t),...n})}},3765:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(44745),s=n(57778),l=n(79716),i=n(91302),o=n(66794);async function a(e,t){var n;let r=null!==(n=null==t?void 0:t.customFetch)&&void 0!==n?n:window.fetch;if(function(e){var t;if(e.startsWith("/oauth/providers"))return!1;let n=null===(t=(0,o.bW)())||void 0===t?void 0:t.accessToken,r=(0,o.jW)();if(n)try{let{exp:e}=(0,l.o)(n);return(0,o.pw)(e)}catch(e){return!0}else if(r)return!(null==r?void 0:r.authorization);else return!0}(e))return o.gN.refreshToken(c).then(n=>f(e,t));let s=await r(e,u(t));return 401===s.status?(o.gN.clearAccessToken(),o.gN.refreshToken(c).then(n=>f(e,t))):h(s,t)}async function c(){var e,t;let n=null===(e=(0,o.bW)())||void 0===e?void 0:e.refreshToken;if(!n)return;let r=await d(n);return null==r?void 0:null===(t=r.data)||void 0===t?void 0:t.refreshToken}function u(e){var t,n;let r=new Headers(null==e?void 0:e.headers),s=null===(t=(0,o.bW)())||void 0===t?void 0:t.accessToken,l=(0,o.jW)();if(s)r.append("authorization","Bearer ".concat(null===(n=(0,o.bW)())||void 0===n?void 0:n.accessToken));else if(l){let e={Authorization:"Bearer ".concat(l.authorization),...l.headers},t=Object.keys(e);for(let n of t)r.append(n,e[n])}return{...e||{},headers:r}}async function d(e){let t=new r.KU({url:"/graphql",requestPolicy:"network-only",exchanges:[r.Ek]}),n=t.createRequestOperation("mutation",(0,s.h)(i.Dp,{refreshToken:e}));return t.executeMutation(n)}function f(e,t){var n;let r=null!==(n=null==t?void 0:t.customFetch)&&void 0!==n?n:window.fetch;return r(e,u(t)).then(e=>h(e,t))}function h(e,t){return(null==e?void 0:e.ok)?(null==t?void 0:t.responseFormatter)?t.responseFormatter(e):(null==t?void 0:t.responseFormat)==="blob"?e.blob():e.json():(null==t?void 0:t.errorHandler)?t.errorHandler(e):void 0}}},function(e){e.O(0,[7565,8415,5811,55,3594,9906,1454,7651,787,3492,1565,410,3396,3375,5289,1744],function(){return e(e.s=93634)}),_N_E=e.O()}]);