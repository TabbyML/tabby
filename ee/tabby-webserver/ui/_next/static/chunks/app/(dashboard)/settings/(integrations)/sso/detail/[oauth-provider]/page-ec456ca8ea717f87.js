(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4159],{61200:function(e,t,r){"use strict";var n=r(90275),o={"text/plain":"Text","text/html":"Url",default:"Text"};e.exports=function(e,t){var r,a,l,i,s,c,u,d,f=!1;t||(t={}),l=t.debug||!1;try{if(s=n(),c=document.createRange(),u=document.getSelection(),(d=document.createElement("span")).textContent=e,d.ariaHidden="true",d.style.all="unset",d.style.position="fixed",d.style.top=0,d.style.clip="rect(0, 0, 0, 0)",d.style.whiteSpace="pre",d.style.webkitUserSelect="text",d.style.MozUserSelect="text",d.style.msUserSelect="text",d.style.userSelect="text",d.addEventListener("copy",function(r){if(r.stopPropagation(),t.format){if(r.preventDefault(),void 0===r.clipboardData){l&&console.warn("unable to use e.clipboardData"),l&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var n=o[t.format]||o.default;window.clipboardData.setData(n,e)}else r.clipboardData.clearData(),r.clipboardData.setData(t.format,e)}t.onCopy&&(r.preventDefault(),t.onCopy(r.clipboardData))}),document.body.appendChild(d),c.selectNodeContents(d),u.addRange(c),!document.execCommand("copy"))throw Error("copy command was unsuccessful");f=!0}catch(n){l&&console.error("unable to copy using execCommand: ",n),l&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),f=!0}catch(n){l&&console.error("unable to copy using clipboardData: ",n),l&&console.error("falling back to prompt"),r="message"in t?t.message:"Copy to clipboard: #{key}, Enter",a=(/mac os x/i.test(navigator.userAgent)?"âŒ˜":"Ctrl")+"+C",i=r.replace(/#{\s*key\s*}/g,a),window.prompt(i,e)}}finally{u&&("function"==typeof u.removeRange?u.removeRange(c):u.removeAllRanges()),d&&document.body.removeChild(d),s()}return f}},39695:function(e,t,r){Promise.resolve().then(r.bind(r,274))},7846:function(e,t,r){"use strict";r.d(t,{ZP:function(){return A}});var n=r(36164),o=r(3546),a=r(11978),l=r(84381),i=r(94909),s=r(5493),c=r(2578),u=r(40055),d=r(23782),f=r(43240),p=r(18500),m=r(11634),v=r(70410),h=r(57288),x=r(73460),j=r(31458),b=r(98150),g=r(81565),y=r(82394),C=r(5266),Z=r(80363),w=r(11208),N=r(48537),O=r(94770),R=r(10221);let S=(0,f.BX)("\n  mutation updateOauthCredential($input: UpdateOAuthCredentialInput!) {\n    updateOauthCredential(input: $input)\n  }\n"),_=(0,f.BX)("\n  mutation deleteOauthCredential($provider: OAuthProvider!) {\n    deleteOauthCredential(provider: $provider)\n  }\n"),D=(0,f.BX)("\n  query OAuthCallbackUrl($provider: OAuthProvider!) {\n    oauthCallbackUrl(provider: $provider)\n  }\n"),k=d.Ry({clientId:d.Z_(),clientSecret:d.Z_(),provider:d.jb(p.O4)}),E=k.extend({clientSecret:d.Z_().optional()}),I="Provider already exists. Please choose another one";function A(e){let{className:t,isNew:r,defaultProvider:f,defaultValues:A,onSuccess:P,existedProviders:M,...z}=e,G=(0,a.useRouter)(),T=(0,u.m8)(),U=o.useMemo(()=>({...A||{},provider:f||p.O4.Github}),[]),[q,$]=o.useState(!1),[X,B]=o.useState(!1),F=o.useMemo(()=>r?k.extend({provider:d.jb(p.O4).refine(e=>!(null==M?void 0:M.includes(e)),{message:I})}):E,[r,M]),L=(0,s.cI)({resolver:(0,l.F)(F),defaultValues:U}),J=L.watch("provider"),V=!(0,i.Z)(L.formState.dirtyFields),{isSubmitting:W}=L.formState,H=()=>{G.replace("/settings/sso")},Y=(0,m.Db)(S,{onCompleted(e){(null==e?void 0:e.updateOauthCredential)&&(null==P||P(L.getValues()))},form:L}),K=L.watch("provider");o.useEffect(()=>{r&&(K&&(null==M?void 0:M.includes(K))?L.setError("provider",{message:I}):L.clearErrors("provider"))},[K,r,M]);let Q=(0,m.Db)(_),ee=async e=>{if(r){let t=await T.query(v.Ry,{provider:e.provider}).then(e=>{var t;return!!(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.oauthCredential)});if(t){L.setError("provider",{message:I});return}}Y({input:e})},[{data:et}]=(0,u.aM)({query:D,variables:{provider:J}}),er=o.useMemo(()=>r?"e.g. e363c08d7e9ca4e66e723a53f38a21f6a54c1b83":Array(36).fill("*").join(""),[r]);return(0,n.jsx)(b.l0,{...L,children:(0,n.jsxs)("div",{className:(0,h.cn)("grid gap-2",t),...z,children:[(0,n.jsxs)("form",{className:"grid gap-4",onSubmit:L.handleSubmit(ee),children:[(0,n.jsx)(R.D,{children:"Basic information"}),(0,n.jsx)(b.Wi,{control:L.control,name:"provider",render:e=>{let{field:{onChange:t,...o}}=e;return(0,n.jsxs)(b.xJ,{children:[(0,n.jsx)(b.lX,{children:"Provider"}),(0,n.jsx)(b.NI,{children:(0,n.jsxs)(Z.E,{className:"flex gap-8",orientation:"horizontal",onValueChange:t,...o,children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(Z.m,{value:p.O4.Github,id:"r_github",disabled:!r}),(0,n.jsxs)(C._,{className:"flex cursor-pointer items-center gap-2 pl-2",htmlFor:"r_github",children:[(0,n.jsx)(g.IconGitHub,{className:"h-5 w-5"}),"GitHub"]})]}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(Z.m,{value:p.O4.Google,id:"r_google",disabled:!r}),(0,n.jsxs)(C._,{className:"flex cursor-pointer items-center gap-2 pl-2",htmlFor:"r_google",children:[(0,n.jsx)(g.IconGoogle,{className:"h-5 w-5"}),"Google"]})]}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(Z.m,{value:p.O4.Gitlab,id:"r_gitlab",disabled:!r}),(0,n.jsxs)(C._,{className:"flex cursor-pointer items-center gap-2 pl-2",htmlFor:"r_gitlab",children:[(0,n.jsx)(g.IconGitLab,{className:"h-5 w-5"}),"GitLab"]})]})]})}),(0,n.jsx)(b.zG,{})]})}}),et&&(0,n.jsx)(b.xJ,{className:"mt-4",children:(0,n.jsxs)("div",{className:"flex flex-col gap-2 overflow-hidden rounded-lg border px-3 py-2",children:[(0,n.jsx)("div",{className:"text-sm text-muted-foreground",children:"Create your OAuth2 application with the following information"}),(0,n.jsxs)("div",{className:"flex flex-col justify-between sm:flex-row sm:items-center",children:[(0,n.jsx)("div",{className:"text-sm font-medium",children:"Authorization callback URL"}),(0,n.jsxs)("span",{className:"flex items-center text-sm",children:[(0,n.jsx)("span",{className:"truncate",children:et.oauthCallbackUrl}),(0,n.jsx)(N.q,{className:"shrink-0",type:"button",value:et.oauthCallbackUrl})]})]})]})}),(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)(R.D,{children:"OAuth provider information"}),(0,n.jsx)(b.pf,{children:"The information is provided by your identity provider."})]}),(0,n.jsx)(b.Wi,{control:L.control,name:"clientId",render:e=>{let{field:t}=e;return(0,n.jsxs)(b.xJ,{children:[(0,n.jsx)(b.lX,{required:!0,children:"Client ID"}),(0,n.jsx)(b.NI,{children:(0,n.jsx)(y.I,{placeholder:"e.g. ae1542c44b154c10c859",autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",...t})}),(0,n.jsx)(b.zG,{})]})}}),(0,n.jsx)(b.Wi,{control:L.control,name:"clientSecret",render:e=>{let{field:t}=e;return(0,n.jsxs)(b.xJ,{children:[(0,n.jsx)(b.lX,{required:r,children:"Client Secret"}),(0,n.jsx)(b.NI,{children:(0,n.jsx)(y.I,{className:(0,h.cn)({"placeholder:translate-y-[10%] !placeholder-foreground":!r}),placeholder:er,autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",type:"password",...t})}),(0,n.jsx)(b.zG,{})]})}}),(0,n.jsx)(w.Z,{className:"my-2"}),(0,n.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,n.jsx)(j.z,{type:"button",variant:"ghost",onClick:H,children:"Back"}),!r&&(0,n.jsxs)(x.aR,{open:q,onOpenChange:$,children:[(0,n.jsx)(x.vW,{asChild:!0,children:(0,n.jsx)(j.z,{variant:"hover-destructive",children:"Delete"})}),(0,n.jsxs)(x._T,{children:[(0,n.jsxs)(x.fY,{children:[(0,n.jsx)(x.f$,{children:"Are you absolutely sure?"}),(0,n.jsx)(x.yT,{children:"This action cannot be undone. It will permanently delete the current credential."})]}),(0,n.jsxs)(x.xo,{children:[(0,n.jsx)(x.le,{children:"Cancel"}),(0,n.jsxs)(x.OL,{className:(0,j.d)({variant:"destructive"}),onClick:e=>{e.preventDefault(),B(!0),Q({provider:J}).then(e=>{var t,r;(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.deleteOauthCredential)?H():(B(!1),(null==e?void 0:e.error)&&c.A.error(null==e?void 0:null===(r=e.error)||void 0===r?void 0:r.message))})},children:[X&&(0,n.jsx)(g.IconSpinner,{className:"mr-2 h-4 w-4 animate-spin"}),"Yes, delete it"]})]})]})]}),(0,n.jsx)(O.M,{licenses:[p.oj.Enterprise],children:e=>{let{hasValidLicense:t}=e;return(0,n.jsxs)(j.z,{type:"submit",disabled:!t||W||!r&&!V,children:[W&&(0,n.jsx)(g.IconSpinner,{className:"mr-2 h-4 w-4 animate-spin"}),r?"Create":"Update"]})}})]})]}),(0,n.jsx)(b.zG,{className:"text-center"})]})})}},274:function(e,t,r){"use strict";r.r(t),r.d(t,{OAuthCredentialDetail:function(){return m}});var n=r(36164),o=r(3546),a=r(11978),l=r(74630),i=r(25937),s=r(40055),c=r(70410),u=r(6230),d=r(90379),f=r(7846),p=r(31988);let m=e=>{let{provider:t}=e,r=(0,a.useRouter)(),[{data:m,fetching:v}]=(0,s.aM)({query:c.Ry,variables:{provider:t}}),h=null==m?void 0:m.oauthCredential,x=o.useMemo(()=>{if(h)return(0,i.Z)(h,e=>!(0,l.Z)(e))},[h]);return(0,n.jsx)("div",{children:(0,n.jsxs)(u.Z,{loading:v,fallback:(0,n.jsx)(d.cg,{className:"mt-2"}),children:[(0,n.jsx)(p.w,{value:"oauth",readonly:!0}),(0,n.jsx)(f.ZP,{defaultValues:x,onSuccess:()=>{r.push("/settings/sso")},className:"mt-6",defaultProvider:t})]})})}},48537:function(e,t,r){"use strict";r.d(t,{q:function(){return i}});var n=r(36164);r(3546);var o=r(28312),a=r(31458),l=r(81565);function i(e){let{className:t,value:r,onCopyContent:i,text:s,...c}=e,{isCopied:u,copyToClipboard:d}=(0,o.m)({timeout:2e3,onCopyContent:i});return r?(0,n.jsxs)(a.z,{variant:"ghost",size:s?"default":"icon",className:t,onClick:()=>{u||d(r)},...c,children:[u?(0,n.jsx)(l.IconCheck,{className:"text-green-600"}):(0,n.jsx)(l.IconCopy,{}),s&&(0,n.jsx)("span",{children:s}),!s&&(0,n.jsx)("span",{className:"sr-only",children:"Copy"})]}):null}},28312:function(e,t,r){"use strict";r.d(t,{m:function(){return i}});var n=r(3546),o=r(61200),a=r.n(o),l=r(2578);function i(e){let{timeout:t=2e3,onError:r,onCopyContent:o}=e,[i,s]=n.useState(!1),c=()=>{s(!0),setTimeout(()=>{s(!1)},t)},u=e=>{if("function"==typeof r){null==r||r(e);return}l.A.error("Failed to copy.")};return{isCopied:i,copyToClipboard:e=>{var t;if(e){if(o){o(e),c();return}if(null===(t=navigator.clipboard)||void 0===t?void 0:t.writeText)navigator.clipboard.writeText(e).then(c).catch(u);else{let t=a()(e);t?c():u()}}}}}},90275:function(e){e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,r=[],n=0;n<e.rangeCount;n++)r.push(e.getRangeAt(n));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||r.forEach(function(t){e.addRange(t)}),t&&t.focus()}}},85656:function(e,t,r){"use strict";r.d(t,{B:function(){return i}});var n=r(3546),o=r(47091),a=r(79869),l=r(74047);function i(e){let t=e+"CollectionProvider",[r,i]=(0,o.b)(t),[s,c]=r(t,{collectionRef:{current:null},itemMap:new Map}),u=e+"CollectionSlot",d=n.forwardRef((e,t)=>{let{scope:r,children:o}=e,i=c(u,r),s=(0,a.e)(t,i.collectionRef);return n.createElement(l.g7,{ref:s},o)}),f=e+"CollectionItemSlot",p="data-radix-collection-item",m=n.forwardRef((e,t)=>{let{scope:r,children:o,...i}=e,s=n.useRef(null),u=(0,a.e)(t,s),d=c(f,r);return n.useEffect(()=>(d.itemMap.set(s,{ref:s,...i}),()=>void d.itemMap.delete(s))),n.createElement(l.g7,{[p]:"",ref:u},o)});return[{Provider:e=>{let{scope:t,children:r}=e,o=n.useRef(null),a=n.useRef(new Map).current;return n.createElement(s,{scope:t,itemMap:a,collectionRef:o},r)},Slot:d,ItemSlot:m},function(t){let r=c(e+"CollectionConsumer",t),o=n.useCallback(()=>{let e=r.collectionRef.current;if(!e)return[];let t=Array.from(e.querySelectorAll(`[${p}]`)),n=Array.from(r.itemMap.values()),o=n.sort((e,r)=>t.indexOf(e.ref.current)-t.indexOf(r.ref.current));return o},[r.collectionRef,r.itemMap]);return o},i]}},81544:function(e,t,r){"use strict";r.d(t,{D:function(){return o}});var n=r(3546);function o(e){let t=(0,n.useRef)({value:e,previous:e});return(0,n.useMemo)(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}},26581:function(e,t,r){"use strict";var n=r(74913),o=r(77725),a=Object.prototype.hasOwnProperty;t.Z=function(e,t,r){var l=e[t];a.call(e,t)&&(0,o.Z)(l,r)&&(void 0!==r||t in e)||(0,n.Z)(e,t,r)}},74913:function(e,t,r){"use strict";var n=r(27015);t.Z=function(e,t,r){"__proto__"==t&&n.Z?(0,n.Z)(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}},94219:function(e,t,r){"use strict";r.d(t,{Z:function(){return u}});var n=r(30586),o=r(26581),a=r(81913),l=r(26329),i=r(84639),s=r(80143),c=function(e,t,r,n){if(!(0,i.Z)(e))return e;t=(0,a.Z)(t,e);for(var c=-1,u=t.length,d=u-1,f=e;null!=f&&++c<u;){var p=(0,s.Z)(t[c]),m=r;if("__proto__"===p||"constructor"===p||"prototype"===p)break;if(c!=d){var v=f[p];void 0===(m=n?n(v,p,f):void 0)&&(m=(0,i.Z)(v)?v:(0,l.Z)(t[c+1])?[]:{})}(0,o.Z)(f,p,m),f=f[p]}return e},u=function(e,t,r){for(var o=-1,l=t.length,i={};++o<l;){var s=t[o],u=(0,n.Z)(e,s);r(u,s)&&c(i,(0,a.Z)(s,e),u)}return i}},27015:function(e,t,r){"use strict";var n=r(47404),o=function(){try{var e=(0,n.Z)(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();t.Z=o},9841:function(e,t,r){"use strict";var n=r(95973),o=r(9111),a=r(82149);t.Z=function(e){return(0,n.Z)(e,a.Z,o.Z)}},8621:function(e,t,r){"use strict";var n=(0,r(34659).Z)(Object.getPrototypeOf,Object);t.Z=n},9111:function(e,t,r){"use strict";var n=r(68085),o=r(8621),a=r(45270),l=r(25407),i=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)(0,n.Z)(t,(0,a.Z)(e)),e=(0,o.Z)(e);return t}:l.Z;t.Z=i},82149:function(e,t,r){"use strict";r.d(t,{Z:function(){return u}});var n=r(30762),o=r(84639),a=r(36586),l=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t},i=Object.prototype.hasOwnProperty,s=function(e){if(!(0,o.Z)(e))return l(e);var t=(0,a.Z)(e),r=[];for(var n in e)"constructor"==n&&(t||!i.call(e,n))||r.push(n);return r},c=r(20568),u=function(e){return(0,c.Z)(e)?(0,n.Z)(e,!0):s(e)}},25937:function(e,t,r){"use strict";var n=r(64143),o=r(51722),a=r(94219),l=r(9841);t.Z=function(e,t){if(null==e)return{};var r=(0,n.Z)((0,l.Z)(e),function(e){return[e]});return t=(0,o.Z)(t),(0,a.Z)(e,r,function(e,r){return t(e,r[0])})}}},function(e){e.O(0,[8415,7430,55,641,340,4007,2546,1283,3449,2578,8511,240,2287,7070,8961,3707,3301,7288,1565,3240,4656,8040,3375,5289,1744],function(){return e(e.s=39695)}),_N_E=e.O()}]);