(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9464,3396],{87690:function(e,r,t){Promise.resolve().then(t.bind(t,48973))},85156:function(e,r,t){"use strict";t.d(r,{Kb:function(){return I},fB:function(){return S}});var n=t(36164),s=t(3546),a=t(70652),i=t.n(a),l=t(11978),o=t(84381),d=t(94909),u=t(5493),c=t(2578),f=t(23782),m=t(18500),p=t(73492),h=t(73460),v=t(31458),x=t(98150),g=t(81565),j=t(82394),b=t(39231);let y=f.Ry({displayName:f.Z_().trim(),accessToken:f.Z_(),apiBase:f.Z_().url().optional().nullable()}),N=y.extend({apiBase:f.Z_().url()}),w=y.extend({accessToken:f.Z_().optional()}),k=N.extend({accessToken:f.Z_().optional()});function I(e){var r;let{isNew:t,form:a,onSubmit:i,onDelete:o,cancleable:u=!0,deletable:f}=e,y=(0,b.A)(),N=(0,l.useRouter)(),[w,k]=s.useState(!1),[I,S]=s.useState(!1),{isSubmitting:C,dirtyFields:A}=a.formState,G=!(0,d.Z)(A),T=async e=>{if(e.preventDefault(),o){S(!0);try{await o()}catch(e){c.A.error("Failed to delete GitHub repository provider")}finally{S(!1)}}},z=s.useMemo(()=>{switch(y){case m.q6.Github:return"e.g. GitHub";case m.q6.GithubSelfHosted:return"e.g. GitHub-Self-Hosted";case m.q6.Gitlab:return"e.g. GitLab";case m.q6.GitlabSelfHosted:return"e.g. GitLab-Self-Hosted";default:return""}},[y]),P=s.useMemo(()=>{if(!t)return Array(36).fill("*").join("");switch(y){case m.q6.Github:case m.q6.GithubSelfHosted:return"e.g. github_pat_1ABCD1234ABCD1234ABCD1234ABCD1234ABCD1234";case m.q6.Gitlab:case m.q6.GitlabSelfHosted:return"e.g. glpat_1ABCD1234ABCD1234ABCD1234ABCD1234";default:return""}},[y,t]),_=s.useMemo(()=>{switch(y){case m.q6.GithubSelfHosted:return"e.g. https://api.github.yourcompany.com";case m.q6.GitlabSelfHosted:return"e.g. https://gitlab.yourcompany.com";default:return""}},[y]),D=[m.q6.GithubSelfHosted,m.q6.GitlabSelfHosted].includes(y);return(0,n.jsx)(x.l0,{...a,children:(0,n.jsx)("div",{className:"grid gap-2",children:(0,n.jsxs)("form",{className:"grid gap-6",onSubmit:a.handleSubmit(i),children:[(0,n.jsx)(x.Wi,{control:a.control,name:"displayName",render:e=>{let{field:r}=e;return(0,n.jsxs)(x.xJ,{children:[(0,n.jsx)(x.lX,{required:!0,children:"Display name"}),(0,n.jsx)(x.pf,{children:"A display name to help identifying different providers."}),(0,n.jsx)(x.NI,{children:(0,n.jsx)(j.I,{placeholder:z,autoCapitalize:"none",autoCorrect:"off",autoComplete:"off",...r})}),(0,n.jsx)(x.zG,{})]})}}),D&&(0,n.jsx)(x.Wi,{control:a.control,name:"apiBase",render:e=>{let{field:t}=e;return(0,n.jsxs)(x.xJ,{children:[(0,n.jsx)(x.lX,{required:!0,children:"Instance URL"}),(0,n.jsx)(x.pf,{children:"The VCS instance URL. Make sure this instance and Tabby are network reachable from each other."}),(0,n.jsx)(x.NI,{children:(0,n.jsx)(j.I,{placeholder:_,autoCapitalize:"none",autoCorrect:"off",autoComplete:"off",value:null!==(r=t.value)&&void 0!==r?r:"",onChange:e=>t.onChange(e.target.value)})}),(0,n.jsx)(x.zG,{})]})}}),(0,n.jsx)(x.Wi,{control:a.control,name:"accessToken",render:e=>{let{field:r}=e;return(0,n.jsxs)(x.xJ,{children:[(0,n.jsx)(x.lX,{required:t,children:"Personal Access Token"}),(0,n.jsx)(x.pf,{children:(0,n.jsx)(R,{})}),(0,n.jsx)(x.NI,{children:(0,n.jsx)(j.I,{placeholder:P,className:(0,p.cn)({"placeholder:translate-y-[10%] !placeholder-foreground":!t}),autoCapitalize:"none",autoCorrect:"off",autoComplete:"off",...r})}),(0,n.jsx)(x.zG,{})]})}}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("div",{children:(0,n.jsx)(x.zG,{})}),(0,n.jsxs)("div",{className:"flex gap-2",children:[u&&(0,n.jsx)(v.z,{type:"button",variant:"ghost",disabled:C,onClick:()=>N.back(),children:"Cancel"}),f&&(0,n.jsxs)(h.aR,{open:w,onOpenChange:k,children:[(0,n.jsx)(h.vW,{asChild:!0,children:(0,n.jsx)(v.z,{type:"button",variant:"hover-destructive",children:"Delete"})}),(0,n.jsxs)(h._T,{children:[(0,n.jsxs)(h.fY,{children:[(0,n.jsx)(h.f$,{children:"Are you absolutely sure?"}),(0,n.jsx)(h.yT,{children:"This will delete the provider and remove any repositories that have already been added to the provider."})]}),(0,n.jsxs)(h.xo,{children:[(0,n.jsx)(h.le,{children:"Cancel"}),(0,n.jsxs)(h.OL,{className:(0,v.d)({variant:"destructive"}),onClick:T,disabled:I,children:[I&&(0,n.jsx)(g.IconSpinner,{className:"mr-2"}),"Yes, delete it"]})]})]})]}),(0,n.jsxs)(v.z,{type:"submit",disabled:C||!t&&!G,children:[C&&(0,n.jsx)(g.IconSpinner,{className:"mr-2"}),t?"Create":"Update"]})]})]})]})})})}function S(e,r,t){let n=[m.q6.GithubSelfHosted,m.q6.GitlabSelfHosted].includes(r),s=e?n?N:y:n?k:w;return(0,u.cI)({resolver:(0,o.F)(s),defaultValues:t})}function R(){let e=(0,b.A)();return e===m.q6.Github||e===m.q6.GithubSelfHosted?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:["Create a dedicated service user and generate a"," ",(0,n.jsx)(C,{href:"https://github.com/settings/personal-access-tokens/new",children:"fine-grained personal access"})," ","token with the member role for the organization or all projects to be managed."]}),(0,n.jsx)("div",{className:"my-2 ml-3",children:"• Contents (Read-only)"}),(0,n.jsx)("div",{className:"my-2 ml-3",children:"• Pull requests (Read-only)"}),(0,n.jsx)("div",{className:"my-2 ml-3",children:"• Issues (Read-only)"})]}):e===m.q6.Gitlab||e===m.q6.GitlabSelfHosted?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:["Create a dedicated service user and generate a"," ",(0,n.jsx)(C,{href:"https://gitlab.com/-/user_settings/personal_access_tokens",children:"personal access token"})," ","with the maintainer role and at least following permissions for the group or projects to be managed. You can generate a project access token for managing a single project, or generate a group access token to manage all projects within the group."]}),(0,n.jsx)("div",{className:"my-2 ml-3",children:"• api"})]}):null}function C(e){let{href:r,children:t}=e;return(0,n.jsxs)(i(),{className:"inline-flex cursor-pointer flex-row items-center underline",href:r,target:"_blank",children:[t,(0,n.jsx)(g.IconExternalLink,{className:"ml-1"})]})}},48973:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return V}});var n=t(36164),s=t(3546),a=t(11978),i=t(84381),l=t(5493),o=t(2578),d=t(21454),u=t(40055),c=t(23782),f=t(21808),m=t(18500),p=t(24449),h=t(11634),v=t(70410),x=t(63795),g=t(31458),j=t(79972),b=t(30220),y=t(98150),N=t(81565),w=t(82394),k=t(57830),I=t(99047),S=t(83721),R=t(29),C=t(6230),A=t(90379),G=t(40030),T=t(55137),z=t(14522),P=t(39231),_=t(43240);let D=(0,_.BX)("\n  mutation UpdateIntegratedRepositoryActive(\n    $id: ID!\n    $active: Boolean!\n    $refs: [String!]\n  ) {\n    updateIntegratedRepositoryActive(id: $id, active: $active, refs: $refs)\n  }\n"),E=(0,_.BX)("\n  mutation UpdateIntegratedRepositoryRefs($id: ID!, $refs: [String!]!) {\n    updateIntegratedRepositoryRefs(id: $id, refs: $refs)\n  }\n");var q=t(73492),O=t(36065),B=t(84942);let F=c.Ry({id:c.Z_(),refs:c.IX(c.Z_()).optional()});function Z(e){let{onCreated:r,onCancel:t,repositories:a,providerStatus:o,fetchingRepos:d}=e,[u,c]=s.useState(!1),f=(0,l.cI)({resolver:(0,i.F)(F)}),p=s.useRef(null),{isSubmitting:v}=f.formState,x=s.useMemo(()=>{switch(o){case m.Ij.Pending:return"Awaiting the next data synchronization";case m.Ij.Failed:return"Synchronizing error. Please check if the access token is still valid";default:return"No repository found"}},[o]),j=(0,h.Db)(D,{form:f}),b=async e=>{var t,n;let s=e.id,a=(null===(t=e.refs)||void 0===t?void 0:t.length)?e.refs:[],i=await j({id:s,active:!0,refs:a});(null==i?void 0:null===(n=i.data)||void 0===n?void 0:n.updateIntegratedRepositoryActive)&&(f.reset({id:void 0,refs:[]}),null==r||r(s))},w=()=>{requestAnimationFrame(()=>{p.current&&(p.current.scrollTop=0)})},k=()=>{w()};return(0,n.jsx)(y.l0,{...f,children:(0,n.jsxs)("div",{className:"grid gap-2",children:[(0,n.jsxs)("form",{className:"grid gap-6",onSubmit:f.handleSubmit(b),children:[(0,n.jsx)(y.Wi,{control:f.control,name:"id",render:e=>{var r,t;let{field:s}=e;return(0,n.jsxs)(y.xJ,{className:"flex flex-col",children:[(0,n.jsxs)(B.J2,{open:u,onOpenChange:c,children:[(0,n.jsx)(B.xo,{asChild:!0,children:(0,n.jsx)(y.NI,{children:(0,n.jsxs)(g.z,{variant:"outline",role:"combobox",className:(0,q.cn)("justify-between font-normal",!s.value&&"text-muted-foreground"),children:[s.value?null==a?void 0:null===(t=a.find(e=>e.node.id===s.value))||void 0===t?void 0:null===(r=t.node)||void 0===r?void 0:r.gitUrl:"Select repository",(0,n.jsx)(N.IconChevronUpDown,{})]})})}),(0,n.jsx)(B.yk,{className:"w-[var(--radix-popover-trigger-width)] p-0",align:"start",side:"bottom",children:(0,n.jsxs)(O.mY,{children:[(0,n.jsx)(O.sZ,{placeholder:"Search repository...",onValueChange:k}),(0,n.jsxs)(O.e8,{className:"max-h-[30vh]",ref:p,children:[(0,n.jsx)(O.rb,{children:d?(0,n.jsx)("div",{className:"flex justify-center",children:(0,n.jsx)(N.IconSpinner,{className:"h-6 w-6"})}):x}),(0,n.jsx)(O.fu,{children:o!==m.Ij.Pending&&(null==a?void 0:a.map(e=>(0,n.jsxs)(O.di,{onSelect:()=>{f.setValue("id",e.node.id),c(!1)},children:[(0,n.jsx)(N.IconCheck,{className:(0,q.cn)("mr-2",e.node.id===s.value?"opacity-100":"opacity-0")}),e.node.gitUrl]},e.node.id)))})]})]})})]}),(0,n.jsx)(y.zG,{})]})}}),(0,n.jsx)(y.Wi,{control:f.control,name:"refs",render:e=>{let{field:r}=e;return(0,n.jsxs)(y.xJ,{children:[(0,n.jsx)(y.lX,{children:"Branches"}),(0,n.jsx)(y.pf,{children:"Branches to index (press Enter to select, leave empty for default branch)"}),(0,n.jsx)(y.NI,{children:(0,n.jsx)(S.E,{placeholder:"e.g. main",autoCapitalize:"none",autoCorrect:"off",...r})}),(0,n.jsx)(y.zG,{})]})}}),(0,n.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,n.jsx)(g.z,{type:"button",variant:"ghost",disabled:v,onClick:t,children:"Cancel"}),(0,n.jsx)(g.z,{type:"submit",disabled:v,children:"Add"})]})]}),(0,n.jsx)(y.zG,{className:"text-center"})]})})}var U=t(85156);let M=(0,_.BX)("\n  mutation UpdateIntegration($input: UpdateIntegrationInput!) {\n    updateIntegration(input: $input)\n  }\n"),$=(0,_.BX)("\n  mutation DeleteIntegration($id: ID!, $kind: IntegrationKind!) {\n    deleteIntegration(id: $id, kind: $kind)\n  }\n"),H=e=>{let{defaultValues:r,onSuccess:t,onDelete:s,onUpdate:a,id:i,kind:l}=e,d=(0,U.fB)(!1,l,r),u=(0,h.Db)($),c=(0,h.Db)(M,{form:d}),f=async e=>{var r;let n=await c({input:{id:i,...e,kind:l}});(null==n?void 0:null===(r=n.data)||void 0===r?void 0:r.updateIntegration)&&(o.A.success("Updated provider successfully"),null==d||d.reset(null==d?void 0:d.getValues()),null==t||t(),null==a||a())},m=async()=>{var e,r;let t=await u({id:i,kind:l});(null==t?void 0:null===(e=t.data)||void 0===e?void 0:e.deleteIntegration)?null==s||s():o.A.error((null==t?void 0:null===(r=t.error)||void 0===r?void 0:r.message)||"Failed to delete provider")};return(0,n.jsx)(U.Kb,{onSubmit:f,onDelete:m,deletable:!0,cancleable:!1,form:d,isNew:!1})},L=f.L8,Y=e=>{var r,t;let{providerStatus:a,providerId:i,kind:l}=e,[c,f]=s.useState(1),[{data:m,fetching:x}]=(0,u.aM)({query:v.gI}),{repositories:j,setRepositories:y,isAllLoaded:w}=function(e,r){let[t,n]=(0,s.useState)({ids:[e],first:L,active:!1,kind:r}),[a,i]=(0,s.useState)([]),[l,o]=(0,s.useState)(!e),[{data:d,fetching:c}]=(0,u.aM)({query:v.ts,variables:t,pause:!e});return(0,s.useEffect)(()=>{if(!l&&!c&&d){var r,t;let s=null==d?void 0:null===(r=d.integratedRepositories)||void 0===r?void 0:r.pageInfo,l=[...a];i(l.concat(null==d?void 0:null===(t=d.integratedRepositories)||void 0===t?void 0:t.edges)),(null==s?void 0:s.hasNextPage)?n({ids:[e],first:L,after:s.endCursor,active:!1}):o(!0)}},[c,d]),{repositories:a,setRepositories:i,isAllLoaded:l}}(i,l),S=e=>h.Lp.query(v.ts,e).toPromise(),R=async(e,r)=>{var t;let n=await S({ids:[i],first:L,after:r,active:!0,kind:l}),s=null==n?void 0:null===(t=n.data)||void 0===t?void 0:t.integratedRepositories,a=null==s?void 0:s.pageInfo;return e-1>0&&(null==a?void 0:a.hasNextPage)&&(null==a?void 0:a.endCursor)?R(e-1,a.endCursor):null==n?void 0:n.data};(0,d.ZP)(["refresh_repos",c],e=>{let[,r]=e;R(r).then(e=>P(e))},{revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateOnMount:!1,refreshInterval:1e4});let[A,P]=s.useState(),[_,q]=s.useState(!0),[O,B]=s.useState([]),F=null==A?void 0:null===(r=A.integratedRepositories)||void 0===r?void 0:r.edges,U=null==A?void 0:null===(t=A.integratedRepositories)||void 0===t?void 0:t.pageInfo,[M,$]=s.useState(null),H=(0,h.Db)(D,{onError(e){o.A.error(e.message||"Failed to delete")}}),Y=(0,h.Db)(E,{onError(e){o.A.error(e.message||"Failed to update")}}),J=e=>{$({id:e.id,displayName:e.displayName,gitUrl:e.gitUrl,refs:e.refs.map(e=>e.name.startsWith("refs/heads/")?e.name.substring(11):e.name.startsWith("refs/tags/")?e.name.substring(10):e.name)})},V=(0,h.Db)(z.C),W=async(e,r)=>{H({id:e.node.id,active:!1}).then(t=>{var n;if(null==t?void 0:null===(n=t.data)||void 0===n?void 0:n.updateIntegratedRepositoryActive){y(et([...j,e]));let t=r?c-1:c;X(t||1)}})},X=async e=>{try{q(!0);let r=await R(e);P(r),f(e)}catch(e){}finally{q(!1)}},K=(0,p.S)(e=>{B([]),X(e)},3e3),[ee,er]=s.useState(!1),et=e=>(null==e?void 0:e.length)?e.sort((e,r)=>{var t;return null===(t=e.node.displayName)||void 0===t?void 0:t.localeCompare(r.node.displayName)}):e,en=e=>{K.cancel(),B([]),X(e)},es=e=>V({command:e}).then(e=>{var r,t;(null==e?void 0:null===(r=e.data)||void 0===r?void 0:r.triggerJobRun)?(o.A.success("The job has been triggered successfully, it may take a few minutes to process."),en(c)):o.A.error((null==e?void 0:null===(t=e.error)||void 0===t?void 0:t.message)||"Failed to trigger job")});return s.useEffect(()=>(X(1),()=>K.cancel()),[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(C.Z,{loading:_,children:[(0,n.jsxs)(k.ScrollArea,{children:[(0,n.jsxs)(I.iA,{className:"min-w-[400px]",children:[(0,n.jsx)(I.xD,{children:(0,n.jsxs)(I.SC,{children:[(0,n.jsx)(I.ss,{className:"w-[25%]",children:"Name"}),(0,n.jsx)(I.ss,{className:"w-[35%]",children:"URL"}),(0,n.jsx)(I.ss,{className:"w-[140px]",children:"Access"}),(0,n.jsx)(I.ss,{children:"Job"}),(0,n.jsx)(I.ss,{className:"w-[60px] text-right",children:(0,n.jsx)(g.z,{variant:"outline",size:"icon",className:"shadow-none",onClick:e=>er(!0),children:(0,n.jsx)(N.IconPlus,{})})})]})}),(0,n.jsx)(I.RM,{children:(null==F?void 0:F.length)||(null==O?void 0:O.length)?(0,n.jsxs)(n.Fragment,{children:[null==O?void 0:O.map(e=>(0,n.jsxs)(I.SC,{className:"!bg-muted/80",children:[(0,n.jsx)(I.pj,{className:"break-all lg:break-words",children:e.node.displayName}),(0,n.jsx)(I.pj,{className:"break-all lg:break-words",children:e.node.gitUrl}),(0,n.jsx)(I.pj,{}),(0,n.jsx)(I.pj,{}),(0,n.jsx)(I.pj,{className:"flex justify-end",children:(0,n.jsx)("div",{className:(0,g.d)({variant:"ghost",size:"icon"}),children:(0,n.jsx)(N.IconSpinner,{})})})]},e.node.id)),null==F?void 0:F.map(e=>(0,n.jsxs)(I.SC,{children:[(0,n.jsx)(I.pj,{className:"break-all lg:break-words",children:e.node.displayName}),(0,n.jsx)(I.pj,{className:"break-all lg:break-words",children:e.node.gitUrl}),(0,n.jsx)(I.pj,{className:"break-all lg:break-words",children:(0,n.jsx)(G.r,{sourceId:e.node.sourceId,sourceName:e.node.displayName,editable:!0,fetchingUserGroups:x,userGroups:null==m?void 0:m.userGroups})}),(0,n.jsx)(I.pj,{children:(0,n.jsx)(T._,{jobInfo:e.node.jobInfo,onTrigger:()=>es(e.node.jobInfo.command)})}),(0,n.jsx)(I.pj,{className:"text-right",children:(0,n.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,n.jsx)(g.z,{size:"icon",variant:"ghost",onClick:()=>J({id:e.node.id,displayName:e.node.displayName,gitUrl:e.node.gitUrl,refs:e.node.refs}),children:(0,n.jsx)(N.IconPencil,{})}),(0,n.jsx)(g.z,{size:"icon",variant:"hover-destructive",onClick:r=>W(e,(null==F?void 0:F.length)===1),children:(0,n.jsx)(N.IconTrash,{})})]})})]},e.node.id))]}):(0,n.jsx)(I.SC,{children:(0,n.jsx)(I.pj,{colSpan:5,className:"h-[100px] text-center hover:bg-background",children:(0,n.jsxs)("div",{className:"mt-4 flex flex-col items-center gap-4",children:[(0,n.jsx)("span",{children:"No repositories"}),(0,n.jsxs)(g.z,{onClick:e=>er(!0),className:"gap-1",children:[(0,n.jsx)(N.IconPlus,{}),"Add"]})]})})})})]}),(0,n.jsx)(k.ScrollBar,{orientation:"horizontal"})]}),(c>1||(null==U?void 0:U.hasNextPage))&&(0,n.jsxs)("div",{className:"mt-2 flex justify-end",children:[(0,n.jsxs)("div",{className:"flex w-[100px] items-center justify-center text-sm font-medium",children:[" ","Page ",c]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(g.z,{variant:"outline",className:"h-8 w-8 p-0",disabled:_||1===c,onClick:e=>{en(c-1)},children:(0,n.jsx)(N.IconChevronLeft,{className:"h-4 w-4"})}),(0,n.jsx)(g.z,{variant:"outline",className:"h-8 w-8 p-0",disabled:_||!(null==U?void 0:U.hasNextPage),onClick:e=>{en(c+1)},children:(0,n.jsx)(N.IconChevronRight,{className:"h-4 w-4"})})]})]})]}),(0,n.jsx)(b.Vq,{open:ee,onOpenChange:er,children:(0,n.jsxs)(b.cZ,{children:[(0,n.jsxs)(b.fK,{className:"gap-3",children:[(0,n.jsx)(b.$N,{children:"Add new repository"}),(0,n.jsx)(b.Be,{children:"Add new repository from this provider"})]}),(0,n.jsx)(Z,{onCancel:()=>er(!1),onCreated:e=>{let r=null==j?void 0:j.find(r=>{var t;return(null==r?void 0:null===(t=r.node)||void 0===t?void 0:t.id)===e});r&&(B([r,...O]),y(r=>et(r.filter(r=>r.node.id!==e))),K.run(c)),er(!1)},repositories:j,kind:l,providerStatus:a,fetchingRepos:!w})]})}),(0,n.jsx)(Q,{repo:M,open:!!M,onOpenChange:e=>{e||$(null)},onSubmit:e=>{M&&Y({id:M.id,refs:e.refs&&e.refs.length>0?e.refs:[]}).then(e=>{var r;(null==e?void 0:null===(r=e.data)||void 0===r?void 0:r.updateIntegratedRepositoryRefs)&&(o.A.success("Repository updated successfully"),$(null),X(c))})}})]})},J=c.Ry({refs:c.IX(c.Z_()).optional()});function Q(e){let{repo:r,open:t,onOpenChange:a,onSubmit:o}=e,d=(0,l.cI)({resolver:(0,i.F)(J)});s.useEffect(()=>{r&&d.reset({refs:r.refs})},[r,d]);let{isSubmitting:u}=d.formState;return(0,n.jsx)(b.Vq,{open:t,onOpenChange:a,children:(0,n.jsxs)(b.cZ,{className:"max-w-xl",children:[(0,n.jsxs)(b.fK,{children:[(0,n.jsx)(b.$N,{children:"Edit Repository"}),(0,n.jsx)(b.Be,{children:"Update the repository branches to index"})]}),(0,n.jsx)(y.l0,{...d,children:(0,n.jsxs)("form",{onSubmit:d.handleSubmit(o),className:"space-y-4",children:[(0,n.jsxs)(y.xJ,{children:[(0,n.jsx)(y.lX,{children:"Name"}),(0,n.jsx)(y.NI,{children:(0,n.jsx)(w.I,{value:null==r?void 0:r.displayName,disabled:!0,autoCapitalize:"none",autoCorrect:"off"})}),(0,n.jsx)(y.zG,{})]}),(0,n.jsxs)(y.xJ,{children:[(0,n.jsx)(y.lX,{children:"Git URL"}),(0,n.jsx)(y.pf,{children:"Remote or local Git URL"}),(0,n.jsx)(y.NI,{children:(0,n.jsx)(w.I,{value:null==r?void 0:r.gitUrl,disabled:!0,autoCapitalize:"none",autoCorrect:"off"})}),(0,n.jsx)(y.zG,{})]}),(0,n.jsx)(y.Wi,{control:d.control,name:"refs",render:e=>{let{field:r}=e;return(0,n.jsxs)(y.xJ,{children:[(0,n.jsx)(y.lX,{children:"Branches"}),(0,n.jsx)(y.pf,{children:"Branches to index (press Enter to select, leave empty for default branch)"}),(0,n.jsx)(y.NI,{children:(0,n.jsx)(S.E,{placeholder:"e.g. main",autoCapitalize:"none",autoCorrect:"off",...r})}),(0,n.jsx)(y.zG,{})]})}}),(0,n.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,n.jsx)(g.z,{type:"button",variant:"ghost",disabled:u,onClick:()=>a(!1),children:"Cancel"}),(0,n.jsx)(g.z,{type:"submit",disabled:u,children:"Update"})]})]})})]})})}var V=()=>{var e,r,t,s,i;let l=(0,a.useSearchParams)(),o=(0,P.A)(),c=(0,a.useRouter)(),f=null!==(i=null===(e=l.get("id"))||void 0===e?void 0:e.toString())&&void 0!==i?i:"",[{data:p,fetching:h},b]=(0,u.aM)({query:v.kb,variables:{ids:[f],kind:o},pause:!f||!o}),y=null==p?void 0:null===(s=p.integrations)||void 0===s?void 0:null===(t=s.edges)||void 0===t?void 0:null===(r=t[0])||void 0===r?void 0:r.node,w=(null==y?void 0:y.status)===m.Ij.Pending;return((0,d.ZP)(w?"refresh":null,()=>{b()},{revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateOnMount:!1,refreshInterval:5e3}),f&&(!f||h||y))?(0,n.jsxs)(C.Z,{loading:h,children:[(0,n.jsxs)(j.ll,{className:"flex items-center gap-4",children:[(0,n.jsxs)("div",{className:"-ml-2.5 flex items-center",children:[(0,n.jsx)(g.z,{onClick:()=>c.back(),variant:"ghost",className:"h-6 px-1",children:(0,n.jsx)(N.IconChevronLeft,{className:"h-5 w-5"})}),(0,n.jsx)("span",{className:"ml-1",children:null==y?void 0:y.displayName})]}),(0,n.jsx)("div",{className:"flex items-center gap-2 text-base",children:(0,n.jsx)("div",{className:"ml-1",children:y&&function(e){switch(e.status){case m.Ij.Ready:return(0,n.jsx)(x.C,{variant:"successful",children:"Ready"});case m.Ij.Failed:return(0,n.jsxs)(R.u,{delayDuration:0,children:[(0,n.jsx)(R.aJ,{children:(0,n.jsx)(x.C,{variant:"destructive",children:"Error"})}),(0,n.jsx)(R._v,{children:e.message?(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"mb-2",children:e.message}),"Please verify your context provider settings to resolve the issue"]}):(0,n.jsx)("p",{children:"Processing error. Please check if the access token is still valid"})})]});case m.Ij.Pending:return(0,n.jsx)(x.C,{children:"Pending"})}}(y)})})]}),(0,n.jsx)(j.aY,{className:"mt-8",children:(0,n.jsx)(C.Z,{loading:h,fallback:(0,n.jsx)(A.cg,{}),children:(0,n.jsx)(H,{defaultValues:y,onDelete:()=>{c.back()},onUpdate:()=>{b()},id:f,kind:o})})}),(0,n.jsxs)(k.ScrollArea,{children:[(0,n.jsx)(Y,{kind:o,providerStatus:null==y?void 0:y.status,providerId:f}),(0,n.jsx)(k.ScrollBar,{orientation:"horizontal"})]})]}):(0,n.jsx)("div",{className:"flex h-[250px] w-full items-center justify-center rounded-lg border",children:"Provider not found"})}},39231:function(e,r,t){"use strict";t.d(r,{A:function(){return i}});var n=t(11978),s=t(78613),a=t(11529);function i(){let e=(0,n.useParams)(),r=(0,s.Z)(a.K,r=>{var t;return r.name===(null===(t=e.kind)||void 0===t?void 0:t.toLowerCase())}),t=r>-1?a.K[r].enum:a.K[0].enum;return t}},40030:function(e,r,t){"use strict";t.d(r,{r:function(){return b}});var n=t(36164),s=t(3546),a=t(37671),i=t(2578),l=t(40055),o=t(43240),d=t(11634),u=t(70410),c=t(73492),f=t(31458),m=t(36065),p=t(81565),h=t(84942),v=t(3448),x=t(6230);let g=(0,o.BX)("\n  mutation grantSourceIdReadAccess($sourceId: String!, $userGroupId: ID!) {\n    grantSourceIdReadAccess(sourceId: $sourceId, userGroupId: $userGroupId)\n  }\n"),j=(0,o.BX)("\n  mutation revokeSourceIdReadAccess($sourceId: String!, $userGroupId: ID!) {\n    revokeSourceIdReadAccess(sourceId: $sourceId, userGroupId: $userGroupId)\n  }\n");function b(e){var r;let{sourceId:t,sourceName:o,className:b,editable:y,userGroups:N,fetchingUserGroups:w,...k}=e,[I,S]=(0,s.useState)(!1),[{data:R,fetching:C}]=(0,l.aM)({query:u.hA,variables:{sourceId:t}}),A=(0,d.Db)(g),G=(0,d.Db)(j),T=null==R?void 0:null===(r=R.sourceIdAccessPolicies)||void 0===r?void 0:r.read,z=(null==T?void 0:T.length)||0,P=(0,s.useMemo)(()=>(null==T?void 0:T.length)?new Set(T.map(e=>e.id)):new Set,[T]),_=(e,r,t)=>{t?D(e,r):E(e,r)},D=(e,r)=>{let n="Failed to grant ".concat(r);return A({sourceId:t,userGroupId:e},{extraParams:{userGroupName:r}}).then(e=>{var r,t;if(!(null==e?void 0:null===(r=e.data)||void 0===r?void 0:r.grantSourceIdReadAccess)){let r=(null==e?void 0:null===(t=e.error)||void 0===t?void 0:t.message)||n;i.A.error(r);return}}).catch(e=>{let r=(null==e?void 0:e.message)||n;i.A.error(r)})},E=(e,r)=>G({sourceId:t,userGroupId:e},{extraParams:{userGroupName:r}}).then(e=>{var t,n;if(!(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.revokeSourceIdReadAccess)){let t=(null==e?void 0:null===(n=e.error)||void 0===n?void 0:n.message)||"Failed to revoke '".concat(r,"'");i.A.error(t);return}}).catch(e=>{let t=(null==e?void 0:e.message)||"Failed to revoke '".concat(r,"'");i.A.error(t)}),q=0===z?"Everyone":"".concat(z," ").concat(z<=1?"group":"groups");return(0,n.jsx)(x.Z,{loading:C,fallback:(0,n.jsx)(v.O,{className:(0,c.cn)(b)}),children:(0,n.jsxs)("div",{className:(0,c.cn)("flex items-center gap-0.5",b),children:[(0,n.jsx)("span",{className:"w-[68px]",children:q}),y&&(0,n.jsxs)(h.J2,{open:I,onOpenChange:S,children:[(0,n.jsx)(h.xo,{asChild:!0,children:(0,n.jsx)(f.z,{variant:"ghost",role:"combobox",size:"icon",children:(0,n.jsx)(p.IconEdit,{})})}),(0,n.jsx)(h.yk,{align:"end",side:"top",children:(0,n.jsxs)(m.mY,{children:[(0,n.jsx)(m.sZ,{placeholder:"Search groups..."}),(0,n.jsxs)(m.e8,{className:"max-h-[30vh]",children:[(0,n.jsx)(m.rb,{children:w?(0,n.jsx)("div",{className:"flex justify-center",children:(0,n.jsx)(p.IconSpinner,{className:"h-6 w-6"})}):(null==N?void 0:N.length)?"No matches results":"No groups found"}),(0,n.jsx)(m.fu,{children:null==N?void 0:N.map(e=>{let r=P.has(e.id),t=e.members.length;return(0,n.jsxs)(m.di,{value:e.name,onSelect:()=>_(e.id,e.name,!r),children:[(0,n.jsx)("div",{className:(0,c.cn)("mr-2 flex h-4 w-4 cursor-pointer items-center justify-center rounded-sm border border-primary",r?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:(0,n.jsx)(a.nQG,{className:(0,c.cn)("h-4 w-4")})}),(0,n.jsxs)("span",{children:[e.name,(0,n.jsx)("span",{className:"ml-1 text-muted-foreground",children:"(".concat(t," member").concat(t>1?"s":"",")")})]})]},e.id)})})]})]})})]})]})})}},55137:function(e,r,t){"use strict";t.d(r,{_:function(){return v}});var n=t(36164),s=t(3546),a=t(70652),i=t.n(a),l=t(11978),o=t(99092),d=t.n(o),u=t(73492),c=t(31458),f=t(81565),m=t(29);function p(e){let{onTrigger:r,isPending:t,jobLink:a}=e,i=(0,l.useRouter)(),[o,d]=s.useState(!1);return(0,n.jsxs)(m.u,{children:[(0,n.jsx)(m.aJ,{asChild:!0,children:(0,n.jsx)(c.z,{size:"icon",variant:"ghost",onClick:()=>{if(t){a&&i.push(a);return}let e=r();return e&&e instanceof Promise&&(d(!0),e.finally(()=>d(!1))),e},disabled:o,children:o||t?(0,n.jsx)(f.IconSpinner,{}):(0,n.jsx)(f.IconCirclePlay,{strokeWidth:1,className:"h-5 w-5"})})}),(0,n.jsx)(m._v,{children:(0,n.jsx)("p",{children:"Run"})})]})}function h(e){let{jobInfo:r,className:t}=e;return(null==r?void 0:r.lastJobRun)?(0,n.jsx)(i(),{href:"/jobs/detail?id=".concat(r.lastJobRun.id),className:(0,u.cn)("flex items-center gap-1 underline hover:text-foreground/50",t),children:d()(r.lastJobRun.createdAt).format("YYYY-MM-DD HH:mm")}):null}function v(e){var r;let{jobInfo:t,onTrigger:s,className:a}=e,i=!!(null==t?void 0:t.lastJobRun)&&null===t.lastJobRun.exitCode,l=(null==t?void 0:null===(r=t.lastJobRun)||void 0===r?void 0:r.id)?"/jobs/detail?id=".concat(t.lastJobRun.id):void 0;return(0,n.jsxs)("div",{className:(0,u.cn)("flex items-center gap-1",a),children:[(0,n.jsx)(h,{jobInfo:t,className:"hidden lg:block lg:w-32"}),(0,n.jsx)(p,{onTrigger:s,isPending:i,jobLink:l})]})}},11529:function(e,r,t){"use strict";t.d(r,{K:function(){return s}});var n=t(18500);let s=[{name:"github",enum:n.q6.Github,meta:{displayName:"GitHub"}},{name:"github-self-hosted",enum:n.q6.GithubSelfHosted,meta:{displayName:"GitHub Self-Hosted"}},{name:"gitlab",enum:n.q6.Gitlab,meta:{displayName:"GitLab"}},{name:"gitlab-self-hosted",enum:n.q6.GitlabSelfHosted,meta:{displayName:"GitLab Self-Hosted"}}]},14522:function(e,r,t){"use strict";t.d(r,{C:function(){return s}});var n=t(43240);let s=(0,n.BX)("\n  mutation triggerJobRun($command: String!) {\n    triggerJobRun(command: $command)\n  }\n")},6230:function(e,r,t){"use strict";var n=t(36164),s=t(3546),a=t(24449),i=t(90379);r.Z=e=>{let{triggerOnce:r=!0,loading:t,fallback:l,delay:o,children:d}=e,[u,c]=s.useState(!t),[f]=(0,a.n)(u,null!=o?o:200);return(s.useEffect(()=>{r?t||u||c(!0):c(!t)},[t]),f)?d:l||(0,n.jsx)(i.cg,{})}},90379:function(e,r,t){"use strict";t.d(r,{PF:function(){return o},cg:function(){return i},tB:function(){return l}});var n=t(36164),s=t(73492),a=t(3448);let i=e=>{let{className:r,...t}=e;return(0,n.jsxs)("div",{className:(0,s.cn)("space-y-3",r),...t,children:[(0,n.jsx)(a.O,{className:"h-4 w-full"}),(0,n.jsx)(a.O,{className:"h-4 w-full"}),(0,n.jsx)(a.O,{className:"h-4 w-full"}),(0,n.jsx)(a.O,{className:"h-4 w-full"})]})},l=e=>{let{className:r,...t}=e;return(0,n.jsx)(a.O,{className:(0,s.cn)("h-4 w-full",r),...t})},o=e=>{let{className:r,...t}=e;return(0,n.jsxs)("div",{className:(0,s.cn)("flex flex-col gap-3",r),...t,children:[(0,n.jsx)(a.O,{className:"h-4 w-[20%]"}),(0,n.jsx)(a.O,{className:"h-4 w-full"}),(0,n.jsx)(a.O,{className:"h-4 w-[20%]"}),(0,n.jsx)(a.O,{className:"h-4 w-full"})]})}},73460:function(e,r,t){"use strict";t.d(r,{OL:function(){return x},_T:function(){return f},aR:function(){return o},f$:function(){return h},fY:function(){return m},le:function(){return g},vW:function(){return d},xo:function(){return p},yT:function(){return v}});var n=t(36164),s=t(3546),a=t(91460),i=t(73492),l=t(31458);let o=a.fC,d=a.xz,u=e=>{let{className:r,children:t,...s}=e;return(0,n.jsx)(a.h_,{className:(0,i.cn)(r),...s,children:(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-end justify-center sm:items-center",children:t})})};u.displayName=a.h_.displayName;let c=s.forwardRef((e,r)=>{let{className:t,children:s,...l}=e;return(0,n.jsx)(a.aV,{className:(0,i.cn)("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm transition-opacity animate-in fade-in",t),...l,ref:r})});c.displayName=a.aV.displayName;let f=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsxs)(u,{children:[(0,n.jsx)(c,{}),(0,n.jsx)(a.VY,{ref:r,className:(0,i.cn)("fixed z-50 grid w-full max-w-lg scale-100 gap-4 border bg-background p-6 opacity-100 shadow-lg animate-in fade-in-90 slide-in-from-bottom-10 sm:rounded-lg sm:zoom-in-90 sm:slide-in-from-bottom-0 md:w-full",t),...s})]})});f.displayName=a.VY.displayName;let m=e=>{let{className:r,...t}=e;return(0,n.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-2 text-center sm:text-left",r),...t})};m.displayName="AlertDialogHeader";let p=e=>{let{className:r,...t}=e;return(0,n.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",r),...t})};p.displayName="AlertDialogFooter";let h=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)(a.Dx,{ref:r,className:(0,i.cn)("text-lg font-semibold",t),...s})});h.displayName=a.Dx.displayName;let v=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)(a.dk,{ref:r,className:(0,i.cn)("text-sm text-muted-foreground",t),...s})});v.displayName=a.dk.displayName;let x=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)(a.aU,{ref:r,className:(0,i.cn)((0,l.d)(),t),...s})});x.displayName=a.aU.displayName;let g=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)(a.$j,{ref:r,className:(0,i.cn)((0,l.d)({variant:"outline"}),"mt-2 sm:mt-0",t),...s})});g.displayName=a.$j.displayName},63795:function(e,r,t){"use strict";t.d(r,{C:function(){return l}});var n=t(36164);t(3546);var s=t(98641),a=t(73492);let i=(0,s.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",successful:"border-transparent bg-successful text-successful-foreground hover:bg-successful/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:r,variant:t,...s}=e;return(0,n.jsx)("div",{className:(0,a.cn)(i({variant:t}),r),...s})}},31458:function(e,r,t){"use strict";t.d(r,{d:function(){return o},z:function(){return d}});var n=t(36164),s=t(3546),a=t(74047),i=t(98641),l=t(73492);let o=(0,i.j)("inline-flex items-center justify-center rounded-md text-sm font-medium shadow ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-md hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90","hover-destructive":"shadow-none hover:bg-destructive/90 hover:text-destructive-foreground",outline:"border border-input hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"shadow-none hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 shadow-none hover:underline"},size:{default:"h-8 px-4 py-2",sm:"h-8 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-8 w-8 p-0"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,r)=>{let{className:t,variant:s,size:i,asChild:d=!1,...u}=e,c=d?a.g7:"button";return(0,n.jsx)(c,{className:(0,l.cn)(o({variant:s,size:i,className:t})),ref:r,...u})});d.displayName="Button"},79972:function(e,r,t){"use strict";t.d(r,{Ol:function(){return l},Zb:function(){return i},aY:function(){return u},eW:function(){return c},ll:function(){return o}});var n=t(36164),s=t(3546),a=t(73492);let i=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("div",{ref:r,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s})});i.displayName="Card";let l=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("div",{ref:r,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",t),...s})});l.displayName="CardHeader";let o=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("h3",{ref:r,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",t),...s})});o.displayName="CardTitle";let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("p",{ref:r,className:(0,a.cn)("text-sm text-muted-foreground",t),...s})});d.displayName="CardDescription";let u=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("div",{ref:r,className:(0,a.cn)("p-6 pt-0",t),...s})});u.displayName="CardContent";let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("div",{ref:r,className:(0,a.cn)("flex items-center p-6 pt-0",t),...s})});c.displayName="CardFooter"},36065:function(e,r,t){"use strict";t.d(r,{di:function(){return p},e8:function(){return u},fu:function(){return f},mY:function(){return o},rb:function(){return c},sZ:function(){return d},zz:function(){return m}});var n=t(36164),s=t(3546),a=t(53241),i=t(93170),l=t(73492);t(30220);let o=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)(a.mY,{ref:r,className:(0,l.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",t),...s})});o.displayName=a.mY.displayName;let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,n.jsx)(i.Z,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,n.jsx)(a.mY.Input,{ref:r,className:(0,l.cn)("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t),...s})]})});d.displayName=a.mY.Input.displayName;let u=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)(a.mY.List,{ref:r,className:(0,l.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",t),...s})});u.displayName=a.mY.List.displayName;let c=s.forwardRef((e,r)=>(0,n.jsx)(a.mY.Empty,{ref:r,className:"py-6 text-center text-sm",...e}));c.displayName=a.mY.Empty.displayName;let f=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)(a.mY.Group,{ref:r,className:(0,l.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",t),...s})});f.displayName=a.mY.Group.displayName;let m=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)(a.mY.Separator,{ref:r,className:(0,l.cn)("-mx-1 h-px bg-border",t),...s})});m.displayName=a.mY.Separator.displayName;let p=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)(a.mY.Item,{ref:r,className:(0,l.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-disabled:pointer-events-none aria-disabled:opacity-50 aria-selected:bg-accent aria-selected:text-accent-foreground",t),...s})});p.displayName=a.mY.Item.displayName},30220:function(e,r,t){"use strict";t.d(r,{$N:function(){return h},Be:function(){return v},Vq:function(){return o},cN:function(){return p},cZ:function(){return f},fK:function(){return m},hg:function(){return d}});var n=t(36164),s=t(3546),a=t(4318),i=t(1663),l=t(73492);let o=a.fC,d=a.xz,u=a.h_;a.x8;let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)(a.aV,{ref:r,className:(0,l.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s})});c.displayName=a.aV.displayName;let f=s.forwardRef((e,r)=>{let{className:t,children:s,...o}=e;return(0,n.jsxs)(u,{children:[(0,n.jsx)(c,{}),(0,n.jsxs)(a.VY,{ref:r,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...o,children:[s,(0,n.jsxs)(a.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,n.jsx)(i.Z,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=a.VY.displayName;let m=e=>{let{className:r,...t}=e;return(0,n.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",r),...t})};m.displayName="DialogHeader";let p=e=>{let{className:r,...t}=e;return(0,n.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",r),...t})};p.displayName="DialogFooter";let h=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)(a.Dx,{ref:r,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",t),...s})});h.displayName=a.Dx.displayName;let v=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)(a.dk,{ref:r,className:(0,l.cn)("text-sm text-muted-foreground",t),...s})});v.displayName=a.dk.displayName},98150:function(e,r,t){"use strict";t.d(r,{NI:function(){return v},Wi:function(){return c},l0:function(){return d},lX:function(){return h},pf:function(){return x},xJ:function(){return p},zG:function(){return g}});var n=t(36164),s=t(3546),a=t(74047),i=t(5493),l=t(73492),o=t(5266);let d=i.RV,u=s.createContext({}),c=e=>{let{...r}=e;return(0,n.jsx)(u.Provider,{value:{name:r.name},children:(0,n.jsx)(i.Qr,{...r})})},f=()=>{let e=s.useContext(u),r=s.useContext(m),{getFieldState:t,formState:n}=(0,i.Gc)(),a=e.name||"root",l=t(a,n);if(!n)throw Error("useFormField should be used within <Form>");let{id:o}=r;return{id:o,name:a,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message"),...l}},m=s.createContext({}),p=s.forwardRef((e,r)=>{let{className:t,...a}=e,i=s.useId();return(0,n.jsx)(m.Provider,{value:{id:i},children:(0,n.jsx)("div",{ref:r,className:(0,l.cn)("space-y-2",t),...a})})});p.displayName="FormItem";let h=s.forwardRef((e,r)=>{let{className:t,required:s,...a}=e,{error:i,formItemId:d}=f();return(0,n.jsx)(o._,{ref:r,className:(0,l.cn)(i&&"text-destructive",s&&'after:ml-0.5 after:text-destructive after:content-["*"]',t),htmlFor:d,...a})});h.displayName="FormLabel";let v=s.forwardRef((e,r)=>{let{...t}=e,{error:s,formItemId:i,formDescriptionId:l,formMessageId:o}=f();return(0,n.jsx)(a.g7,{ref:r,id:i,"aria-describedby":s?"".concat(l," ").concat(o):"".concat(l),"aria-invalid":!!s,...t})});v.displayName="FormControl";let x=s.forwardRef((e,r)=>{let{className:t,...s}=e,{formDescriptionId:a}=f();return(0,n.jsx)("div",{ref:r,id:a,className:(0,l.cn)("text-sm text-muted-foreground",t),...s})});x.displayName="FormDescription";let g=s.forwardRef((e,r)=>{let{className:t,children:s,...a}=e,{error:i,formMessageId:o}=f(),d=i?String(null==i?void 0:i.message):s;return d?(0,n.jsx)("p",{ref:r,id:o,className:(0,l.cn)("text-sm font-medium text-destructive",t),...a,children:d}):null});g.displayName="FormMessage"},82394:function(e,r,t){"use strict";t.d(r,{I:function(){return i}});var n=t(36164),s=t(3546),a=t(73492);let i=s.forwardRef((e,r)=>{let{className:t,type:s,...i}=e;return(0,n.jsx)("input",{type:s,className:(0,a.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...i})});i.displayName="Input"},5266:function(e,r,t){"use strict";t.d(r,{_:function(){return d}});var n=t(36164),s=t(3546),a=t(90893),i=t(98641),l=t(73492);let o=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)(a.f,{ref:r,className:(0,l.cn)(o(),t),...s})});d.displayName=a.f.displayName},84942:function(e,r,t){"use strict";t.d(r,{J2:function(){return l},xo:function(){return o},yk:function(){return d}});var n=t(36164),s=t(3546),a=t(83299),i=t(73492);let l=a.fC,o=a.xz;a.x8,a.h_,a.ee;let d=s.forwardRef((e,r)=>{let{className:t,sideOffset:s=4,...l}=e;return(0,n.jsx)(a.VY,{ref:r,sideOffset:s,className:(0,i.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow animate-in data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...l})});d.displayName=a.VY.displayName},57830:function(e,r,t){"use strict";t.r(r),t.d(r,{ScrollArea:function(){return l},ScrollBar:function(){return o}});var n=t(36164),s=t(3546),a=t(86102),i=t(73492);let l=s.forwardRef((e,r)=>{let{className:t,children:s,...l}=e;return(0,n.jsxs)(a.fC,{className:(0,i.cn)("relative overflow-hidden",t),...l,children:[(0,n.jsx)(a.l_,{ref:r,className:"h-full w-full rounded-[inherit] [&>div]:!block",children:s}),(0,n.jsx)(o,{}),(0,n.jsx)(a.Ns,{})]})});l.displayName=a.fC.displayName;let o=s.forwardRef((e,r)=>{let{className:t,orientation:s="vertical",...l}=e;return(0,n.jsx)(a.gb,{ref:r,orientation:s,className:(0,i.cn)("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...l,children:(0,n.jsx)(a.q4,{className:"relative flex-1 rounded-full bg-border"})})});o.displayName=a.gb.displayName},3448:function(e,r,t){"use strict";t.d(r,{O:function(){return a}});var n=t(36164),s=t(73492);function a(e){let{className:r,...t}=e;return(0,n.jsx)("div",{className:(0,s.cn)("h-4 animate-pulse rounded-md bg-border",r),...t})}},99047:function(e,r,t){"use strict";t.d(r,{RM:function(){return o},SC:function(){return u},iA:function(){return i},pj:function(){return f},ss:function(){return c},xD:function(){return l}});var n=t(36164),s=t(3546),a=t(73492);let i=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("table",{ref:r,className:(0,a.cn)("w-full caption-bottom text-sm",t),...s})});i.displayName="Table";let l=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("thead",{ref:r,className:(0,a.cn)("[&_tr]:border-b",t),...s})});l.displayName="TableHeader";let o=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("tbody",{ref:r,className:(0,a.cn)("[&_tr:last-child]:border-0",t),...s})});o.displayName="TableBody";let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("tfoot",{ref:r,className:(0,a.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...s})});d.displayName="TableFooter";let u=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("tr",{ref:r,className:(0,a.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...s})});u.displayName="TableRow";let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("th",{ref:r,className:(0,a.cn)("h-12 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...s})});c.displayName="TableHead";let f=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("td",{ref:r,className:(0,a.cn)("p-2 align-middle [&:has([role=checkbox])]:pr-0",t),...s})});f.displayName="TableCell";let m=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("caption",{ref:r,className:(0,a.cn)("mt-4 text-sm text-muted-foreground",t),...s})});m.displayName="TableCaption"},83721:function(e,r,t){"use strict";t.d(r,{E:function(){return d}});var n=t(36164),s=t(3546),a=t(1663),i=t(73492),l=t(63795),o=t(31458);let d=s.forwardRef((e,r)=>{let{className:t,value:d=[],onChange:u,...c}=e,[f,m]=s.useState(""),p=e=>{null==u||u(d.filter(r=>r!==e))};return(0,n.jsxs)("div",{className:(0,i.cn)("flex min-h-[2.25rem] w-full flex-wrap items-center gap-2 rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm ring-offset-background focus-within:ring-2 focus-within:ring-ring focus-within:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),children:[d.map(e=>(0,n.jsxs)(l.C,{variant:"secondary",className:"gap-1 pr-1",children:[e,(0,n.jsxs)(o.z,{type:"button",variant:"ghost",size:"icon",className:"h-3 w-3 hover:bg-transparent",onClick:()=>p(e),children:[(0,n.jsx)(a.Z,{className:"h-3 w-3"}),(0,n.jsxs)("span",{className:"sr-only",children:["Remove ",e]})]})]},e)),(0,n.jsx)("input",{ref:r,type:"text",className:"flex-1 bg-transparent outline-none placeholder:text-muted-foreground",value:f,onChange:e=>m(e.target.value),onKeyDown:e=>{if("Enter"===e.key){e.preventDefault();let r=f.trim();r&&!d.includes(r)&&(null==u||u([...d,r]),m(""))}else"Backspace"===e.key&&!f&&d.length>0&&(null==u||u(d.slice(0,-1)))},...c})]})});d.displayName="TagInput"},29:function(e,r,t){"use strict";t.d(r,{_v:function(){return u},aJ:function(){return d},pn:function(){return l},u:function(){return o}});var n=t(36164),s=t(3546),a=t(44421),i=t(73492);let l=a.zt,o=a.fC,d=a.xz;a.h_;let u=s.forwardRef((e,r)=>{let{className:t,sideOffset:s=4,...l}=e;return(0,n.jsx)(a.VY,{ref:r,sideOffset:s,className:(0,i.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-xs font-medium text-popover-foreground shadow-md animate-in fade-in-50 data-[side=bottom]:slide-in-from-top-1 data-[side=left]:slide-in-from-right-1 data-[side=right]:slide-in-from-left-1 data-[side=top]:slide-in-from-bottom-1",t),...l})});u.displayName=a.VY.displayName},21808:function(e,r,t){"use strict";t.d(r,{$6:function(){return a},$I:function(){return i},GI:function(){return u},L8:function(){return s},ir:function(){return l},ki:function(){return d},o0:function(){return n},rZ:function(){return o}});let n="name@yourcompany.com",s=20,a={DEMO_AUTO_LOGIN:"_tabby_demo_autologin"},i=48,l="NOT_FOUND",o="\n",d=["think"],u=[]},24449:function(e,r,t){"use strict";t.d(r,{S:function(){return l},n:function(){return o}});var n=t(3546),s=t(45391),a=t(16784);let i=e=>{let r=(0,a.d)(e);n.useEffect(()=>()=>{r.current()},[])};function l(e,r,t){let l=(0,a.d)(e),o=n.useMemo(()=>(0,s.Z)(function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return l.current(...r)},r,t),[]);return i(()=>{var e;null==t||null===(e=t.onUnmount)||void 0===e||e.call(t,o),o.cancel()}),{run:o,cancel:o.cancel,flush:o.flush}}function o(e,r,t){let[s,a]=n.useState(e),{run:i}=l(()=>{a(e)},r,t);return n.useEffect(()=>{i()},[e]),[s,a]}},16784:function(e,r,t){"use strict";t.d(r,{d:function(){return s}});var n=t(3546);function s(e){let r=n.useRef(e);return r.current=e,r}},80605:function(e,r,t){"use strict";t.d(r,{UA:function(){return f},Uw:function(){return u},c7:function(){return d},jJ:function(){return c},o4:function(){return m},vN:function(){return l},xG:function(){return o}});var n=t(40055),s=t(43240);let a=(0,s.BX)("\n  query GetServerInfo {\n    serverInfo {\n      isAdminInitialized\n      isEmailConfigured\n      isChatEnabled\n      allowSelfSignup\n      isDemoMode\n      disablePasswordLogin\n    }\n  }\n"),i=()=>{let[{data:e}]=(0,n.aM)({query:a});return null==e?void 0:e.serverInfo},l=()=>{let[{fetching:e}]=(0,n.aM)({query:a});return e},o=()=>{var e;return null===(e=i())||void 0===e?void 0:e.isChatEnabled},d=()=>{var e;return null===(e=i())||void 0===e?void 0:e.isAdminInitialized},u=()=>{var e;return null===(e=i())||void 0===e?void 0:e.isEmailConfigured},c=()=>{var e;return null===(e=i())||void 0===e?void 0:e.allowSelfSignup},f=()=>{var e;return null===(e=i())||void 0===e?void 0:e.isDemoMode},m=()=>{var e;return null===(e=i())||void 0===e?void 0:e.disablePasswordLogin}},91302:function(e,r,t){"use strict";t.d(r,{Dp:function(){return v},Ho:function(){return g},QJ:function(){return N},av:function(){return I},kP:function(){return w},zq:function(){return y}});var n,s,a=t(36164),i=t(3546),l=t(11978),o=t(24426),d=t.n(o),u=t(43240),c=t(80605),f=t(11634),m=t(66794);function p(e,r){var t,n;let a=function(e,r){switch(r.type){case s.SignIn:case s.Refresh:return{status:"authenticated",data:r.data};case s.SignOut:return{status:"unauthenticated",data:void 0}}}(0,r);return e.status==a.status&&(t=e.data,n=a.data,(null==t?void 0:t.accessToken)===(null==n?void 0:n.accessToken)&&(null==t?void 0:t.refreshToken)===(null==n?void 0:n.refreshToken))?e:a}(n=s||(s={}))[n.SignIn=0]="SignIn",n[n.SignOut=1]="SignOut",n[n.Refresh=2]="Refresh";let h=i.createContext({}),v=(0,u.BX)("\n  mutation refreshToken($refreshToken: String!) {\n    refreshToken(refreshToken: $refreshToken) {\n      accessToken\n      refreshToken\n    }\n  }\n"),x=(0,u.BX)("\n  mutation LogoutAllSessions {\n    logoutAllSessions\n  }\n"),g=e=>{let{children:r}=e,[t,n]=i.useState(!1),[l]=d()(m.nd,void 0),[o,u]=i.useReducer(p,{status:"loading",data:void 0});i.useEffect(()=>{(null==l?void 0:l.accessToken)&&(null==l?void 0:l.refreshToken)?u({type:s.SignIn,data:l}):u({type:s.SignOut}),n(!0)},[]),i.useEffect(()=>{!t||((null==l?void 0:l.accessToken)&&(null==l?void 0:l.refreshToken)?u({type:s.Refresh,data:l}):(null==l?void 0:l.accessToken)||(null==l?void 0:l.refreshToken)||u({type:s.SignOut}))},[l]);let c=i.useMemo(()=>{var e;return(null==o?void 0:o.status)=="authenticated"?{data:{accessToken:o.data.accessToken},status:o.status}:{status:null!==(e=null==o?void 0:o.status)&&void 0!==e?e:"loading",data:null}},[o]);return(0,a.jsx)(h.Provider,{value:{authState:o,dispatch:u,session:c},children:r})};class j extends Error{constructor(){super("AuthProvider is missing. Please add the AuthProvider at root level")}}function b(){let e=i.useContext(h);if(!e)throw new j;return e}function y(){let{dispatch:e}=b(),[r,t]=d()(m.nd,void 0);return async r=>(t({accessToken:r.accessToken,refreshToken:r.refreshToken}),e({type:s.SignIn,data:r}),!0)}function N(){let e=(0,f.Db)(x),{dispatch:r}=b(),[t,n]=d()(m.nd,void 0);return async()=>{await e(),n(void 0),r({type:s.SignOut})}}function w(){let{session:e}=b();return e}let k=["/auth/signin","/auth/signup","/auth/reset-password"];function I(){let e=(0,c.c7)(),r=(0,l.useRouter)(),t=(0,l.usePathname)(),n=(0,l.useSearchParams)(),{data:s,status:a}=w();return i.useEffect(()=>{if("loading"===a||"authenticated"===a||void 0===e)return;let s="/auth/signup"===t&&"true"===n.get("isAdmin");if(!s&&!e)return r.replace("/auth/signup?isAdmin=true");k.includes(t)||r.replace("/auth/signin")},[e,a]),s}},11634:function(e,r,t){"use strict";t.d(r,{Db:function(){return p},Lp:function(){return v},zG:function(){return h}});var n=t(22365),s=t(28552),a=t(81013),i=t(17522),l=t(79716),o=t(74630),d=t(40055),u=t(44745),c=t(91302),f=t(70410),m=t(66794);function p(e,r){let[t,n]=(0,d.Db)(e),s=(null==r?void 0:r.form)?h(r.form):void 0,a=async(e,t)=>{let a;try{if(null==(a=await n(e,t))?void 0:a.error)s&&s(a.error),(null==r?void 0:r.onError)&&r.onError(a.error);else if(!(0,o.Z)(null==a?void 0:a.data)){var i;null==r||null===(i=r.onCompleted)||void 0===i||i.call(r,a.data)}}catch(e){(null==r?void 0:r.onError)&&r.onError(e);return}return a};return a}function h(e){return r=>{let{graphQLErrors:t=[]}=r;for(let r of t)if(r.extensions&&r.extensions["validation-errors"]){let t=r.extensions["validation-errors"];for(let r of t.errors)e.setError(r.path,r)}else(null==r?void 0:r.originalError)?e.setError("root",r.originalError):(null==r?void 0:r.message)&&e.setError("root",{message:r.message})}}let v=new u.KU({url:"/graphql",requestPolicy:"cache-and-network",exchanges:[(0,s.HG)({keys:{CompletionStats:()=>null,ServerInfo:()=>null,RepositorySearch:()=>null,RepositoryList:()=>null,RepositoryGrep:()=>null,GrepLine:()=>null,GrepFile:()=>null,GrepTextOrBase64:()=>null,GrepSubMatch:()=>null,GitReference:()=>null,MessageAttachment:()=>null,MessageAttachmentCode:()=>null,MessageAttachmentDoc:()=>null,NetworkSetting:()=>null,ContextInfo:()=>null,PageCreated:()=>null,PageContentCompleted:()=>null,PageSectionsCreated:()=>null,PageSectionContentCompleted:()=>null,PageSectionAttachmentCode:()=>null,PageSectionAttachmentDoc:()=>null,SectionAttachment:()=>null,PageSectionCreated:()=>null,BrandingSetting:()=>"BrandingSetting"},resolvers:{Query:{invitations:(0,a.N)(),gitRepositories:(0,a.N)(),webCrawlerUrls:(0,a.N)(),integrations:(0,a.N)(),threads:(0,a.N)(),myThreads:(0,a.N)()}},updates:{Mutation:{deleteInvitation(e,r,t,n){e.deleteInvitation&&t.inspectFields("Query").filter(e=>"invitations"===e.fieldName).forEach(e=>{t.updateQuery({query:f.lE,variables:e.arguments},e=>{var t;return(null==e?void 0:null===(t=e.invitations)||void 0===t?void 0:t.edges)&&(e.invitations.edges=e.invitations.edges.filter(e=>e.node.id!==r.id)),e})})},deleteGitRepository(e,r,t,n){e.deleteGitRepository&&t.inspectFields("Query").filter(e=>"gitRepositories"===e.fieldName).forEach(e=>{t.updateQuery({query:f.S1,variables:e.arguments},e=>{var t;return(null==e?void 0:null===(t=e.gitRepositories)||void 0===t?void 0:t.edges)&&(e.gitRepositories.edges=e.gitRepositories.edges.filter(e=>e.node.id!==r.id)),e})})},deleteIntegration(e,r,t,n){e.deleteIntegration&&t.inspectFields("Query").filter(e=>"integrations"===e.fieldName).forEach(e=>{t.updateQuery({query:f.kb,variables:e.arguments},e=>((null==e?void 0:e.integrations)&&(e.integrations.edges=e.integrations.edges.filter(e=>e.node.id!==r.id)),e))})},createIntegration(e,r,t){let n="Query";t.inspectFields(n).filter(e=>{var t,n,s;return"integrations"===e.fieldName&&!!(null===(t=e.arguments)||void 0===t?void 0:t.kind)&&(null===(n=e.arguments)||void 0===n?void 0:n.kind)===(null==r?void 0:null===(s=r.input)||void 0===s?void 0:s.kind)}).forEach(e=>{t.invalidate(n,e.fieldName,e.arguments)})},upsertUserGroupMembership(e,r,t,n){let{userGroupId:s,userId:a,isGroupAdmin:i}=r.input,{user:l,isInsert:o}=n.variables.extraParams||{};e.upsertUserGroupMembership&&t.updateQuery({query:f.gI},e=>((null==e?void 0:e.userGroups)&&(e.userGroups=e.userGroups.map(e=>{if(e.id!==s)return e;let r=[...e.members];if(o){let e=new Date().toISOString();r.push({user:{...l,__typename:"UserSecured"},isGroupAdmin:i,createdAt:e,updatedAt:e,__typename:"UserGroupMembership"})}else r=r.map(e=>e.user.id!==a?e:{...e,isGroupAdmin:i});return{...e,members:r}})),e))},deleteUserGroupMembership(e,r,t,n){let{userGroupId:s,userId:a}=r;e.deleteUserGroupMembership&&t.updateQuery({query:f.gI},e=>((null==e?void 0:e.userGroups)&&(e.userGroups=e.userGroups.map(e=>{if(e.id!==s)return e;let r=[...e.members].filter(e=>e.user.id!==a);return{...e,members:r}})),e))},grantSourceIdReadAccess(e,r,t,n){if(e.grantSourceIdReadAccess){let{sourceId:e}=r;t.inspectFields("Query").filter(r=>{var t;return"sourceIdAccessPolicies"===r.fieldName&&(null===(t=r.arguments)||void 0===t?void 0:t.sourceId)===e}).forEach(e=>{t.updateQuery({query:f.hA,variables:e.arguments},e=>{var t;if(null==e?void 0:null===(t=e.sourceIdAccessPolicies)||void 0===t?void 0:t.read){let{userGroupName:t}=n.variables.extraParams||{};e.sourceIdAccessPolicies.read=[...e.sourceIdAccessPolicies.read,{__typename:"UserGroup",id:r.userGroupId,name:t}]}return e})})}},revokeSourceIdReadAccess(e,r,t,n){if(e.revokeSourceIdReadAccess){let{userGroupId:e,sourceId:n}=r;t.inspectFields("Query").filter(e=>{var r;return"sourceIdAccessPolicies"===e.fieldName&&(null===(r=e.arguments)||void 0===r?void 0:r.sourceId)===n}).forEach(r=>{t.updateQuery({query:f.hA,variables:r.arguments},r=>{var t,s;return(null==r?void 0:null===(t=r.sourceIdAccessPolicies)||void 0===t?void 0:t.sourceId)===n&&(null==r?void 0:null===(s=r.sourceIdAccessPolicies)||void 0===s?void 0:s.read)&&(r.sourceIdAccessPolicies.read=r.sourceIdAccessPolicies.read.filter(r=>r.id!==e)),r})})}},deleteThread(e,r,t,n){e.deleteThread&&(t.inspectFields("Query").filter(e=>{var r;return"threads"===e.fieldName&&!(null===(r=e.arguments)||void 0===r?void 0:r.ids)}).forEach(e=>{t.updateQuery({query:f.XL,variables:e.arguments},e=>((null==e?void 0:e.threads)&&(e.threads.edges=e.threads.edges.filter(e=>e.node.id!==r.id)),e))}),t.inspectFields("Query").filter(e=>"myThreads"===e.fieldName).forEach(e=>{t.updateQuery({query:f.rm,variables:e.arguments},e=>((null==e?void 0:e.myThreads)&&(e.myThreads.edges=e.myThreads.edges.filter(e=>e.node.id!==r.id)),e))}))},setThreadPersisted(e,r,t,n){if(e.setThreadPersisted){let e="Query";t.inspectFields(e).filter(e=>{var r,t;return"threads"===e.fieldName&&!(null===(r=e.arguments)||void 0===r?void 0:r.ids)&&!!(null===(t=e.arguments)||void 0===t?void 0:t.before)}).forEach(r=>{t.invalidate(e,r.fieldName,r.arguments)})}},markNotificationsRead(e,r,t){e.markNotificationsRead&&t.inspectFields("Query").filter(e=>"notifications"===e.fieldName).forEach(e=>{t.updateQuery({query:f.g0,variables:e.arguments},e=>{if(null==e?void 0:e.notifications){let t=!r.notificationId;e.notifications=e.notifications.map(e=>t?{...e,read:!0}:e.id===r.notificationId?{...e,read:!0}:e)}return e})})},deletePageSection(e,r,t){e.deletePageSection&&t.inspectFields("Query").filter(e=>"pageSections"===e.fieldName).forEach(e=>{t.updateQuery({query:f.bP,variables:e.arguments},e=>((null==e?void 0:e.pageSections)&&(e.pageSections.edges=e.pageSections.edges.filter(e=>e.node.id!==r.id)),e))})},updateBrandingSetting(e,r,t){e.updateBrandingSetting&&t.invalidate({__typename:"BrandingSetting"})}}},optimistic:{upsertUserGroupMembership:()=>!0,deleteUserGroupMembership:()=>!0,grantSourceIdReadAccess:()=>!0,revokeSourceIdReadAccess:()=>!0}}),(0,n.M)(async e=>{let r=(0,m.bW)(),t=null==r?void 0:r.accessToken,n=null==r?void 0:r.refreshToken;return{addAuthToOperation(r){let s=(0,m.bW)(),a=(0,m.jW)();if(t=null==s?void 0:s.accessToken,n=null==s?void 0:s.refreshToken,t)return e.appendHeaders(r,{Authorization:"Bearer ".concat(t)});if(a){let t={Authorization:"Bearer ".concat(a.authorization),...a.headers};return e.appendHeaders(r,t)}return r},didAuthError(e,r){let t=e.graphQLErrors.some(e=>{var r;return(null==e?void 0:null===(r=e.extensions)||void 0===r?void 0:r.code)==="UNAUTHORIZED"});return t&&m.gN.clearAccessToken(),t},willAuthError(e){let r=(0,m.bW)(),s=(0,m.jW)();if(t=null==r?void 0:r.accessToken,n=null==r?void 0:r.refreshToken,"query"===e.kind&&e.query.definitions.some(e=>{var r;return"OperationDefinition"===e.kind&&(null===(r=e.name)||void 0===r?void 0:r.value)&&["GetServerInfo"].includes(e.name.value)})||"mutation"===e.kind&&e.query.definitions.some(e=>{var r;return"OperationDefinition"===e.kind&&(null===(r=e.name)||void 0===r?void 0:r.value)&&["tokenAuth","register"].includes(e.name.value)})||n&&"mutation"===e.kind&&e.query.definitions.some(e=>{var r;return"OperationDefinition"===e.kind&&(null==e?void 0:null===(r=e.name)||void 0===r?void 0:r.value)==="refreshToken"}))return!1;if(t)try{let{exp:e}=(0,l.o)(t);return(0,m.pw)(e)}catch(e){return!0}else if(s)return!(null==s?void 0:s.authorization);else return m.gN.clearAccessToken(),!0},refreshAuth:async()=>m.gN.refreshToken(async()=>{var r;let t=null===(r=(0,m.bW)())||void 0===r?void 0:r.refreshToken;if(t)return e.mutate(c.Dp,{refreshToken:t}).then(e=>{var r;return null==e?void 0:null===(r=e.data)||void 0===r?void 0:r.refreshToken})})}}),(0,u.Dk)({onError(e){e.message.startsWith("[GraphQL]")&&(e.message=e.message.replace("[GraphQL]","").trim())}}),u.Ek,(0,u.pV)({forwardSubscription(e,r){var t,n,s;let a=null!==(s=null===(n=r.context.fetchOptions)||void 0===n?void 0:null===(t=n.headers)||void 0===t?void 0:t.Authorization)&&void 0!==s?s:"",l=window.location.protocol,o=window.location.host,d=(0,i.eI)({url:"".concat("https:"===l?"wss:":"ws:","//").concat(o,"/subscriptions"),connectionParams:{authorization:a}}),u={...e,query:e.query||""};return{subscribe(e){let r=d.subscribe(u,e);return{unsubscribe:r}}}}})]})},66794:function(e,r,t){"use strict";t.d(r,{bW:function(){return o},gN:function(){return h},jW:function(){return m},nd:function(){return i},pw:function(){return c},zr:function(){return p}});var n=t(79716),s=t(74630),a=t(73492);let i="_tabby_auth",l="_tabby_chat_sdk_fetcher_options",o=()=>{if((0,a.S_)()){let e=localStorage.getItem(i);if(e)try{return JSON.parse(e)}catch(e){}}},d=e=>{localStorage.setItem(i,JSON.stringify(e))},u=()=>{localStorage.removeItem(i),window.dispatchEvent(new StorageEvent("storage",{storageArea:window.localStorage,url:window.location.href,key:i}))},c=e=>!!(0,s.Z)(e)||Date.now()>1e3*e,f=e=>!(0,s.Z)(e)&&Date.now()-1e3*e<6e4,m=()=>{try{let e=sessionStorage.getItem(l);if(!e)return;return JSON.parse(e)}catch(e){return}},p=e=>{if(e)try{sessionStorage.setItem(l,JSON.stringify(e))}catch(e){sessionStorage.removeItem(l)}},h=new class{clearAccessToken(){let e=o();e&&d({...e,accessToken:""})}async refreshToken(e){try{var r;if(void 0===(null===(r=navigator)||void 0===r?void 0:r.locks))throw console.error("The Web Locks API is not supported in your browser. Please upgrade to a newer browser version."),Error();await navigator.locks.request("_tabby_auth_lock",async()=>{let r;let t=o(),s=null==t?void 0:t.accessToken,a=null==t?void 0:t.refreshToken;if(s){let{iat:a}=(0,n.o)(s);r=f(a)?t:await e()}else a&&(r=await e());r?d(r):u()})}catch(e){u()}}}},54491:function(e,r,t){"use strict";function n(e,[r,t]){return Math.min(t,Math.max(r,e))}t.d(r,{u:function(){return n}})},78613:function(e,r,t){"use strict";t.d(r,{Z:function(){return d}});var n=t(96703),s=t(51722),a=t(26165),i=1/0,l=function(e){var r,t=(r=e)?(r=(0,a.Z)(r))===i||r===-i?(r<0?-1:1)*17976931348623157e292:r==r?r:0:0===r?r:0,n=t%1;return t==t?n?t-n:t:0},o=Math.max,d=function(e,r,t){var a=null==e?0:e.length;if(!a)return -1;var i=null==t?0:l(t);return i<0&&(i=o(a+i,0)),(0,n.Z)(e,(0,s.Z)(r,3),i)}},94909:function(e,r,t){"use strict";var n=t(63563),s=t(43108),a=t(97589),i=t(38813),l=t(20568),o=t(90328),d=t(36586),u=t(33321),c=Object.prototype.hasOwnProperty;r.Z=function(e){if(null==e)return!0;if((0,l.Z)(e)&&((0,i.Z)(e)||"string"==typeof e||"function"==typeof e.splice||(0,o.Z)(e)||(0,u.Z)(e)||(0,a.Z)(e)))return!e.length;var r=(0,s.Z)(e);if("[object Map]"==r||"[object Set]"==r)return!e.size;if((0,d.Z)(e))return!(0,n.Z)(e).length;for(var t in e)if(c.call(e,t))return!1;return!0}}},function(e){e.O(0,[7565,8415,4691,55,436,340,9906,4007,1283,3087,2429,8511,240,1454,3179,4421,7070,1002,1460,6805,6065,3492,1565,410,3375,5289,1744],function(){return e(e.s=87690)}),_N_E=e.O()}]);