(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{6435:function(e,t,n){"use strict";n.d(t,{F:function(){return l},f:function(){return d}});var r=n(2265);let o=["light","dark"],i="(prefers-color-scheme: dark)",s="undefined"==typeof window,a=(0,r.createContext)(void 0),u={setTheme:e=>{},themes:[]},l=()=>{var e;return null!==(e=(0,r.useContext)(a))&&void 0!==e?e:u},d=e=>(0,r.useContext)(a)?r.createElement(r.Fragment,null,e.children):r.createElement(f,e),c=["light","dark"],f=({forcedTheme:e,disableTransitionOnChange:t=!1,enableSystem:n=!0,enableColorScheme:s=!0,storageKey:u="theme",themes:l=c,defaultTheme:d=n?"system":"light",attribute:f="data-theme",value:p,children:y,nonce:b})=>{let[k,$]=(0,r.useState)(()=>v(u,d)),[S,T]=(0,r.useState)(()=>v(u)),E=p?Object.values(p):l,x=(0,r.useCallback)(e=>{let r=e;if(!r)return;"system"===e&&n&&(r=g());let i=p?p[r]:r,a=t?h():null,u=document.documentElement;if("class"===f?(u.classList.remove(...E),i&&u.classList.add(i)):i?u.setAttribute(f,i):u.removeAttribute(f),s){let e=o.includes(d)?d:null,t=o.includes(r)?r:e;u.style.colorScheme=t}null==a||a()},[]),w=(0,r.useCallback)(e=>{$(e);try{localStorage.setItem(u,e)}catch(e){}},[e]),_=(0,r.useCallback)(t=>{let r=g(t);T(r),"system"===k&&n&&!e&&x("system")},[k,e]);(0,r.useEffect)(()=>{let e=window.matchMedia(i);return e.addListener(_),_(e),()=>e.removeListener(_)},[_]),(0,r.useEffect)(()=>{let e=e=>{e.key===u&&w(e.newValue||d)};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[w]),(0,r.useEffect)(()=>{x(null!=e?e:k)},[e,k]);let I=(0,r.useMemo)(()=>({theme:k,setTheme:w,forcedTheme:e,resolvedTheme:"system"===k?S:k,themes:n?[...l,"system"]:l,systemTheme:n?S:void 0}),[k,w,e,S,n,l]);return r.createElement(a.Provider,{value:I},r.createElement(m,{forcedTheme:e,disableTransitionOnChange:t,enableSystem:n,enableColorScheme:s,storageKey:u,themes:l,defaultTheme:d,attribute:f,value:p,children:y,attrs:E,nonce:b}),y)},m=(0,r.memo)(({forcedTheme:e,storageKey:t,attribute:n,enableSystem:s,enableColorScheme:a,defaultTheme:u,value:l,attrs:d,nonce:c})=>{let f="system"===u,m="class"===n?`var d=document.documentElement,c=d.classList;c.remove(${d.map(e=>`'${e}'`).join(",")});`:`var d=document.documentElement,n='${n}',s='setAttribute';`,v=a?o.includes(u)&&u?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${u}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",h=(e,t=!1,r=!0)=>{let i=l?l[e]:e,s=t?e+"|| ''":`'${i}'`,u="";return a&&r&&!t&&o.includes(e)&&(u+=`d.style.colorScheme = '${e}';`),"class"===n?u+=t||i?`c.add(${s})`:"null":i&&(u+=`d[s](n,${s})`),u},g=e?`!function(){${m}${h(e)}}()`:s?`!function(){try{${m}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${f})){var t='${i}',m=window.matchMedia(t);if(m.media!==t||m.matches){${h("dark")}}else{${h("light")}}}else if(e){${l?`var x=${JSON.stringify(l)};`:""}${h(l?"x[e]":"e",!0)}}${f?"":"else{"+h(u,!1,!1)+"}"}${v}}catch(e){}}()`:`!function(){try{${m}var e=localStorage.getItem('${t}');if(e){${l?`var x=${JSON.stringify(l)};`:""}${h(l?"x[e]":"e",!0)}}else{${h(u,!1,!1)};}${v}}catch(t){}}();`;return r.createElement("script",{nonce:c,dangerouslySetInnerHTML:{__html:g}})},()=>!0),v=(e,t)=>{let n;if(!s){try{n=localStorage.getItem(e)||void 0}catch(e){}return n||t}},h=()=>{let e=document.createElement("style");return e.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(e),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(e)},1)}},g=e=>(e||(e=window.matchMedia(i)),e.matches?"dark":"light")},65559:function(e,t,n){Promise.resolve().then(n.t.bind(n,58877,23)),Promise.resolve().then(n.bind(n,78495)),Promise.resolve().then(n.bind(n,42761)),Promise.resolve().then(n.t.bind(n,6928,23)),Promise.resolve().then(n.t.bind(n,33195,23))},78495:function(e,t,n){"use strict";n.r(t),n.d(t,{Providers:function(){return l}});var r=n(57437);n(2265);var o=n(6435),i=n(99109),s=n(58001),a=n(7820),u=n(95482);function l(e){let{children:t,...n}=e;return(0,r.jsx)(o.f,{...n,children:(0,r.jsx)(i.zt,{value:a.Lp,children:(0,r.jsx)(u.pn,{children:(0,r.jsxs)(s.Ho,{children:[(0,r.jsx)(d,{}),t]})})})})}function d(){return(0,s.av)(),(0,r.jsx)(r.Fragment,{})}},42761:function(e,t,n){"use strict";n.r(t),n.d(t,{Toaster:function(){return s}});var r=n(57437),o=n(6435),i=n(71424);let s=e=>{let{...t}=e,{theme:n="system"}=(0,o.F)();return(0,r.jsx)(i.x,{theme:n,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})}},95482:function(e,t,n){"use strict";n.d(t,{_v:function(){return d},aJ:function(){return l},pn:function(){return a},u:function(){return u}});var r=n(57437),o=n(2265),i=n(98567),s=n(39311);let a=i.zt,u=i.fC,l=i.xz,d=o.forwardRef((e,t)=>{let{className:n,sideOffset:o=4,...a}=e;return(0,r.jsx)(i.VY,{ref:t,sideOffset:o,className:(0,s.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-xs font-medium text-popover-foreground shadow-md animate-in fade-in-50 data-[side=bottom]:slide-in-from-top-1 data-[side=left]:slide-in-from-right-1 data-[side=right]:slide-in-from-left-1 data-[side=top]:slide-in-from-bottom-1",n),...a})});d.displayName=i.VY.displayName},58001:function(e,t,n){"use strict";n.d(t,{Dp:function(){return k},Ho:function(){return $},QJ:function(){return x},Rn:function(){return p},av:function(){return C},bW:function(){return h},kP:function(){return w},pC:function(){return g},zq:function(){return E}});var r,o,i=n(57437),s=n(2265),a=n(24033),u=n(53771),l=n(99109),d=n(26566),c=n.n(d),f=n(58835),m=n(39311);(r=o||(o={}))[r.SignIn=0]="SignIn",r[r.SignOut=1]="SignOut",r[r.Refresh=2]="Refresh";let v="_tabby_auth",h=()=>{if((0,m.S_)()){let e=localStorage.getItem(v);if(e)try{return JSON.parse(e)}catch(e){}}},g=e=>{localStorage.setItem(v,JSON.stringify(e))},p=()=>{localStorage.removeItem(v),window.dispatchEvent(new StorageEvent("storage",{storageArea:window.localStorage,url:window.location.href,key:v}))};function y(e,t){var n,r;let i=function(e,t){switch(t.type){case o.SignIn:case o.Refresh:return{status:"authenticated",data:t.data};case o.SignOut:return{status:"unauthenticated",data:void 0}}}(0,t);return e.status==i.status&&(n=e.data,r=i.data,(null==n?void 0:n.accessToken)===(null==r?void 0:r.accessToken)&&(null==n?void 0:n.refreshToken)===(null==r?void 0:r.refreshToken))?e:i}let b=s.createContext({}),k=(0,f.BX)("\n  mutation refreshToken($refreshToken: String!) {\n    refreshToken(refreshToken: $refreshToken) {\n      accessToken\n      refreshToken\n    }\n  }\n"),$=e=>{let{children:t}=e,n=s.useRef(!1),[r]=c()(v,void 0),[a,l]=s.useReducer(y,{status:"loading",data:void 0});s.useEffect(()=>{n.current=!0,(null==r?void 0:r.accessToken)&&(null==r?void 0:r.refreshToken)?l({type:o.SignIn,data:r}):l({type:o.SignOut})},[]),s.useEffect(()=>{n.current&&((null==r?void 0:r.accessToken)&&(null==r?void 0:r.refreshToken)?l({type:o.SignIn,data:r}):l({type:o.SignOut}))},[r]);let d=s.useMemo(()=>{var e,t;if((null==a?void 0:a.status)=="authenticated")try{let{sub:e,is_admin:t}=(0,u.o)(a.data.accessToken);return{data:{email:e,isAdmin:t,accessToken:a.data.accessToken},status:a.status}}catch(t){return console.error("jwt decode failed"),{status:null!==(e=null==a?void 0:a.status)&&void 0!==e?e:"loading",data:{email:"",isAdmin:!1,accessToken:a.data.accessToken}}}return{status:null!==(t=null==a?void 0:a.status)&&void 0!==t?t:"loading",data:null}},[a]);return(0,i.jsx)(b.Provider,{value:{authState:a,dispatch:l,session:d},children:t})};class S extends Error{constructor(){super("AuthProvider is missing. Please add the AuthProvider at root level")}}function T(){let e=s.useContext(b);if(!e)throw new S;return e}function E(){let{dispatch:e}=T(),[t,n]=c()(v,void 0);return async t=>(n({accessToken:t.accessToken,refreshToken:t.refreshToken}),e({type:o.SignIn,data:t}),!0)}function x(){let{dispatch:e}=T(),[t,n]=c()(v,void 0);return async()=>{n(void 0),e({type:o.SignOut})}}function w(){let{session:e}=T();return e}let _=(0,f.BX)("\n  query GetIsAdminInitialized {\n    isAdminInitialized\n  }\n"),I=["/auth/signin","/auth/signup"];function C(){let[{data:e}]=(0,l.aM)({query:_}),t=(0,a.useRouter)(),n=(0,a.usePathname)(),{data:r,status:o}=w();return s.useEffect(()=>{"loading"!==o&&("authenticated"===o||((null==e?void 0:e.isAdminInitialized)===!1?t.replace("/auth/signup?isAdmin=true"):I.includes(n)||t.replace("/auth/signin")))},[e,o]),r}},7820:function(e,t,n){"use strict";n.d(t,{Db:function(){return m},Lp:function(){return g},io:function(){return v}});var r=n(2265),o=n(69166),i=n(73997),s=n(83074),a=n(53771),u=n(24144),l=n(99109),d=n(18398),c=n(58001),f=n(57166);function m(e,t){var n;let[r,o]=(0,l.Db)(e),i=(null==t?void 0:t.form)?(n=t.form,e=>{let{graphQLErrors:t=[]}=e;for(let e of t)if(e.extensions&&e.extensions["validation-errors"]){let t=e.extensions["validation-errors"];for(let e of t.errors)n.setError(e.path,e)}else(null==e?void 0:e.originalError)&&n.setError("root",e.originalError)}):void 0,s=async e=>{let n;try{if(null==(n=await o(e))?void 0:n.error)i&&i(n.error),(null==t?void 0:t.onError)&&t.onError(n.error);else if(!(0,u.Z)(null==n?void 0:n.data)){var r;null==t||null===(r=t.onCompleted)||void 0===r||r.call(t,n.data)}}catch(e){(null==t?void 0:t.onError)&&t.onError(e);return}return n};return s}function v(e){let{data:t,error:n,stale:o}=e,i=(e,t)=>!(0,u.Z)(e)||!(0,u.Z)(t),[s,a]=(0,r.useState)(i(t,n)&&!!o);return(0,r.useEffect)(()=>{!s&&i(t,n)&&a(!0)},[t,n]),[s,a]}let h=e=>Date.now()>1e3*e,g=new d.KU({url:"/graphql",requestPolicy:"cache-and-network",exchanges:[(0,i.HG)({resolvers:{Query:{invitations:(0,s.N)(),repositories:(0,s.N)(),jobRuns:(0,s.N)()}},updates:{Mutation:{deleteInvitation(e,t,n,r){e.deleteInvitation&&n.inspectFields("Query").filter(e=>"invitations"===e.fieldName).forEach(e=>{n.updateQuery({query:f.lE,variables:e.arguments},e=>{var n;return(null==e?void 0:null===(n=e.invitations)||void 0===n?void 0:n.edges)&&(e.invitations.edges=e.invitations.edges.filter(e=>e.node.id!==t.id)),e})})},deleteRepository(e,t,n,r){e.deleteRepository&&n.inspectFields("Query").filter(e=>"repositories"===e.fieldName).forEach(e=>{n.updateQuery({query:f.S1,variables:e.arguments},e=>{var n;return(null==e?void 0:null===(n=e.repositories)||void 0===n?void 0:n.edges)&&(e.repositories.edges=e.repositories.edges.filter(e=>e.node.id!==t.id)),e})})}}}}),(0,o.M)(async e=>{let t=(0,c.bW)(),n=null==t?void 0:t.accessToken,r=null==t?void 0:t.refreshToken;return{addAuthToOperation:t=>n?e.appendHeaders(t,{Authorization:"Bearer ".concat(n)}):t,didAuthError(e,t){var n;return(null==e?void 0:null===(n=e.response)||void 0===n?void 0:n.status)===401||e.graphQLErrors.some(e=>{var t;return(null==e?void 0:null===(t=e.extensions)||void 0===t?void 0:t.code)==="UNAUTHORIZED"})},willAuthError(e){let t=(0,c.bW)();if(n=null==t?void 0:t.accessToken,r=null==t?void 0:t.refreshToken,"mutation"===e.kind&&e.query.definitions.some(e=>{var t;return"OperationDefinition"===e.kind&&(null===(t=e.name)||void 0===t?void 0:t.value)&&["tokenAuth","registerUser"].includes(e.name.value)})||r&&"mutation"===e.kind&&e.query.definitions.some(e=>{var t;return"OperationDefinition"===e.kind&&(null==e?void 0:null===(t=e.name)||void 0===t?void 0:t.value)==="refreshToken"}))return!1;if(!n)return!0;try{let{exp:e}=(0,a.o)(n);return!e||h(e)}catch(e){return!0}},async refreshAuth(){if(r){var t;let o=await e.mutate(c.Dp,{refreshToken:r});(null===(t=o.data)||void 0===t?void 0:t.refreshToken)?(n=o.data.refreshToken.accessToken,r=o.data.refreshToken.refreshToken,(0,c.pC)({accessToken:n,refreshToken:r})):(0,c.Rn)()}else(0,c.Rn)()}}}),d.Ek]})},57166:function(e,t,n){"use strict";n.d(t,{GG:function(){return s},S1:function(){return i},lE:function(){return o}});var r=n(58835);let o=(0,r.BX)("\n  query ListInvitations(\n    $after: String\n    $before: String\n    $first: Int\n    $last: Int\n  ) {\n    invitations(after: $after, before: $before, first: $first, last: $last) {\n      edges {\n        node {\n          id\n          email\n          code\n          createdAt\n        }\n        cursor\n      }\n      pageInfo {\n        hasNextPage\n        hasPreviousPage\n        startCursor\n        endCursor\n      }\n    }\n  }\n"),i=(0,r.BX)("\n  query repositories($after: String, $before: String, $first: Int, $last: Int) {\n    repositories(after: $after, before: $before, first: $first, last: $last) {\n      edges {\n        node {\n          id\n          name\n          gitUrl\n        }\n        cursor\n      }\n      pageInfo {\n        hasNextPage\n        hasPreviousPage\n        startCursor\n        endCursor\n      }\n    }\n  }\n"),s=(0,r.BX)("\n  query ListJobRuns(\n    $ids: [ID!]\n    $after: String\n    $before: String\n    $first: Int\n    $last: Int\n  ) {\n    jobRuns(\n      ids: $ids\n      after: $after\n      before: $before\n      first: $first\n      last: $last\n    ) {\n      edges {\n        node {\n          id\n          job\n          createdAt\n          finishedAt\n          exitCode\n          stdout\n          stderr\n        }\n        cursor\n      }\n      pageInfo {\n        hasNextPage\n        hasPreviousPage\n        startCursor\n        endCursor\n      }\n    }\n  }\n")},58877:function(){},6928:function(e){e.exports={style:{fontFamily:"'__Inter_aaf875', '__Inter_Fallback_aaf875'",fontStyle:"normal"},className:"__className_aaf875",variable:"__variable_aaf875"}},33195:function(e){e.exports={style:{fontFamily:"'__JetBrains_Mono_2c91d1', '__JetBrains_Mono_Fallback_2c91d1'",fontStyle:"normal"},className:"__className_2c91d1",variable:"__variable_2c91d1"}},20966:function(e,t,n){"use strict";n.d(t,{M:function(){return u}});var r,o=n(2265),i=n(51030);let s=(r||(r=n.t(o,2)))["useId".toString()]||(()=>void 0),a=0;function u(e){let[t,n]=o.useState(s());return(0,i.b)(()=>{e||n(e=>null!=e?e:String(a++))},[e]),e||(t?`radix-${t}`:"")}},12488:function(e,t,n){"use strict";n.d(t,{e:function(){return i}});var r=n(2265),o=n(16459);function i(e,t=null==globalThis?void 0:globalThis.document){let n=(0,o.W)(e);(0,r.useEffect)(()=>{let e=e=>{"Escape"===e.key&&n(e)};return t.addEventListener("keydown",e),()=>t.removeEventListener("keydown",e)},[n,t])}}},function(e){e.O(0,[1091,584,1424,3072,9518,7070,8567,4402,2971,7864,1744],function(){return e(e.s=65559)}),_N_E=e.O()}]);