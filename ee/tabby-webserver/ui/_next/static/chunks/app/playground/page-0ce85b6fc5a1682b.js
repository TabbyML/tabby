(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2383],{11293:function(e,t,a){Promise.resolve().then(a.bind(a,96928))},96928:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return D}});var s=a(36164),n=a(3546),r=a(24449),l=a(44645),i=a(25647),o=a(74248),c=a(17451);c.a.getState;let d=c.a.setState,u=e=>{d(()=>({activeChatId:e}))},h=(e,t)=>{let a=null!=e?e:(0,o.x0)();d(e=>({activeChatId:a,chats:[{id:a,title:null!=t?t:"",messages:[],createdAt:new Date,userId:"",path:""},...e.chats||[]]}))},f=e=>{d(t=>{var a;return{activeChatId:(0,o.x0)(),chats:null===(a=t.chats)||void 0===a?void 0:a.filter(t=>t.id!==e)}})},x=()=>{d(()=>({activeChatId:(0,o.x0)(),chats:[]}))},m=(e,t)=>{d(a=>{var s;return{chats:null===(s=a.chats)||void 0===s?void 0:s.map(a=>a.id===e?{...a,messages:t}:a)}})},p=(e,t)=>{d(a=>{var s;return{chats:null===(s=a.chats)||void 0===s?void 0:s.map(a=>a.id===e?{...a,...t}:a)}})},v=(e,t)=>{if(Array.isArray(e)&&t)return e.find(e=>e.id===t)};var g=a(3765),j=a(57830),b=a(36613),y=a(30601),N=a(6230),w=a(90379),C=a(31458),k=a(81565),S=a(11208),_=a(29);let I=e=>{let{onClear:t,onClick:a,onBlur:r,...l}=e,[i,o]=n.useState(!1),c=()=>{o(!1)};return(0,s.jsx)(C.z,{className:"h-12 w-full justify-start",variant:"ghost",...l,onClick:e=>{i?(t(),o(!1)):o(!0),null==a||a(e)},onBlur:e=>{i&&c(),null==r||r(e)},children:i?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(k.IconCheck,{}),(0,s.jsx)("span",{className:"ml-2",children:"Confirm Clear Chats"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(k.IconTrash,{}),(0,s.jsx)("span",{className:"ml-2",children:"Clear Chats"})]})})};var E=a(30220),z=a(82394);let H=e=>{let{children:t,initialValue:a,chatId:r}=e,[l,i]=n.useState(!1),o=n.useRef(null),[c,d]=n.useState(a),u=async e=>{e.preventDefault(),(null==c?void 0:c.trim())&&(p(r,{title:c}),i(!1))};return(0,s.jsxs)(E.Vq,{open:l,onOpenChange:i,children:[(0,s.jsxs)(_.u,{children:[(0,s.jsx)(_.aJ,{asChild:!0,children:(0,s.jsxs)(C.z,{variant:"ghost",size:"icon",onClick:()=>i(!0),children:[(0,s.jsx)(k.IconEdit,{}),(0,s.jsx)("span",{className:"sr-only",children:"Edit"})]})}),(0,s.jsx)(_._v,{side:"bottom",children:"Edit"})]}),(0,s.jsx)(E.cZ,{className:"bg-background",children:(0,s.jsxs)(E.fK,{className:"gap-3",children:[(0,s.jsx)(E.$N,{children:"Set Chat Title"}),(0,s.jsx)(E.Be,{asChild:!0,children:(0,s.jsxs)("form",{className:"relative",onSubmit:u,ref:o,children:[(0,s.jsx)(z.I,{className:"h-10 pr-12",value:c,onChange:e=>d(e.target.value),onKeyDown:e=>{if("Enter"===e.key){var t;null===(t=o.current)||void 0===t||t.requestSubmit(),e.preventDefault()}}}),(0,s.jsx)("div",{className:"absolute right-2 top-1",children:(0,s.jsxs)(_.u,{children:[(0,s.jsx)(_.aJ,{asChild:!0,children:(0,s.jsxs)(C.z,{type:"submit",size:"icon",disabled:""===c,children:[(0,s.jsx)(k.IconArrowElbow,{}),(0,s.jsx)("span",{className:"sr-only",children:"Send message"})]})}),(0,s.jsx)(_._v,{children:"Edit Title"})]})})]})})]})})]})},R=e=>{let{className:t,style:a}=e,n=(0,i.o)(c.a,e=>e._hasHydrated),r=(0,i.o)(c.a,e=>e.chats),l=(0,i.o)(c.a,e=>e.activeChatId),d=(e,t)=>{f(t)};return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:t,children:(0,s.jsxs)("div",{className:"flex w-[279px] flex-col gap-2 transition-all",style:a,children:[(0,s.jsx)("div",{className:"shrink-0 pb-0 pl-3 pt-2",children:(0,s.jsxs)(C.z,{className:"h-12 w-full justify-start",variant:"ghost",onClick:e=>{u((0,o.x0)())},children:[(0,s.jsx)(k.IconPlus,{}),(0,s.jsx)("span",{className:"ml-2",children:"New Chat"})]})}),(0,s.jsx)(S.Z,{}),(0,s.jsx)(j.ScrollArea,{className:"flex flex-col gap-2 px-3",children:n?(0,s.jsx)(s.Fragment,{children:null==r?void 0:r.map(e=>{let t=l===e.id;return(0,s.jsxs)("div",{onClick:t=>u(e.id),className:(0,o.cn)("my-2 flex w-[254px] cursor-pointer items-center justify-between gap-3 rounded-lg px-3 py-1 text-sm transition-all hover:bg-primary/10",t&&"bg-primary/10"),children:[(0,s.jsx)("span",{className:"truncate leading-8",children:e.title||"(Untitled)"}),t&&(0,s.jsxs)("div",{className:"flex items-center",onClick:e=>e.stopPropagation(),children:[(0,s.jsx)(H,{initialValue:e.title,chatId:e.id}),(0,s.jsxs)(_.u,{children:[(0,s.jsx)(_.aJ,{asChild:!0,children:(0,s.jsxs)(C.z,{variant:"ghost",size:"icon",onClick:t=>d(t,e.id),children:[(0,s.jsx)(k.IconTrash,{}),(0,s.jsx)("span",{className:"sr-only",children:"Delete"})]})}),(0,s.jsx)(_._v,{side:"bottom",children:"Delete"})]})]})]},e.id)})}):(0,s.jsx)(w.cg,{})}),(0,s.jsx)(S.Z,{}),(0,s.jsx)("div",{className:"shrink-0 pb-2",children:(0,s.jsx)(I,{disabled:(null==r?void 0:r.length)===0,onClear:()=>{x()}})})]})})})},U=[];function D(){var e,t;let{searchParams:a,updateUrlComponents:d}=(0,l.Z)(),u=null===(e=a.get("initialMessage"))||void 0===e?void 0:e.toString(),f=n.useRef(!!u),x=n.useRef(null),p=n.useRef(null),[C]=(0,y.Hb)(),k=(0,i.o)(c.a,e=>e._hasHydrated),S=(0,i.o)(c.a,e=>e.activeChatId),_=(0,i.o)(c.a,e=>e.chats),I=v(_,S),E=n.useMemo(()=>{var e;return null==I?void 0:null===(e=I.messages)||void 0===e?void 0:e.filter(e=>!!e.user)},[S]);n.useEffect(()=>{let e=async e=>{if(e.origin!==window.origin||!e.data||!x.current||x.current.isLoading)return;let{data:t}=e;if("sendUserChat"===t.action){x.current.sendUserChat({...t.payload});return}"stop"===t.action&&x.current.stop()};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[]);let z=(0,r.S)((e,t)=>{if(!I&&(null==t?void 0:t.length)){var a,s;h(S,(0,o.aF)(null==t?void 0:null===(s=t[0])||void 0===s?void 0:null===(a=s.user)||void 0===a?void 0:a.message))}else I&&m(e,t)},500,{onUnmount(e){e.flush()},leading:!0}),H=C?{height:"calc(100vh - ".concat(y.wt,")")}:{height:"100vh"};return(0,s.jsxs)("div",{className:"grid flex-1 overflow-hidden lg:grid-cols-[280px_1fr]",children:[(0,s.jsx)(R,{className:"hidden w-[280px] border-r lg:block",style:H}),(0,s.jsx)(N.Z,{delay:0,loading:!k||!S,fallback:(0,s.jsx)("div",{className:"mx-auto w-full max-w-2xl pt-4 md:pt-10",children:(0,s.jsx)(w.cg,{})}),children:(0,s.jsx)(j.ScrollArea,{className:"transition-all",style:H,ref:p,children:(0,s.jsx)("div",{children:(0,s.jsx)(b.e,{welcomeMessage:"Welcome to Playground!",chatId:S,initialMessages:null!=E?E:U,ref:x,container:(null==p?void 0:null===(t=p.current)||void 0===t?void 0:t.children[1])||void 0,onThreadUpdates:e=>{S&&z.run(S,e)},onNavigateToContext:e=>{if(!e.filepath)return;let t=new URL("".concat(window.location.origin,"/files")),a=new URLSearchParams;a.append("redirect_filepath",e.filepath),a.append("redirect_git_url",e.git_url),t.search=a.toString();let s=(0,o.nO)(e.range);s&&(t.hash=s),window.open(t.toString())},onLoaded:()=>{var e;f.current&&(null===(e=x.current)||void 0===e?void 0:e.sendUserChat)&&S&&u&&(x.current.sendUserChat({message:u}).then(()=>{d({searchParams:{del:"initialMessage"}})}),f.current=!1)},fetcher:(e,t)=>(0,g.Z)(e,{...t,responseFormatter:e=>e,errorHandler(e){throw Error(e?String(e.status):"Fail to fetch")}}),promptFormClassname:"absolute"},S)})})})]})}},30601:function(e,t,a){"use strict";a.d(t,{Hb:function(){return f},wt:function(){return d},xc:function(){return x},yo:function(){return h}});var s=a(36164),n=a(3546),r=a(74630),l=a(36327),i=a(80605),o=a(74248),c=a(81565);let d="3.5rem",u=n.createContext({}),h=e=>{let{children:t}=e,a=(0,i.UA)(),[l,o]=n.useState(!1);return n.useEffect(()=>{let e=window.self!==window.top;e||(0,r.Z)(a)||o(a)},[a]),(0,s.jsx)(u.Provider,{value:{isShowDemoBanner:l,setIsShowDemoBanner:o},children:t})};function f(){let{isShowDemoBanner:e,setIsShowDemoBanner:t}=n.useContext(u);return[e,t]}function x(){let[e,t]=f(),{data:a}=(0,l.Z)("https://api.github.com/repos/TabbyML/tabby",e=>fetch(e).then(e=>e.json()));return(0,s.jsxs)("div",{className:(0,o.cn)("flex items-center justify-between bg-primary px-4 text-primary-foreground transition-all md:px-5",{"opacity-100 pointer-events-auto":e,"opacity-0 pointer-events-none":!e}),style:e?{height:d}:{height:0},children:[(0,s.jsxs)("a",{href:"https://links.tabbyml.com/schedule-a-demo",target:"_blank",className:"flex items-center gap-x-2 text-xs font-semibold underline md:text-sm",children:[(0,s.jsx)("span",{children:"\uD83D\uDCC6"}),(0,s.jsx)("span",{children:"Book a 30-minute product demo."})]}),(0,s.jsxs)("div",{className:"flex items-center gap-x-4 md:gap-x-8",children:[(0,s.jsxs)("a",{href:"https://github.com/TabbyML/tabby",target:"_blank",className:"flex items-center transition-all hover:opacity-70",children:[(0,s.jsx)(c.IconGithub,{}),(0,s.jsxs)("div",{className:"ml-2 hidden md:block",children:[(0,s.jsx)("p",{className:"text-xs font-semibold",children:"TabbyML/tabby"}),(0,s.jsxs)("div",{className:(0,o.cn)("flex items-center text-xs transition-all",{"h-4 opacity-70":a,"h-0 opacity-0":!a}),children:[(0,s.jsx)(c.IconStar,{className:"mr-1 h-2.5 w-2.5"}),(0,s.jsx)("span",{children:null==a?void 0:a.stargazers_count}),(0,s.jsx)(c.IconGitFork,{className:"ml-2 mr-1 h-2.5 w-2.5"}),(0,s.jsx)("span",{children:null==a?void 0:a.forks_count})]})]})]}),(0,s.jsx)(c.IconClose,{className:"cursor-pointer transition-all hover:opacity-70",onClick:()=>t(!1)})]})]})}},6230:function(e,t,a){"use strict";var s=a(36164),n=a(3546),r=a(24449),l=a(90379);t.Z=e=>{let{loading:t,fallback:a,delay:i,children:o}=e,[c,d]=n.useState(!t),[u]=(0,r.n)(c,null!=i?i:200);return(n.useEffect(()=>{t||c||d(!0)},[t]),u)?o:a||(0,s.jsx)(l.cg,{})}},30220:function(e,t,a){"use strict";a.d(t,{$N:function(){return m},Be:function(){return p},Vq:function(){return o},cN:function(){return x},cZ:function(){return h},fK:function(){return f},hg:function(){return c}});var s=a(36164),n=a(3546),r=a(4318),l=a(1663),i=a(74248);let o=r.fC,c=r.xz,d=r.h_;r.x8;let u=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(r.aV,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...n})});u.displayName=r.aV.displayName;let h=n.forwardRef((e,t)=>{let{className:a,children:n,...o}=e;return(0,s.jsxs)(d,{children:[(0,s.jsx)(u,{}),(0,s.jsxs)(r.VY,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...o,children:[n,(0,s.jsxs)(r.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(l.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});h.displayName=r.VY.displayName;let f=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};f.displayName="DialogHeader";let x=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};x.displayName="DialogFooter";let m=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(r.Dx,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",a),...n})});m.displayName=r.Dx.displayName;let p=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(r.dk,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...n})});p.displayName=r.dk.displayName},57830:function(e,t,a){"use strict";a.r(t),a.d(t,{ScrollArea:function(){return i},ScrollBar:function(){return o}});var s=a(36164),n=a(3546),r=a(50778),l=a(74248);let i=n.forwardRef((e,t)=>{let{className:a,children:n,...i}=e;return(0,s.jsxs)(r.fC,{ref:t,className:(0,l.cn)("relative overflow-hidden",a),...i,children:[(0,s.jsx)(r.l_,{className:"h-full w-full rounded-[inherit] [&>div]:!block",children:n}),(0,s.jsx)(o,{}),(0,s.jsx)(r.Ns,{})]})});i.displayName=r.fC.displayName;let o=n.forwardRef((e,t)=>{let{className:a,orientation:n="vertical",...i}=e;return(0,s.jsx)(r.gb,{ref:t,orientation:n,className:(0,l.cn)("flex touch-none select-none transition-colors","vertical"===n&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===n&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...i,children:(0,s.jsx)(r.q4,{className:"relative flex-1 rounded-full bg-border"})})});o.displayName=r.gb.displayName},38785:function(e,t,a){"use strict";a.d(t,{U:function(){return r}});var s=a(3546);let n=!0;function r(){let[e,t]=s.useState(()=>!n);return s.useEffect(function(){n=!1,t(!0)},[]),e}},44645:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var s=a(3546),n=a(11978);function r(){let e=(0,n.usePathname)(),t=(0,n.useRouter)(),a=(0,n.useSearchParams)(),r=(0,s.useCallback)(e=>{let t=new URLSearchParams(a);e&&Object.entries(e).forEach(e=>{let[a,s]=e;return t.set(a,s)});let s=t.toString();return s.length>0?"?".concat(s):""},[a]),l=(0,s.useCallback)(s=>{let n=function(e,t,a){var s,n;let r=null===(s=a.searchParams)||void 0===s?void 0:s.set,l=null===(n=a.searchParams)||void 0===n?void 0:n.del,i=new URLSearchParams(t);r&&Object.entries(r).forEach(e=>{let[t,a]=e;return i.set(t,a)}),l&&(Array.isArray(l)?l.forEach(e=>i.delete(e)):i.delete(l));let o=i.toString(),c=e;return o.length>0&&(c+="?".concat(o)),a.hash&&(c+="#".concat(a.hash.replace(/^#/,""))),c}((null==s?void 0:s.pathname)||e,a,s);s.replace?t.replace(n):t.push(n)},[e,a]);return{pathname:e,router:t,searchParams:a,getQueryString:r,updateUrlComponents:l}}},25647:function(e,t,a){"use strict";a.d(t,{o:function(){return r}});var s=a(3546),n=a(38785);let r=(e,t)=>{let a=(0,n.U)(),r=e(e=>null==e?void 0:e._hasHydrated),l=e(t),[i,o]=s.useState(a&&r?l:void 0);return s.useEffect(()=>{o(l)},[l]),i}},17451:function(e,t,a){"use strict";a.d(t,{a:function(){return o}});var s=a(27257),n=a(85654),r=a(74248);let l=["_hasHydrated","setHasHydrated","activeChatId"],i={_hasHydrated:!1,chats:void 0,activeChatId:(0,r.x0)()},o=(0,s.Ue)()((0,n.tJ)(e=>({...i,setHasHydrated:t=>{e({_hasHydrated:t})}}),{name:"tabby-chat-storage",partialize:e=>Object.fromEntries(Object.entries(e).filter(e=>{let[t]=e;return!l.includes(t)})),onRehydrateStorage:()=>e=>{e&&e.setHasHydrated(!0)}}))}},function(e){e.O(0,[7998,5498,1058,530,7980,259,2578,816,1492,4421,7590,1454,5621,4546,8746,9275,4373,4318,778,5606,6193,4294,3126,9736,1565,6597,7517,3375,5289,1744],function(){return e(e.s=11293)}),_N_E=e.O()}]);