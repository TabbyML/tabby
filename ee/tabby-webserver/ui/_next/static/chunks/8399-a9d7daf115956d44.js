"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8399],{18399:function(e,r,t){t.d(r,{ZP:function(){return G}});var n=t(36164),a=t(3546),l=t(11978),s=t(84381),i=t(94909),o=t(5493),d=t(2578),c=t(40055),u=t(23782),m=t(43240),f=t(18500),x=t(11634),p=t(74248),h=t(73460),j=t(31458),v=t(98150),N=t(81565),y=t(82394),g=t(5266),b=t(70772);let C=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)(b.fC,{className:(0,p.cn)("grid gap-2",t),...a,ref:r})});C.displayName=b.fC.displayName;let w=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)(b.ck,{ref:r,className:(0,p.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:(0,n.jsx)(b.z$,{className:"flex items-center justify-center",children:(0,n.jsx)(N.IconCircle,{className:"h-2.5 w-2.5 fill-current text-current"})})})});w.displayName=b.ck.displayName;var I=t(48537),_=t(94770),k=t(20325);let R=(0,m.BX)("\n  mutation updateOauthCredential($input: UpdateOAuthCredentialInput!) {\n    updateOauthCredential(input: $input)\n  }\n"),z=(0,m.BX)("\n  mutation deleteOauthCredential($provider: OAuthProvider!) {\n    deleteOauthCredential(provider: $provider)\n  }\n"),O=(0,m.BX)("\n  query OAuthCallbackUrl($provider: OAuthProvider!) {\n    oauthCallbackUrl(provider: $provider)\n  }\n"),F=u.Ry({clientId:u.Z_(),clientSecret:u.Z_().optional(),provider:u.jb(f.O4)});function G(e){let{className:r,isNew:t,provider:u,defaultValues:m,onSuccess:b,...G}=e,S=(0,l.useRouter)(),D=(0,c.m8)(),T=a.useMemo(()=>({...m||{},provider:u}),[]),[$,U]=a.useState(!1),[V,q]=a.useState(!1),P=(0,o.cI)({resolver:(0,s.F)(F),defaultValues:T}),X=P.watch("provider"),J=!(0,i.Z)(P.formState.dirtyFields),{isSubmitting:L}=P.formState,M=()=>{S.replace("/settings/sso")},W=(0,x.D)(R,{onCompleted(e){(null==e?void 0:e.updateOauthCredential)&&(null==b||b(P.getValues()))},form:P}),E=(0,x.D)(z),Y=async e=>{if(t){let r=await D.query(k.oauthCredential,{provider:e.provider}).then(e=>{var r;return!!(null==e?void 0:null===(r=e.data)||void 0===r?void 0:r.oauthCredential)});if(r){P.setError("provider",{message:"Provider already exists. Please choose another one"});return}}W({input:e})},[{data:B}]=(0,c.aM)({query:O,variables:{provider:X}}),Z=a.useMemo(()=>t?"e.g. e363c08d7e9ca4e66e723a53f38a21f6a54c1b83":Array(36).fill("*").join(""),[t]);return(0,n.jsx)(v.l0,{...P,children:(0,n.jsxs)("div",{className:(0,p.cn)("grid gap-2",r),...G,children:[(0,n.jsxs)("form",{className:"grid gap-6",onSubmit:P.handleSubmit(Y),children:[(0,n.jsx)(A,{className:"mt-2",children:"Basic information"}),(0,n.jsxs)(v.xJ,{children:[(0,n.jsx)(g._,{children:"Type"}),(0,n.jsx)(C,{defaultValue:"oauth",children:(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(w,{value:"oauth",id:"type_oauth"}),(0,n.jsx)(g._,{className:"cursor-pointer",htmlFor:"type_oauth",children:"OAuth 2.0"})]})})]}),(0,n.jsx)(v.Wi,{control:P.control,name:"provider",render:e=>{let{field:{onChange:r,...a}}=e;return(0,n.jsxs)(v.xJ,{children:[(0,n.jsx)(v.lX,{children:"Provider"}),(0,n.jsx)(v.NI,{children:(0,n.jsxs)(C,{className:"flex gap-8",orientation:"horizontal",onValueChange:r,...a,children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(w,{value:f.O4.Github,id:"r_github",disabled:!t}),(0,n.jsxs)(g._,{className:"flex cursor-pointer items-center gap-2",htmlFor:"r_github",children:[(0,n.jsx)(N.IconGitHub,{className:"h-5 w-5"}),"GitHub"]})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(w,{value:f.O4.Google,id:"r_google",disabled:!t}),(0,n.jsxs)(g._,{className:"flex cursor-pointer items-center gap-2",htmlFor:"r_google",children:[(0,n.jsx)(N.IconGoogle,{className:"h-5 w-5"}),"Google"]})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(w,{value:f.O4.Gitlab,id:"r_gitlab",disabled:!t}),(0,n.jsxs)(g._,{className:"flex cursor-pointer items-center gap-2",htmlFor:"r_gitlab",children:[(0,n.jsx)(N.IconGitLab,{className:"h-5 w-5"}),"GitLab"]})]})]})}),(0,n.jsx)(v.zG,{})]})}}),B&&(0,n.jsx)(v.xJ,{className:"mt-4",children:(0,n.jsxs)("div",{className:"flex flex-col gap-2 rounded-lg border px-3 py-2",children:[(0,n.jsx)("div",{className:"text-sm text-muted-foreground",children:"Create your OAuth2 application with the following information"}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("div",{className:"text-sm font-medium",children:"Authorization callback URL"}),(0,n.jsxs)("span",{className:"flex items-center text-sm",children:[B.oauthCallbackUrl,(0,n.jsx)(I.q,{type:"button",value:B.oauthCallbackUrl})]})]})]})}),(0,n.jsxs)("div",{children:[(0,n.jsx)(A,{children:"OAuth provider information"}),(0,n.jsx)(v.pf,{children:"The information is provided by your identity provider."})]}),(0,n.jsx)(v.Wi,{control:P.control,name:"clientId",render:e=>{let{field:r}=e;return(0,n.jsxs)(v.xJ,{children:[(0,n.jsx)(v.lX,{required:!0,children:"Client ID"}),(0,n.jsx)(v.NI,{children:(0,n.jsx)(y.I,{placeholder:"e.g. ae1542c44b154c10c859",autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",...r})}),(0,n.jsx)(v.zG,{})]})}}),(0,n.jsx)(v.Wi,{control:P.control,name:"clientSecret",render:e=>{let{field:r}=e;return(0,n.jsxs)(v.xJ,{children:[(0,n.jsx)(v.lX,{required:t,children:"Client Secret"}),(0,n.jsx)(v.NI,{children:(0,n.jsx)(y.I,{className:(0,p.cn)({"placeholder:translate-y-[10%] !placeholder-foreground":!t}),placeholder:Z,autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",type:"password",...r})}),(0,n.jsx)(v.zG,{})]})}}),(0,n.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,n.jsx)(j.z,{type:"button",variant:"ghost",onClick:M,children:"Cancel"}),!t&&(0,n.jsxs)(h.aR,{open:$,onOpenChange:U,children:[(0,n.jsx)(h.vW,{asChild:!0,children:(0,n.jsx)(j.z,{variant:"hover-destructive",children:"Delete"})}),(0,n.jsxs)(h._T,{children:[(0,n.jsxs)(h.fY,{children:[(0,n.jsx)(h.f$,{children:"Are you absolutely sure?"}),(0,n.jsx)(h.yT,{children:"This action cannot be undone. It will permanently delete the current credential."})]}),(0,n.jsxs)(h.xo,{children:[(0,n.jsx)(h.le,{children:"Cancel"}),(0,n.jsxs)(h.OL,{className:(0,j.d)({variant:"destructive"}),onClick:e=>{e.preventDefault(),q(!0),E({provider:X}).then(e=>{var r,t;(null==e?void 0:null===(r=e.data)||void 0===r?void 0:r.deleteOauthCredential)?M():(q(!1),(null==e?void 0:e.error)&&d.A.error(null==e?void 0:null===(t=e.error)||void 0===t?void 0:t.message))})},children:[V&&(0,n.jsx)(N.IconSpinner,{className:"mr-2 h-4 w-4 animate-spin"}),"Yes, delete it"]})]})]})]}),(0,n.jsx)(_.M,{licenses:[f.oj.Enterprise],children:e=>{let{hasValidLicense:r}=e;return(0,n.jsxs)(j.z,{type:"submit",disabled:!r||L||!t&&!J,children:[L&&(0,n.jsx)(N.IconSpinner,{className:"mr-2 h-4 w-4 animate-spin"}),t?"Create":"Update"]})}})]})]}),(0,n.jsx)(v.zG,{className:"text-center"})]})})}function A(e){let{className:r,...t}=e;return(0,n.jsx)("div",{className:(0,p.cn)("mt-4 text-xl font-semibold",r),...t})}},48537:function(e,r,t){t.d(r,{q:function(){return i}});var n=t(36164);t(3546);var a=t(28312),l=t(31458),s=t(81565);function i(e){let{className:r,value:t,onCopyContent:i,text:o,...d}=e,{isCopied:c,copyToClipboard:u}=(0,a.m)({timeout:2e3,onCopyContent:i});return t?(0,n.jsxs)(l.z,{variant:"ghost",size:o?"default":"icon",className:r,onClick:()=>{c||u(t)},...d,children:[c?(0,n.jsx)(s.IconCheck,{className:"text-green-600"}):(0,n.jsx)(s.IconCopy,{}),o&&(0,n.jsx)("span",{children:o}),!o&&(0,n.jsx)("span",{className:"sr-only",children:"Copy"})]}):null}},73460:function(e,r,t){t.d(r,{OL:function(){return j},_T:function(){return m},aR:function(){return o},f$:function(){return p},fY:function(){return f},le:function(){return v},vW:function(){return d},xo:function(){return x},yT:function(){return h}});var n=t(36164),a=t(3546),l=t(28961),s=t(74248),i=t(31458);let o=l.fC,d=l.xz,c=e=>{let{className:r,children:t,...a}=e;return(0,n.jsx)(l.h_,{className:(0,s.cn)(r),...a,children:(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-end justify-center sm:items-center",children:t})})};c.displayName=l.h_.displayName;let u=a.forwardRef((e,r)=>{let{className:t,children:a,...i}=e;return(0,n.jsx)(l.aV,{className:(0,s.cn)("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm transition-opacity animate-in fade-in",t),...i,ref:r})});u.displayName=l.aV.displayName;let m=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsxs)(c,{children:[(0,n.jsx)(u,{}),(0,n.jsx)(l.VY,{ref:r,className:(0,s.cn)("fixed z-50 grid w-full max-w-lg scale-100 gap-4 border bg-background p-6 opacity-100 shadow-lg animate-in fade-in-90 slide-in-from-bottom-10 sm:rounded-lg sm:zoom-in-90 sm:slide-in-from-bottom-0 md:w-full",t),...a})]})});m.displayName=l.VY.displayName;let f=e=>{let{className:r,...t}=e;return(0,n.jsx)("div",{className:(0,s.cn)("flex flex-col space-y-2 text-center sm:text-left",r),...t})};f.displayName="AlertDialogHeader";let x=e=>{let{className:r,...t}=e;return(0,n.jsx)("div",{className:(0,s.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",r),...t})};x.displayName="AlertDialogFooter";let p=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)(l.Dx,{ref:r,className:(0,s.cn)("text-lg font-semibold",t),...a})});p.displayName=l.Dx.displayName;let h=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)(l.dk,{ref:r,className:(0,s.cn)("text-sm text-muted-foreground",t),...a})});h.displayName=l.dk.displayName;let j=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)(l.aU,{ref:r,className:(0,s.cn)((0,i.d)(),t),...a})});j.displayName=l.aU.displayName;let v=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)(l.$j,{ref:r,className:(0,s.cn)((0,i.d)({variant:"outline"}),"mt-2 sm:mt-0",t),...a})});v.displayName=l.$j.displayName},98150:function(e,r,t){t.d(r,{NI:function(){return h},Wi:function(){return u},l0:function(){return d},lX:function(){return p},pf:function(){return j},xJ:function(){return x},zG:function(){return v}});var n=t(36164),a=t(3546),l=t(74047),s=t(5493),i=t(74248),o=t(5266);let d=s.RV,c=a.createContext({}),u=e=>{let{...r}=e;return(0,n.jsx)(c.Provider,{value:{name:r.name},children:(0,n.jsx)(s.Qr,{...r})})},m=()=>{let e=a.useContext(c),r=a.useContext(f),{getFieldState:t,formState:n}=(0,s.Gc)(),l=e.name||"root",i=t(l,n);if(!n)throw Error("useFormField should be used within <Form>");let{id:o}=r;return{id:o,name:l,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message"),...i}},f=a.createContext({}),x=a.forwardRef((e,r)=>{let{className:t,...l}=e,s=a.useId();return(0,n.jsx)(f.Provider,{value:{id:s},children:(0,n.jsx)("div",{ref:r,className:(0,i.cn)("space-y-2",t),...l})})});x.displayName="FormItem";let p=a.forwardRef((e,r)=>{let{className:t,required:a,...l}=e,{error:s,formItemId:d}=m();return(0,n.jsx)(o._,{ref:r,className:(0,i.cn)(s&&"text-destructive",a&&'after:ml-0.5 after:text-destructive after:content-["*"]',t),htmlFor:d,...l})});p.displayName="FormLabel";let h=a.forwardRef((e,r)=>{let{...t}=e,{error:a,formItemId:s,formDescriptionId:i,formMessageId:o}=m();return(0,n.jsx)(l.g7,{ref:r,id:s,"aria-describedby":a?"".concat(i," ").concat(o):"".concat(i),"aria-invalid":!!a,...t})});h.displayName="FormControl";let j=a.forwardRef((e,r)=>{let{className:t,...a}=e,{formDescriptionId:l}=m();return(0,n.jsx)("div",{ref:r,id:l,className:(0,i.cn)("text-sm text-muted-foreground",t),...a})});j.displayName="FormDescription";let v=a.forwardRef((e,r)=>{let{className:t,children:a,...l}=e,{error:s,formMessageId:o}=m(),d=s?String(null==s?void 0:s.message):a;return d?(0,n.jsx)("p",{ref:r,id:o,className:(0,i.cn)("text-sm font-medium text-destructive",t),...l,children:d}):null});v.displayName="FormMessage"},82394:function(e,r,t){t.d(r,{I:function(){return s}});var n=t(36164),a=t(3546),l=t(74248);let s=a.forwardRef((e,r)=>{let{className:t,type:a,...s}=e;return(0,n.jsx)("input",{type:a,className:(0,l.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...s})});s.displayName="Input"},5266:function(e,r,t){t.d(r,{_:function(){return d}});var n=t(36164),a=t(3546),l=t(90893),s=t(14375),i=t(74248);let o=(0,s.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)(l.f,{ref:r,className:(0,i.cn)(o(),t),...a})});d.displayName=l.f.displayName},28312:function(e,r,t){t.d(r,{m:function(){return i}});var n=t(3546),a=t(61200),l=t.n(a),s=t(2578);function i(e){let{timeout:r=2e3,onError:t,onCopyContent:a}=e,[i,o]=n.useState(!1),d=()=>{o(!0),setTimeout(()=>{o(!1)},r)},c=e=>{if("function"==typeof t){null==t||t(e);return}s.A.error("Failed to copy.")};return{isCopied:i,copyToClipboard:e=>{var r;if(e){if(a){a(e),d();return}if(null===(r=navigator.clipboard)||void 0===r?void 0:r.writeText)navigator.clipboard.writeText(e).then(d).catch(c);else{let r=l()(e);r?d():c()}}}}}}}]);